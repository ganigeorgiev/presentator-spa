(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f834a70c"],{"0372":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.activeScreen?s("div",{directives:[{name:"shortcut",rawName:"v-shortcut.37",value:e.goToPrevScreen,expression:"goToPrevScreen",modifiers:{37:!0}},{name:"shortcut",rawName:"v-shortcut.39",value:e.goToNextScreen,expression:"goToNextScreen",modifiers:{39:!0}}],staticClass:"preview-screen-holder",class:[e.activePrototype.isForDesktop?"desktop":"mobile","align-"+e.activeScreen.alignment,e.inTransition?"transitioning":"",e.overlayScreen?"overlay-active":"","transition-"+e.activeTransition]},[e.screens.length>1?[s("nav",{staticClass:"preview-nav nav-left",class:{"nav-disabled":0==e.activeScreenOrderedIndex},attrs:{title:e.$t("Prev screen")},on:{click:function(t){return t.preventDefault(),e.goToPrevScreen()}}},[s("i",{staticClass:"fe fe-chevron-left"})]),s("nav",{staticClass:"preview-nav nav-right",class:{"nav-disabled":e.orderedScreens.length==e.activeScreenOrderedIndex+1},attrs:{title:e.$t("Next screen")},on:{click:function(t){return t.preventDefault(),e.goToNextScreen()}}},[s("i",{staticClass:"fe fe-chevron-right"})])]:e._e(),s("div",{ref:"activeScreenWrapper",staticClass:"screen-wrapper",style:{width:e.activePrototype.width?e.activePrototype.width+"px":null,height:e.activePrototype.height?e.activePrototype.height+"px":null,background:e.activeScreen.background||null},attrs:{tabindex:"-1"},on:{"&!scroll":function(t){return e.fixedOverlayReposition(t)}}},[e.interactions&&e.activeScreen.fixedHeader>0&&!e.inTransition?s("div",{staticClass:"fixed-screen-header",style:{height:e.activeScreen.fixedHeader*e.scaleFactor+"px","margin-top":-e.activeScreen.fixedHeader*e.scaleFactor+"px"}},[s("div",{staticClass:"fixed-screen-overflow-wrapper"},[s("div",{staticClass:"fixed-screen-content-wrapper"},[s("img",{directives:[{name:"scale",rawName:"v-scale",value:e.scaleFactor,expression:"scaleFactor"}],staticClass:"fixed-screen",attrs:{src:e.activeScreen.getImage(),alt:e.activeScreen.title}}),s("div",{staticClass:"block preview-hotspots-block"},e._l(e.activeScreenHotspots,(function(t){return t.top<e.activeScreen.fixedHeader?s("div",{key:"fixed_header_hotspot_"+t.id,staticClass:"hotspot",style:{left:t.left*e.scaleFactor+"px",top:t.top*e.scaleFactor+"px",width:t.width*e.scaleFactor+"px",height:t.height*e.scaleFactor+"px"},on:{click:function(s){return s.preventDefault(),e.hotspotNavigate(t.id)}}}):e._e()})),0)])])]):e._e(),s("div",{staticClass:"screen-inner-wrapper",class:{"position-static":e.overlayScreen&&e.isOverlayScreenFixed}},[s("img",{directives:[{name:"show",rawName:"v-show",value:e.oldActiveScreen&&e.inTransition,expression:"oldActiveScreen && inTransition"},{name:"scale",rawName:"v-scale",value:e.screenScaleFactor,expression:"screenScaleFactor"}],staticClass:"screen old-active-screen",style:{background:e.oldActiveScreen?e.oldActiveScreen.background:null},attrs:{src:e.oldActiveScreen?e.oldActiveScreen.getImage():"",alt:e.oldActiveScreen?e.oldActiveScreen.title:""}}),s("img",{directives:[{name:"tooltip",rawName:"v-tooltip.follow",value:e.activeScreenTooltip,expression:"activeScreenTooltip",modifiers:{follow:!0}},{name:"scale",rawName:"v-scale",value:e.screenScaleFactor,expression:"screenScaleFactor"}],key:"active_screen_"+e.activeScreen.id,ref:"activeScreen",staticClass:"screen",class:e.inTransition?"new-active-screen":"current-active-screen",attrs:{crossorigin:"anonymous",draggable:"false",src:e.activeScreen.getImage(),alt:e.activeScreen.title},on:{load:function(t){return e.refreshActiveScreenWrapperAlignment()},mousedown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:"button"in t&&0!==t.button?null:(t.stopPropagation(),t.preventDefault(),e.$emit("activeScreenMousedown",t))},click:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:"button"in t&&0!==t.button?null:(t.stopPropagation(),t.preventDefault(),e.$emit("activeScreenClick",t))},e.onOverlayOutsideClick]}}),e.interactions&&e.overlayScreen?s("div",{key:"overlayContainer",ref:"overlayContainer",staticClass:"overlay-container",class:e.isOverlayScreenFixed?"fixed":"relative"},[s("div",{staticClass:"overlay-screen-wrapper",class:["transition-"+e.overlayScreenTransition,"position-"+e.overlayScreenPosition,e.isOverlayScreenClosing?"closing":""],style:{"margin-top":e.overlayScreenOffsetTop*e.scaleFactor+"px","margin-bottom":e.overlayScreenOffsetBottom*e.scaleFactor+"px","margin-left":e.overlayScreenOffsetLeft*e.scaleFactor+"px","margin-right":e.overlayScreenOffsetRight*e.scaleFactor+"px"}},[s("img",{directives:[{name:"scale",rawName:"v-scale",value:e.scaleFactor,expression:"scaleFactor"}],staticClass:"screen overlay-screen",attrs:{src:e.overlayScreen.getImage(),alt:e.overlayScreen.title}}),s("div",{key:"overlay-screen-hotspots-block",staticClass:"block preview-hotspots-block"},e._l(e.overlayScreenHotspots,(function(t){return s("div",{key:"overlay_screen_hotspot_"+t.id,staticClass:"hotspot",style:{left:t.left*e.scaleFactor+"px",top:t.top*e.scaleFactor+"px",width:t.width*e.scaleFactor+"px",height:t.height*e.scaleFactor+"px"},on:{click:function(s){return s.preventDefault(),e.hotspotNavigate(t.id)}}})})),0)])]):e._e(),e.interactions?s("div",{key:"active-screen-hotspots-block",staticClass:"block preview-hotspots-block"},e._l(e.activeScreenHotspots,(function(t){return s("div",{key:"active_screen_hotspot_"+t.id,staticClass:"hotspot",style:{left:t.left*e.scaleFactor+"px",top:t.top*e.scaleFactor+"px",width:t.width*e.scaleFactor+"px",height:t.height*e.scaleFactor+"px"},on:{click:function(s){return s.preventDefault(),e.hotspotNavigate(t.id)}}})})),0):e._e(),e._t("default")],2),e.interactions&&e.activeScreen.fixedFooter>0&&!e.inTransition?s("div",{staticClass:"fixed-screen-footer",style:{height:e.activeScreen.fixedFooter*e.scaleFactor+"px","margin-top":-e.activeScreen.fixedFooter*e.scaleFactor+"px"}},[s("div",{staticClass:"fixed-screen-overflow-wrapper"},[s("div",{staticClass:"fixed-screen-content-wrapper"},[s("img",{directives:[{name:"scale",rawName:"v-scale",value:e.scaleFactor,expression:"scaleFactor"}],staticClass:"fixed-screen",attrs:{src:e.activeScreen.getImage(),alt:e.activeScreen.title}}),s("div",{staticClass:"block preview-hotspots-block"},e._l(e.activeScreenHotspots,(function(t){return s("div",{key:"fixed_footer_hotspot_"+t.id,staticClass:"hotspot",style:{left:t.left*e.scaleFactor+"px",top:t.top*e.scaleFactor+"px",width:t.width*e.scaleFactor+"px",height:t.height*e.scaleFactor+"px"},on:{click:function(s){return s.preventDefault(),e.hotspotNavigate(t.id)}}})})),0)])])]):e._e()])],2):e._e()},r=[],n=(s("ac6a"),s("ade3")),o=s("2f62"),a=s("dd93");function c(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function l(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?c(s,!0).forEach((function(t){Object(n["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):c(s).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}const h=400;let m=null;var d={name:"screen-preview",props:{interactions:{type:Boolean,default:!0},activeScreenTooltip:{type:String,default:""},fitToScreen:{type:Boolean,default:!1}},data(){return{oldActiveScreenId:null,activeTransition:"none",inTransition:!1,overlayScreenId:null,overlayScreenPosition:"centered",overlayScreenTransition:"none",overlayScreenOffsetTop:0,overlayScreenOffsetBottom:0,overlayScreenOffsetLeft:0,overlayScreenOffsetRight:0,overlayScreenOutsideClose:!0,isOverlayScreenFixed:!1,isOverlayScreenClosing:!1}},computed:l({},Object(o["d"])({activeScreenId:e=>e.screens.activeScreenId,screens:e=>e.screens.screens,scaleFactor:e=>e.screens.scaleFactor,hotspots:e=>e.hotspots.hotspots,hotspotTemplates:e=>e.hotspots.hotspotTemplates}),{},Object(o["c"])({activePrototype:"prototypes/activePrototype",getScreen:"screens/getScreen",activeScreen:"screens/activeScreen",orderedScreens:"screens/orderedScreens",activeScreenOrderedIndex:"screens/activeScreenOrderedIndex",getHotspot:"hotspots/getHotspot",getHotspotTemplate:"hotspots/getHotspotTemplate",getHotspotsForScreen:"hotspots/getHotspotsForScreen"}),{screenScaleFactor(e,t){return this.fitToScreen?0:this.activePrototype.scaleFactor},oldActiveScreen(){return this.getScreen(this.oldActiveScreenId)},overlayScreen(){return this.getScreen(this.overlayScreenId)},activeScreenHotspots(){return this.getHotspotsForScreen(this.activeScreenId)},overlayScreenHotspots(){return this.getHotspotsForScreen(this.overlayScreenId)}}),watch:{interactions(e,t){this.closeOverlayScreen()},activeScreenId(e,t){this.oldActiveScreenId=t,this.onActiveScreenChange()},"activeScreen.alignment":function(e,t){e!==t&&this.refreshActiveScreenWrapperAlignment()},fitToScreen(e,t){this.onActiveScreenChange()}},mounted(){this.onActiveScreenChange()},methods:l({},Object(o["b"])({setActiveScreenId:"screens/setActiveScreenId",setScreens:"screens/setScreens",setScaleFactor:"screens/setScaleFactor"}),{changeActiveScreen(e,t,s){var i=this.getScreen(e);i&&(s||e!==this.activeScreenId)&&(this.$emit("beforeActiveScreenChange",this.activeScreenId,e),this.inTransition=!1,this.activeTransition=t||"none",this.oldActiveScreenId=this.activeScreenId,this.screenChangeTimeoutId&&clearTimeout(this.screenChangeTimeoutId),this.screenChangeTimeoutId=setTimeout(()=>{this.setActiveScreenId(e),"none"!==this.activeTransition&&(this.inTransition=!0,this.screenChangeAnimationTimeoutId&&clearTimeout(this.screenChangeAnimationTimeoutId),this.screenChangeAnimationTimeoutId=setTimeout(()=>{this.activeTransition="none",this.inTransition=!1},h)),this.$emit("afterActiveScreenChange",this.oldActiveScreenId,this.activeScreenId)},"none"!==this.activeTransition?100:0))},onActiveScreenChange(){this.activeScreen&&(this.fitToScreen||0==this.activePrototype.scaleFactor?a["a"].loadImage(this.activeScreen.getImage()).then(e=>{e.success&&e.width>0&&setTimeout(()=>{this.$refs.activeScreen&&this.setScaleFactor(this.$refs.activeScreen.clientWidth/e.width)},0)}):this.setScaleFactor(this.activePrototype.scaleFactor),this.closeOverlayScreen(),this.refreshActiveScreenWrapperAlignment(),this.$setDocumentTitle(()=>this.$t("Screen")+" "+this.activeScreen.title),this.$refs.activeScreenWrapper&&this.$refs.activeScreenWrapper.focus())},goToPrevScreen(){this.orderedScreens[this.activeScreenOrderedIndex-1]&&this.setActiveScreenId(this.orderedScreens[this.activeScreenOrderedIndex-1].id)},goToNextScreen(){this.orderedScreens[this.activeScreenOrderedIndex+1]&&this.setActiveScreenId(this.orderedScreens[this.activeScreenOrderedIndex+1].id)},refreshActiveScreenWrapperAlignment(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.$nextTick(()=>{m&&clearTimeout(m),m=setTimeout(()=>{this.$refs.activeScreenWrapper&&(this.activeScreen.isLeftAligned?this.$refs.activeScreenWrapper.scrollLeft=0:this.activeScreen.isRightAligned?this.$refs.activeScreenWrapper.scrollLeft=this.$refs.activeScreenWrapper.scrollWidth:this.$refs.activeScreenWrapper.scrollLeft=(this.$refs.activeScreenWrapper.scrollWidth-this.$refs.activeScreenWrapper.offsetWidth)/2)},e)})},hotspotNavigate(e){var t=this.getHotspot(e);if(t){var s=t.settings.transition||"none";"url"===t.type?window.open(t.settings.url||"#","_blank"):"prev"===t.type?this.orderedScreens[this.activeScreenOrderedIndex-1]&&this.changeActiveScreen(this.orderedScreens[this.activeScreenOrderedIndex-1].id,s):"next"===t.type?this.orderedScreens[this.activeScreenOrderedIndex+1]&&this.changeActiveScreen(this.orderedScreens[this.activeScreenOrderedIndex+1].id,s):"back"===t.type?this.overlayScreenId?this.closeOverlayScreen():this.oldActiveScreen&&this.changeActiveScreen(this.oldActiveScreen.id,s):"screen"===t.type?this.changeActiveScreen(t.settings.screenId,s):"overlay"===t.type?this.openOverlayScreen(t.settings.screenId,s,t.settings.outsideClose,t.settings.overlayPosition,t.settings.offsetTop,t.settings.offsetBottom,t.settings.offsetLeft,t.settings.offsetRight,t.settings.fixOverlay):"scroll"===t.type&&this.$refs.activeScreenWrapper&&this.$refs.activeScreenWrapper.scrollTo({behavior:"smooth",top:t.settings.scrollTop<<0,left:t.settings.scrollLeft<<0})}},fixedOverlayReposition(){this.isOverlayScreenFixed&&this.overlayScreenId&&this.$refs.activeScreenWrapper&&this.$refs.overlayContainer&&(this.$refs.overlayContainer.style.marginTop=this.$refs.activeScreenWrapper.scrollTop+"px",this.$refs.overlayContainer.style.marginLeft=this.$refs.activeScreenWrapper.scrollLeft+"px")},openOverlayScreen(e,t,s,i,r,n,o,c,l){e!=this.overlayScreenId&&this.closeOverlayScreen(()=>{this.isOverlayScreenClosing=!1,this.overlayScreenId=e,this.overlayScreenTransition=t||"none",this.overlayScreenPosition=i||"centered",this.overlayScreenOffsetTop=r<<0,this.overlayScreenOffsetBottom=n<<0,this.overlayScreenOffsetLeft=o<<0,this.overlayScreenOffsetRight=c<<0,this.overlayScreenOutsideClose=!!a["a"].isEmpty(s)||s,this.isOverlayScreenFixed=!a["a"].isEmpty(l)&&l,this.$nextTick(()=>{this.fixedOverlayReposition()})})},closeOverlayScreen(e){this.overlayScreenId?(this.isOverlayScreenClosing=!0,this.overlayCloseAnimationTimeoutId&&clearTimeout(this.overlayCloseAnimationTimeoutId),this.overlayCloseAnimationTimeoutId=setTimeout(()=>{this.isOverlayScreenClosing=!0,this.overlayScreenId=null,this.overlayScreenPosition="centered",this.overlayScreenTransition="none",this.overlayScreenOffsetTop=0,this.overlayScreenOffsetBottom=0,this.overlayScreenOffsetLeft=0,this.overlayScreenOffsetRight=0,this.overlayScreenOutsideClose=!0,a["a"].isFunction(e)&&e()},"none"!=this.overlayScreenTransition?h:0)):a["a"].isFunction(e)&&e()},onOverlayOutsideClick(e){this.overlayScreenId&&this.overlayScreenOutsideClose&&(e.preventDefault(),e.stopPropagation(),this.closeOverlayScreen())}})},p=d,v=s("2877"),f=Object(v["a"])(p,i,r,!1,null,null,null);t["a"]=f.exports},"097d":function(e,t,s){"use strict";var i=s("5ca1"),r=s("8378"),n=s("7726"),o=s("ebd6"),a=s("bcaa");i(i.P+i.R,"Promise",{finally:function(e){var t=o(this,r.Promise||n.Promise),s="function"==typeof e;return this.then(s?function(s){return a(t,e()).then((function(){return s}))}:e,s?function(s){return a(t,e()).then((function(){throw s}))}:e)}})},"35bb":function(e,t,s){"use strict";s("ac6a"),s("a481"),s("097d");var i=s("ade3"),r=s("2f62"),n=s("f744"),o=s("dd93"),a=s("46a0");function c(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function l(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?c(s,!0).forEach((function(t){Object(i["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):c(s).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}t["a"]={data(){return{isLoadingComments:!1,showResolvedComments:!1,mentionsList:[]}},computed:l({},Object(r["d"])({activePrototypeId:e=>e.prototypes.activePrototypeId,activeScreenId:e=>e.screens.activeScreenId,scaleFactor:e=>e.screens.scaleFactor,previewToken:e=>e.preview.previewToken,unreadComments:e=>e.notifications.unreadComments}),{},Object(r["c"])({getCommentsForScreen:"comments/getCommentsForScreen",getUnreadCommentsForScreen:"notifications/getUnreadCommentsForScreen"}),{activeScreenComments(){return this.getCommentsForScreen(this.activeScreenId)},totalActiveScreenComments(){return this.activeScreenComments.length},activeScreenResolvedComments(){return this.getCommentsForScreen(this.activeScreenId,"resolved")},totalActiveScreenResolvedComments(){return this.activeScreenResolvedComments.length},activeUnreadComments(){return this.getUnreadCommentsForScreen(this.activeScreenId)}}),watch:{activeUnreadComments(e,t){for(let s in e)e[s].replyTo||this.addComment(e[s])}},methods:l({},Object(r["b"])({setComments:"comments/setComments",addComment:"comments/addComment",appendComments:"comments/appendComments"}),{convertCollaboratorsListToMentionsList(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e=e||[];var s=[];for(let i=e.length-1;i>=0;i--){if(t.indexOf(e[i].email)>=0)continue;let r=((e[i].firstName||"")+(e[i].lastName||"")).trim();s.push({value:e[i].email,label:r?r+" ("+e[i].email+")":e[i].email})}return s},isCommentUnread(e){for(let t in this.activeUnreadComments)if(this.activeUnreadComments[t].id==e||this.activeUnreadComments[t].replyTo==e)return!0;return!1},loadComments(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e=e||this.activePrototypeId,e&&!this.isLoadingComments){this.isLoadingComments=!0;var i=null;n["a"].enableAutoCancellation(!1),i=s?n["a"].Previews.getScreenCommentsList(this.previewToken,t,100,{envelope:!0,"search[prototypeId]":e,"search[replyTo]":0}):n["a"].ScreenComments.getList(t,100,{envelope:!0,"search[prototypeId]":e,"search[replyTo]":0}),i.finally(()=>{this.isLoadingComments=!1}).then(i=>{var r=o["a"].getNestedVal(i,"data.response",[]),n=o["a"].getNestedVal(i,"data.headers.x-pagination-current-page",1),a=o["a"].getNestedVal(i,"data.headers.x-pagination-page-count",1);1==t?this.setComments(r):this.appendComments(r),a>n&&this.loadComments(e,t+1,s),this.$route.query.commentId&&setTimeout(()=>{this.viewComment(this.$route.query.commentId)},300)}).catch(e=>{this.$errResponseHandler(e)})}},initCommentCreation(e,t){if(this.isInCommentsMode){t=t||this.activeScreenId;var s=new a["a"]({screenId:t,left:this.scaleFactor>0?e.offsetX/this.scaleFactor:e.offsetX,top:this.scaleFactor>0?e.offsetY/this.scaleFactor:e.offsetY});this.addComment(s),this.$nextTick(()=>{if(this.$refs.screenCommentPins){var e=this.$refs.screenCommentPins[this.$refs.screenCommentPins.length-1];e&&e.activate()}})}},viewComment(e){if(this.$refs.screenCommentPins)for(let t in this.$refs.screenCommentPins){let s=this.$refs.screenCommentPins[t];if(s.comment&&s.comment.id==e){"resolved"===s.comment.status&&(this.showResolvedComments=!0),s.activate();break}}},deactivateComments(){this.$refs.commentPopover&&this.$refs.commentPopover.close();var e=[];if(this.$refs.screenCommentPins)for(let s in this.$refs.screenCommentPins)this.$refs.screenCommentPins[s].isActive&&(this.$refs.screenCommentPins[s].deactivate(),e.push(this.$refs.screenCommentPins[s].comment.id));if(this.$route.query.commentId&&o["a"].inArray(e,this.$route.query.commentId)){var t=Object.assign({},this.$route.query);delete t.commentId,this.$router.replace({name:this.$route.name,params:Object.assign({},this.$route.params),query:t})}},onCommentPopoverClose(){this.deactivateComments()},onCommentActivate(e,t){this.deactivateComments(),this.$refs.commentPopover&&(this.$refs.commentPopover.open(e,t),e.id&&this.$route.query.commentId!=e.id&&this.$router.replace({name:this.$route.name,params:Object.assign({},this.$route.params),query:Object.assign({},this.$route.query,{commentId:e.id})}))},onCommentRepositioning(e,t){this.$refs.commentPopover&&this.$refs.commentPopover.reposition(t)}})}},"7bbf":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("dragger",{staticClass:"comment-pin",class:{new:!e.comment.id,completed:e.comment.isResolved,active:e.isActive,loader:e.isProcessing},style:{left:e.comment.left*e.scaleFactor+"px",top:e.comment.top*e.scaleFactor+"px"},attrs:{"data-id":e.comment.id,enable:e.allowPositionChange,wrapperSelector:".screen-inner-wrapper"},on:{dragging:function(t){return e.onRepositioning()},dragStopped:function(t){return e.updatePinPosition()}},nativeOn:{click:function(t){return t.preventDefault(),e.activate()}}})},r=[],n=(s("ac6a"),s("097d"),s("ade3")),o=s("2f62"),a=s("f744"),c=s("82bb"),l=s("46a0");function h(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function m(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?h(s,!0).forEach((function(t){Object(n["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):h(s).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var d={name:"comment-pin",components:{dragger:c["a"]},props:{allowPositionChange:{type:Boolean,default:!1},comment:{type:l["a"],required:!0}},data(){return{isActive:!1,isProcessing:!1}},computed:m({},Object(o["d"])({scaleFactor:e=>e.screens.scaleFactor})),methods:m({},Object(o["b"])({removeComment:"comments/removeComment"}),{activate(){this.isActive||(this.$emit("beforeActivate",this.comment,this.$el),this.isActive=!0,this.$nextTick(()=>{this.positionWithinView()}),this.$emit("activated",this.comment,this.$el))},deactivate(){this.isActive&&(this.isActive=!1,this.$emit("beforeDeactivate",this.comment,this.$el),this.comment.id||this.removeComment(this.comment.id),this.$emit("deactivated",this.comment,this.$el))},positionWithinView(){this.$el.scrollIntoView({behavior:"smooth",block:"nearest"})},updatePinPosition(){this.comment.left=this.$el.offsetLeft/this.scaleFactor,this.comment.top=this.$el.offsetTop/this.scaleFactor,this.comment.id&&(this.isProcessing=!0,a["a"].ScreenComments.update(this.comment.id,{left:this.comment.left,top:this.comment.top}).then(e=>{this.comment.load(e.data),this.$emit("commentUpdated",this.comment,this.$el)}).catch(e=>{this.$errResponseHandler(e)}).finally(()=>{this.isProcessing=!1}))},onRepositioning(){this.$emit("repositioning",this.comment,this.$el)}})},p=d,v=s("2877"),f=Object(v["a"])(p,i,r,!1,null,null,null);t["a"]=f.exports},"82bb":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{on:{mousedown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:"button"in t&&0!==t.button?null:e.dragInit(t)},touchstart:e.dragInit}},[e._t("default")],2)},r=[],n={name:"dragger",props:{wrapperSelector:{type:String},tolerance:{type:Number,default:10},enable:{type:Boolean,default:!0}},data(){return{startX:0,startY:0,shiftX:0,shiftY:0,lockX:!1,lockY:!1,dragStarted:!1}},computed:{wrapper(){return this.$el.closest(this.wrapperSelector)||this.$el.parentNode}},methods:{dragInit(e){this.enable&&(e.stopPropagation(),this.startX=e.clientX,this.startY=e.clientY,this.shiftX=e.clientX-this.$el.offsetLeft,this.shiftY=e.clientY-this.$el.offsetTop,document.addEventListener("touchmove",this.onMove),document.addEventListener("mousemove",this.onMove),document.addEventListener("touchend",this.onDrop),document.addEventListener("mouseup",this.onDrop))},onMove(e){let t=e.clientX-this.startX,s=e.clientY-this.startY,i=e.clientX-this.shiftX,r=e.clientY-this.shiftY;if(!(!this.dragStarted&&Math.abs(i-this.$el.offsetLeft)<this.tolerance&&Math.abs(r-this.$el.offsetTop)<this.tolerance)){if(e.preventDefault(),this.dragStarted||(this.dragStarted=!0,this.$el.classList.add("no-pointer-events"),this.wrapper.classList.add("dragging"),this.$emit("dragStarted",e)),this.$emit("dragging",e),e.shiftKey?this.lockX||this.lockY||(Math.abs(t)>Math.abs(s)?(this.lockX=!1,this.lockY=!0):(this.lockX=!0,this.lockY=!1)):(this.lockX=!1,this.lockY=!1),!this.lockX){let e=this.wrapper.scrollWidth||this.wrapper.offsetWidth;i+this.$el.offsetWidth>e&&(i=e-this.$el.offsetWidth),i=i<0?0:i,this.$el.style.left=i+"px"}if(!this.lockY){let e=this.wrapper.scrollHeight||this.wrapper.offsetHeight;r+this.$el.offsetHeight>e&&(r=e-this.$el.offsetHeight),r=r<0?0:r,this.$el.style.top=r+"px"}}},onDrop(e){this.dragStarted&&(e.preventDefault(),this.dragStarted=!1,this.lockX=!1,this.lockY=!1,this.$el.classList.remove("no-pointer-events"),this.wrapper.classList.remove("dragging"),this.$emit("dragStopped",e)),document.removeEventListener("touchmove",this.onMove),document.removeEventListener("mousemove",this.onMove),document.removeEventListener("touchend",this.onDrop),document.removeEventListener("mouseup",this.onDrop)}}},o=n,a=s("2877"),c=Object(a["a"])(o,i,r,!1,null,null,null);t["a"]=c.exports},"9aaf":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("transition",{attrs:{name:"previewPanel"}},[e.isActive&&e.screens.length?s("div",{staticClass:"preview-screens-panel",on:{"&!wheel":function(t){return e.verticalToHorizontalScroll(t)}}},[s("div",{staticClass:"thumbs-list"},e._l(e.orderedScreens,(function(t){return s("figure",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.title,expression:"screen.title",modifiers:{top:!0}}],key:"thumb_"+t.id,staticClass:"thumb thumb-handle screen-thumb",class:{active:e.activeScreenId==t.id},on:{click:function(s){return s.preventDefault(),e.setActiveScreenId(t.id)}}},[t.getImage("small")?s("img",{staticClass:"img",attrs:{src:t.getImage("small"),alt:t.title}}):s("i",{staticClass:"fe fe-image img"})])})),0)]):e._e()])},r=[],n=(s("ac6a"),s("ade3")),o=s("2f62");function a(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function c(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?a(s,!0).forEach((function(t){Object(n["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):a(s).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var l={name:"screens-panel",data(){return{isActive:!1}},computed:c({},Object(o["d"])({screens:e=>e.screens.screens,activeScreenId:e=>e.screens.activeScreenId}),{},Object(o["c"])({orderedScreens:"screens/orderedScreens"})),watch:{activeScreenId(e,t){e!==t&&this.isActive&&this.scrollToActiveScreenThumb()}},methods:c({},Object(o["b"])({setActiveScreenId:"screens/setActiveScreenId"}),{show(){this.isActive=!0,this.scrollToActiveScreenThumb()},hide(){this.isActive=!1},toggle(){this.isActive?this.hide():this.show()},scrollToActiveScreenThumb(){this.$nextTick(()=>{if(this.isActive&&this.$el){var e=15,t=this.$el,s=t?t.querySelector(".screen-thumb.active"):null;if(s){var i=s.offsetLeft,r=i+s.offsetWidth,n=t.scrollLeft,o=n+t.offsetWidth;i-e<n?t.scrollLeft=i-e:r+e>o&&(t.scrollLeft=n-(o-(r+e)))}}})},verticalToHorizontalScroll(e){if("wheel"==e.type&&this.$el){var t=(e.deltaY||-e.wheelDelta||e.detail)>>10||1;t*=-300,this.$el.scrollLeft-=t}}})},h=l,m=s("2877"),d=Object(m["a"])(h,i,r,!1,null,null,null);t["a"]=d.exports},a5b8:function(e,t,s){"use strict";var i=s("d8e8");function r(e){var t,s;this.promise=new e((function(e,i){if(void 0!==t||void 0!==s)throw TypeError("Bad Promise constructor");t=e,s=i})),this.resolve=i(t),this.reject=i(s)}e.exports.f=function(e){return new r(e)}},af83:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"popover-holder comment-popover-holder"},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.isActive,expression:"isActive"}],staticClass:"popover-overlay",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.close()}}}),s("div",{ref:"popover",staticClass:"popover comment-popover",class:{active:e.isActive}},[e.comment.id?s("div",{staticClass:"form-group resolved-checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.comment.status,expression:"comment.status"}],attrs:{type:"checkbox",id:"mark_as_resoved_"+e.comment.id,"true-value":"resolved","false-value":"pending"},domProps:{checked:Array.isArray(e.comment.status)?e._i(e.comment.status,null)>-1:e._q(e.comment.status,"resolved")},on:{change:[function(t){var s=e.comment.status,i=t.target,r=i.checked?"resolved":"pending";if(Array.isArray(s)){var n=null,o=e._i(s,n);i.checked?o<0&&e.$set(e.comment,"status",s.concat([n])):o>-1&&e.$set(e.comment,"status",s.slice(0,o).concat(s.slice(o+1)))}else e.$set(e.comment,"status",r)},function(t){return e.saveCommentStatus()}]}}),s("label",{attrs:{for:"mark_as_resoved_"+e.comment.id}},[e._v(e._s(e.$t("Mark as resolved")))])]):e._e(),e.isLoadingReplies?s("div",{staticClass:"block txt-center txt-hint p-small"},[s("span",{staticClass:"loader"})]):e._e(),!e.isLoadingReplies&&e.comment.id?s("div",{ref:"commentsListContainer",staticClass:"comments-list"},e._l(e.commentsList,(function(t){return s("div",{key:"reply_"+t.id,staticClass:"comment-list-item",class:{primary:t.isPrimary}},[s("figure",{staticClass:"avatar"},[t.user&&t.user.getAvatar("small")?s("img",{attrs:{src:t.user.getAvatar("small"),alt:"User avatar"}}):s("i",{staticClass:"fe fe-user"})]),s("div",{staticClass:"content"},[s("small",[s("span",{staticClass:"name"},[e._v(e._s(t.user?t.user.identifier:t.from))]),s("span",{staticClass:"date txt-hint m-l-5"},[e._v(e._s(t.createdAtFromNow))])]),s("div",{staticClass:"message"},[e._v(e._s(t.message))])]),s("div",{staticClass:"list-ctrls"},[e.isForPreview?e._e():s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.$t("Delete"),expression:"$t('Delete')",modifiers:{top:!0}}],staticClass:"list-ctrl-item ctrl-danger",on:{click:function(s){return s.preventDefault(),e.deleteComment(t.id)}}},[s("i",{staticClass:"fe fe-trash"})])])])})),0):e._e(),s("form",{ref:"messageForm",staticClass:"comment-message-form",on:{submit:function(e){e.preventDefault()}}},[e.isForPreview?s("form-field",{staticClass:"email-field",attrs:{name:"from",showErrorMsg:!0}},[s("div",{staticClass:"input-group"},[s("div",{staticClass:"input-addon p-l-small p-r-0 m-r-0"},[s("i",{directives:[{name:"tooltip",rawName:"v-tooltip.left",value:e.$t("From (email)"),expression:"$t('From (email)')",modifiers:{left:!0}}],staticClass:"fe fe-mail"})]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.from,expression:"from"}],staticClass:"p-l-10",attrs:{type:"email",required:"",placeholder:e.$t("Your email")},domProps:{value:e.from},on:{keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;t.preventDefault()},input:function(t){t.target.composing||(e.from=t.target.value)}}})])]):e._e(),s("form-field",{staticClass:"message-field",attrs:{name:"message",showErrorMsg:!1}},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],ref:"messageField",attrs:{required:"",placeholder:e.$t("Write a comment (@ to mention)")},domProps:{value:e.message},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey?t.shiftKey||t.altKey||t.metaKey?null:(t.preventDefault(),e.addComment()):null},input:function(t){t.target.composing||(e.message=t.target.value)}}}),s("button",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:e.$t("Add comment ({shortcut})",{shortcut:"Ctrl+Enter"}),expression:"$t('Add comment ({shortcut})', {shortcut: 'Ctrl+Enter'})",modifiers:{bottom:!0}}],ref:"messageBtn",staticClass:"submit-icon",on:{click:function(t){return t.preventDefault(),e.addComment()},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey?t.shiftKey||t.altKey||t.metaKey?null:(t.preventDefault(),e.addComment()):null}}},[e.isProcessing?s("span",{staticClass:"loader"}):s("i",{staticClass:"fe fe-send"})]),s("mentions-list",{ref:"mentionsList",staticClass:"dropdown-compact input-dropdown",attrs:{list:e.mentionsList}})],1)],1)])])},r=[],n=(s("ac6a"),s("097d"),s("55dd"),s("ade3")),o=s("2f62"),a=s("0abc"),c=s("3d48"),l=s("dd93"),h=s("f744"),m=s("46a0"),d=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"dropdown",class:{active:e.isActive}},[e._l(e.filteredList,(function(t,i){return[s("div",{ref:"mentions",refInFor:!0,staticClass:"dropdown-item",class:{highlight:e.focusIndex==i},on:{click:function(t){return t.preventDefault(),e.select(i)}}},[e._v(e._s(t.label))]),i+1!=e.filteredList.length?s("hr"):e._e()]}))],2)},p=[],v=(s("a481"),{name:"mentions-list",props:{list:{type:Array,required:!0},triggers:{type:Array,default(){return["+","@"]}},input:{}},data(){return{isActive:!1,focusIndex:0,filteredList:[]}},computed:{inputElem(){return this.input instanceof Node?this.input:this.input&&l["a"].isString(this.input)&&document.querySelector(this.input)?document.querySelector(this.input):this.$el.parentNode.querySelector("textarea, input")}},mounted(){this.inputElem?(this.inputElem.addEventListener("input",this.onInputChange),this.inputElem.addEventListener("keydown",this.onInputKeydown)):console.warn("MentionsList: input element is invalid or missing.")},beforeDestroy(){this.inputElem&&(this.inputElem.removeEventListener("input",this.onInputChange),this.inputElem.removeEventListener("keydown",this.onInputKeydown))},methods:{hide(){this.isActive&&(this.isActive=!1,this.focusIndex=0,this.filteredList=[],this.$emit("hide"))},show(){this.isActive||(this.isActive=!0,this.focusIndex=0,this.$emit("show"),this.positionFocusedMendtionWithinView())},focusPrev(){this.focusIndex<=0?this.focusIndex=this.filteredList.length-1:this.focusIndex--,this.positionFocusedMendtionWithinView()},focusNext(){this.focusIndex>=this.filteredList.length-1?this.focusIndex=0:this.focusIndex++,this.positionFocusedMendtionWithinView()},positionFocusedMendtionWithinView(){this.$refs.mentions&&this.$refs.mentions[this.focusIndex]&&this.$refs.mentions[this.focusIndex].scrollIntoView({block:"nearest"})},getCurrentWordInfo(){var e="undefined"!==typeof this.inputElem.selectionStart?this.inputElem.selectionStart:this.inputElem.value.length,t=l["a"].getWordInfoAt(this.inputElem.value,e-1);return t},select(e){e="undefined"!==typeof e?e:this.focusIndex;var t=this.getCurrentWordInfo();if(t.word&&this.inputElem&&this.filteredList[e]){var s=this.inputElem.value;this.inputElem.value=s.substring(0,t.start)+this.triggers[0]+this.filteredList[e].value+s.substring(t.end+1)+" ",this.inputElem.dispatchEvent(new Event("input")),this.$nextTick(()=>{this.inputElem.focus(),this.hide()})}},filterList(e){if(e=(e||"").toLowerCase().replace(/\s+/g,""),!e)return this.list;var t=[];for(let s=this.list.length-1;s>=0;s--){let i=(this.list[s].value+this.list[s].label||"").toLowerCase().replace(/\s+/g,"");i.indexOf(e)>=0&&t.push(this.list[s])}return t},onInputChange(e){var t=this.getCurrentWordInfo();this.hide(),t.word&&this.triggers.indexOf(t.word[0])>=0&&(this.filteredList=this.filterList(t.word.substring(1)),this.filteredList.length&&this.show())},onInputKeydown(e){if(this.isActive){var t=e.which||e.keyCode;13==t?(e.preventDefault(),this.select()):38==t?(e.preventDefault(),this.focusPrev()):40==t&&(e.preventDefault(),this.focusNext())}}}}),f=v,u=s("2877"),g=Object(u["a"])(f,d,p,!1,null,null,null),y=g.exports;function S(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function C(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?S(s,!0).forEach((function(t){Object(n["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):S(s).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var w={name:"comment-popover",components:{"mentions-list":y},props:{mentionsList:{type:Array,default(){return[]}},isForPreview:{type:Boolean,default:!0}},data(){return{isActive:!1,isProcessing:!1,isLoadingReplies:!1,comment:new m["a"],replies:[],message:"",from:""}},computed:C({},Object(o["d"])({previewToken:e=>e.preview.previewToken}),{},Object(o["c"])({getUnreadComment:"notifications/getUnreadComment",getUnreadCommentsForComment:"notifications/getUnreadCommentsForComment"}),{commentsList(){var e=this.replies.slice();return this.comment.id&&e.unshift(this.comment),e.sort((e,t)=>Date.parse(e["createdAt"])-Date.parse(t["createdAt"])),e},unreadCommentReplies(){return this.getUnreadCommentsForComment(this.comment.id)}}),watch:{commentsList(e,t){this.$nextTick(()=>{setTimeout(()=>{this.reposition()},100)})},unreadCommentReplies(e,t){if(e){for(let t in e)l["a"].pushUnique(this.replies,e[t]);e.length&&this.isActive&&this.$nextTick(()=>{this.scrollToLastComment(),this.readComments(this.commentsList.slice(),500)})}}},mounted(){document.addEventListener("scroll",this.onEventPopoverReposition,{capture:!0,passive:!0}),window.addEventListener("resize",this.onEventPopoverReposition,{passive:!0}),this.from=c["a"].getItem(a["a"].get("VUE_APP_PREVIEW_COMMENT_FROM_STORAGE_KEY"))||l["a"].getNestedVal(this.$store,"state.user.user.email","")},beforeDestroy(){document.removeEventListener("scroll",this.onEventPopoverReposition,{capture:!0}),window.removeEventListener("resize",this.onEventPopoverReposition)},methods:C({},Object(o["b"])({removeComment:"comments/removeComment",removeUnreadComment:"notifications/removeUnreadComment",markAsRead:"notifications/markAsRead"}),{resetForm(){this.message="",this.$refs.messageBtn&&this.$refs.messageBtn.blur()},open(e,t){this.isActive||(this.isActive=!0,this.replies=[],e instanceof m["a"]?this.comment=e:this.comment=new m["a"](e),this.resetForm(),this.loadReplies(),t&&this.$nextTick(()=>{this.reposition(t)}),!this.comment.id&&this.$refs.messageField&&setTimeout(()=>{this.$refs.messageField&&this.$refs.messageField.focus()},100),this.$emit("opened"))},close(){this.isActive&&(this.isActive=!1,this.comment.id||this.removeComment(this.comment.id),this.$refs.mentionsList&&this.$refs.mentionsList.hide(),this.$emit("closed"))},onEventPopoverReposition(e){this.isActive&&this.reposition()},reposition(e){if(e=e||document.querySelector('.comment-pin[data-id="'+this.comment.id+'"]'),this.isActive&&e){var t=this.$refs.popover,s=e.getBoundingClientRect(),i=5,r=s.top-i,n=s.left+s.width+i;t.style.left="0px",t.style.top="0px",n+t.offsetWidth>document.documentElement.clientWidth&&(n=s.left-t.offsetWidth-i),n=n>=0?n:0,r+t.offsetHeight>document.documentElement.clientHeight&&(r=document.documentElement.clientHeight-t.offsetHeight),r=r>=0?r:0,t.style.left=n+"px",t.style.top=r+"px"}},loadReplies(){var e;!this.isLoadingReplies&&this.comment.id&&(this.isLoadingReplies=!0,h["a"].enableAutoCancellation(!1),e=this.isForPreview?h["a"].Previews.getScreenCommentsList(this.previewToken,1,199,{"search[screenId]":this.comment.screenId,"search[replyTo]":this.comment.id}):h["a"].ScreenComments.getList(1,199,{"search[screenId]":this.comment.screenId,"search[replyTo]":this.comment.id}),e.then(e=>{this.replies=m["a"].createInstances(e.data),this.readComments(this.commentsList.slice())}).catch(e=>{this.$errResponseHandler(e)}).finally(()=>{this.isLoadingReplies=!1,this.$nextTick(()=>{this.scrollToLastComment()})}))},deleteComment(e){if(!this.isForPreview){var t=l["a"].findByKey(this.commentsList,"id",e);if(t){var s="";s=t.isPrimary?this.$t("Do you really want to deleted the selected comment and all its replies?"):this.$t("Do you really want to deleted the selected comment?"),window.confirm(s)&&(this.$toast(this.$t("Successfully deleted comment.")),l["a"].removeByKey(this.replies,"id",e),this.removeComment(e),this.comment.id==e&&this.close(),h["a"].ScreenComments.delete(e))}}},addComment(){if(!this.isProcessing&&this.message){var e;this.isProcessing=!0;var t=this.comment.id||null;e=this.isForPreview?h["a"].Previews.createScreenComment(this.previewToken,{replyTo:t,screenId:this.comment.screenId,left:this.comment.left,top:this.comment.top,message:this.message,from:this.from}):h["a"].ScreenComments.create({replyTo:t,screenId:this.comment.screenId,left:this.comment.left,top:this.comment.top,message:this.message}),e.then(e=>{c["a"].setItem(a["a"].get("VUE_APP_PREVIEW_COMMENT_FROM_STORAGE_KEY"),this.from),this.resetForm(),this.$toast(this.$t("Successfully added new comment."));var s=t?new m["a"]:this.comment;s.load(e.data),s.isReply?(this.replies.push(s),this.$nextTick(()=>{this.scrollToLastComment()})):this.close(),this.$emit("commentCreated",s)}).catch(e=>{this.$errResponseHandler(e)}).finally(()=>{this.isProcessing=!1})}else this.$refs.messageForm&&l["a"].isFunction(this.$refs.messageForm.reportValidity)&&this.$refs.messageForm.reportValidity()},saveCommentStatus(){var e;!this.isProcessing&&this.comment.id&&(this.isProcessing=!0,e=this.isForPreview?h["a"].Previews.updateScreenComment(this.previewToken,this.comment.id,{status:this.comment.status}):h["a"].ScreenComments.update(this.comment.id,{status:this.comment.status}),e.then(e=>{this.comment.load(e.data),this.$toast(this.$t("Successfully updated comment state.")),this.comment.isResolved&&this.close(),this.$emit("commentUpdated",this.comment)}).catch(e=>{this.$errResponseHandler(e)}).finally(()=>{this.isProcessing=!1}))},scrollToLastComment(){this.$refs.popover&&this.$refs.popover.scrollTo({behavior:"smooth",top:this.$refs.popover.scrollHeight})},readComments(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;setTimeout(()=>{for(let t=e.length-1;t>=0;t--)this.getUnreadComment(e[t].id)&&(this.previewToken?this.removeUnreadComment(e[t].id):this.markAsRead(e[t].id))},t)}})},b=w,O=Object(u["a"])(b,i,r,!1,null,null,null);t["a"]=O.exports},bcaa:function(e,t,s){var i=s("cb7c"),r=s("d3f4"),n=s("a5b8");e.exports=function(e,t){if(i(e),r(t)&&t.constructor===e)return t;var s=n.f(e),o=s.resolve;return o(t),s.promise}},c647:function(e,t,s){"use strict";s("ac6a"),s("097d");var i=s("ade3"),r=s("2f62"),n=s("f744"),o=s("dd93");s("49cb");function a(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function c(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?a(s,!0).forEach((function(t){Object(i["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):a(s).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}t["a"]={data(){return{isPreviewModeHintsActive:!1,isLoadingHotspots:!1,isLoadingHotspotTemplates:!1,fitToScreen:!1}},computed:c({},Object(r["d"])({activePrototypeId:e=>e.prototypes.activePrototypeId,hotspots:e=>e.hotspots.hotspots,hotspotTemplates:e=>e.hotspots.hotspotTemplates}),{},Object(r["c"])({getHotspot:"hotspots/getHotspot",getHotspotTemplate:"hotspots/getHotspotTemplate",getHotspotsForScreen:"hotspots/getHotspotsForScreen"})),methods:c({},Object(r["b"])({setHotspots:"hotspots/setHotspots",appendHotspots:"hotspots/appendHotspots",setHotspotTemplates:"hotspots/setHotspotTemplates"}),{loadHotspots(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;e=e||this.activePrototypeId,e&&!this.isLoadingHotspots&&(this.isLoadingHotspots=!0,n["a"].Hotspots.getList(t,200,{envelope:!0,"search[prototypeId]":e}).then(s=>{var i=o["a"].getNestedVal(s,"data.response",[]),r=o["a"].getNestedVal(s,"data.headers.x-pagination-current-page",1),n=o["a"].getNestedVal(s,"data.headers.x-pagination-page-count",1);1==t?this.setHotspots(i):this.appendHotspots(i),n>r&&this.loadHotspots(e,t+1)}).catch(e=>{this.$errResponseHandler(e)}).finally(()=>{this.isLoadingHotspots=!1}))},loadHotspotTemplates(e){e=e||this.activePrototypeId,e&&!this.isLoadingHotspotTemplates&&(this.isLoadingHotspotTemplates=!0,n["a"].HotspotTemplates.getList(1,100,{expand:"screenIds","search[prototypeId]":e}).then(e=>{this.setHotspotTemplates(e.data||[])}).catch(e=>{this.$errResponseHandler(e)}).finally(()=>{this.isLoadingHotspotTemplates=!1}))},blinkPreviewModeHints(){this.isPreviewModeHintsActive=!0,this.previewModeHintsTimeoutId&&clearTimeout(this.previewModeHintsTimeoutId),this.previewModeHintsTimeoutId=setTimeout(()=>{this.isPreviewModeHintsActive=!1},500)},toggleFitToScreen(){this.fitToScreen=!this.fitToScreen}})}}}]);