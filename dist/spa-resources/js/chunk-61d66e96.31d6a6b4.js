(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-61d66e96"],{4362:function(t,e,n){e.nextTick=function(t){var e=Array.prototype.slice.call(arguments);e.shift(),setTimeout((function(){t.apply(null,e)}),0)},e.platform=e.arch=e.execPath=e.title="browser",e.pid=1,e.browser=!0,e.env={},e.argv=[],e.binding=function(t){throw new Error("No such module. (Possibly not yet loaded)")},function(){var t,r="/";e.cwd=function(){return r},e.chdir=function(e){t||(t=n("df7c")),r=t.resolve(e,r)}}(),e.exit=e.kill=e.umask=e.dlopen=e.uptime=e.memoryUsage=e.uvCounters=function(){},e.features={}},a2cd:function(t,e,n){"use strict";n.r(e),n.d(e,"__extends",(function(){return i})),n.d(e,"__assign",(function(){return o})),n.d(e,"__rest",(function(){return s})),n.d(e,"__decorate",(function(){return u})),n.d(e,"__param",(function(){return a})),n.d(e,"__metadata",(function(){return c})),n.d(e,"__awaiter",(function(){return h})),n.d(e,"__generator",(function(){return f})),n.d(e,"__createBinding",(function(){return l})),n.d(e,"__exportStar",(function(){return p})),n.d(e,"__values",(function(){return d})),n.d(e,"__read",(function(){return v})),n.d(e,"__spread",(function(){return y})),n.d(e,"__spreadArrays",(function(){return g})),n.d(e,"__await",(function(){return m})),n.d(e,"__asyncGenerator",(function(){return w})),n.d(e,"__asyncDelegator",(function(){return b})),n.d(e,"__asyncValues",(function(){return _})),n.d(e,"__makeTemplateObject",(function(){return E})),n.d(e,"__importStar",(function(){return I})),n.d(e,"__importDefault",(function(){return T})),n.d(e,"__classPrivateFieldGet",(function(){return A})),n.d(e,"__classPrivateFieldSet",(function(){return N}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},r(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},o.apply(this,arguments)};function s(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function u(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(i=t[u])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}function a(t,e){return function(n,r){e(n,r,t)}}function c(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)}function h(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function s(t){try{a(r.next(t))}catch(e){o(e)}}function u(t){try{a(r["throw"](t))}catch(e){o(e)}}function a(t){t.done?n(t.value):i(t.value).then(s,u)}a((r=r.apply(t,e||[])).next())}))}function f(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(t){return function(e){return a([t,e])}}function a(o){if(n)throw new TypeError("Generator is already executing.");while(s)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(u){o=[6,u],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}function l(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}function p(t,e){for(var n in t)"default"===n||e.hasOwnProperty(n)||(e[n]=t[n])}function d(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{while((void 0===e||e-- >0)&&!(r=o.next()).done)s.push(r.value)}catch(u){i={error:u}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}return s}function y(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(v(arguments[e]));return t}function g(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function m(t){return this instanceof m?(this.v=t,this):new m(t)}function w(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||u(t,e)}))})}function u(t,e){try{a(i[t](e))}catch(n){f(o[0][3],n)}}function a(t){t.value instanceof m?Promise.resolve(t.value.v).then(c,h):f(o[0][2],t)}function c(t){u("next",t)}function h(t){u("throw",t)}function f(t,e){t(e),o.shift(),o.length&&u(o[0][0],o[0][1])}}function b(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:m(t[r](e)),done:"return"===r}:i?i(e):e}:i}}function _(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t="function"===typeof d?d(t):t[Symbol.iterator](),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,o){e=t[n](e),i(r,o,e.done,e.value)}))}}function i(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}}function E(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function I(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function T(t){return t&&t.__esModule?t:{default:t}}function A(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function N(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}},c7b2:function(t,e,n){"use strict";n.r(e),function(t){n.d(e,"ErrorCode",(function(){return Ir})),n.d(e,"EventType",(function(){return Tr})),n.d(e,"WebChannel",(function(){return Ar})),n.d(e,"XhrIo",(function(){return Nr})),n.d(e,"createWebChannelTransport",(function(){return Er}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},r(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function o(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var s,u="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:{},a=a||{},c=u||self;function h(){}function f(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function l(t){var e=f(t);return"array"==e||"object"==e&&"number"==typeof t.length}function p(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function d(t){return Object.prototype.hasOwnProperty.call(t,v)&&t[v]||(t[v]=++y)}var v="closure_uid_"+(1e9*Math.random()>>>0),y=0;function g(t,e,n){return t.call.apply(t.bind,arguments)}function m(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function w(t,e,n){return w=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?g:m,w.apply(null,arguments)}function b(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var _=Date.now;function E(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function I(){this.j=this.j,this.i=this.i}var T=0;I.prototype.j=!1,I.prototype.ja=function(){if(!this.j&&(this.j=!0,this.G(),0!=T))d(this)},I.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var A=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"===typeof t)return"string"!==typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},N=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"===typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function S(t){t:{for(var e=Mn,n=t.length,r="string"===typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"===typeof t?t.charAt(e):t[e]}function P(t){return Array.prototype.concat.apply([],arguments)}function x(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function D(t){return/^[\s\xa0]*$/.test(t)}var R,k=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function O(t,e){return-1!=t.indexOf(e)}function L(t,e){return t<e?-1:t>e?1:0}t:{var C=c.navigator;if(C){var V=C.userAgent;if(V){R=V;break t}}R=""}function U(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function M(t){var e={};for(var n in t)e[n]=t[n];return e}var F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function q(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i],r)t[n]=r[n];for(var o=0;o<F.length;o++)n=F[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function j(t){return j[" "](t),t}function G(t,e){var n=et;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}j[" "]=h;var B,z=O(R,"Opera"),H=O(R,"Trident")||O(R,"MSIE"),W=O(R,"Edge"),K=W||H,Y=O(R,"Gecko")&&!(O(R.toLowerCase(),"webkit")&&!O(R,"Edge"))&&!(O(R,"Trident")||O(R,"MSIE"))&&!O(R,"Edge"),X=O(R.toLowerCase(),"webkit")&&!O(R,"Edge");function Q(){var t=c.document;return t?t.documentMode:void 0}t:{var Z="",J=function(){var t=R;return Y?/rv:([^\);]+)(\)|;)/.exec(t):W?/Edge\/([\d\.]+)/.exec(t):H?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):X?/WebKit\/(\S+)/.exec(t):z?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(J&&(Z=J?J[1]:""),H){var $=Q();if(null!=$&&$>parseFloat(Z)){B=String($);break t}}B=Z}var tt,et={};function nt(t){return G(t,(function(){for(var e=0,n=k(String(B)).split("."),r=k(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=L(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||L(0==s[2].length,0==u[2].length)||L(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e}))}if(c.document&&H){var rt=Q();tt=rt||(parseInt(B,10)||void 0)}else tt=void 0;var it=tt,ot=!H||9<=Number(it),st=H&&!nt("9"),ut=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{c.addEventListener("test",h,e),c.removeEventListener("test",h,e)}catch(n){}return t}();function at(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function ct(t,e){if(at.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(Y){t:{try{j(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"===typeof t.pointerType?t.pointerType:ht[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}at.prototype.b=function(){this.defaultPrevented=!0},E(ct,at);var ht={2:"touch",3:"pen",4:"mouse"};ct.prototype.b=function(){ct.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,st)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var ft="closure_listenable_"+(1e6*Math.random()|0),lt=0;function pt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++lt,this.Y=this.Z=!1}function dt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function vt(t){this.src=t,this.a={},this.b=0}function yt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=A(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(dt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function gt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}vt.prototype.add=function(t,e,n,r,i){var o=t.toString();t=this.a[o],t||(t=this.a[o]=[],this.b++);var s=gt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):(e=new pt(e,this.src,o,!!r,i),e.Z=n,t.push(e)),e};var mt="closure_lm_"+(1e6*Math.random()|0),wt={};function bt(t,e,n,r,i){if(r&&r.once)return It(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)bt(t,e[o],n,r,i);return null}return n=Rt(n),t&&t[ft]?t.va(e,n,p(r)?!!r.capture:!!r,i):_t(t,e,n,!1,r,i)}function _t(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=p(i)?!!i.capture:!!i;if(s&&!ot)return null;var u=xt(t);if(u||(t[mt]=u=new vt(t)),n=u.add(e,n,r,s,o),n.proxy)return n;if(r=Et(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)ut||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Nt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Et(){var t=Pt,e=ot?function(n){return t.call(e.src,e.listener,n)}:function(n){if(n=t.call(e.src,e.listener,n),!n)return n};return e}function It(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)It(t,e[o],n,r,i);return null}return n=Rt(n),t&&t[ft]?t.wa(e,n,p(r)?!!r.capture:!!r,i):_t(t,e,n,!0,r,i)}function Tt(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Tt(t,e[o],n,r,i);else r=p(r)?!!r.capture:!!r,n=Rt(n),t&&t[ft]?(t=t.c,e=String(e).toString(),e in t.a&&(o=t.a[e],n=gt(o,n,r,i),-1<n&&(dt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=xt(t))&&(e=t.a[e.toString()],t=-1,e&&(t=gt(e,n,r,i)),(n=-1<t?e[t]:null)&&At(n))}function At(t){if("number"!==typeof t&&t&&!t.Y){var e=t.src;if(e&&e[ft])yt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Nt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=xt(e))?(yt(n,t),0==n.b&&(n.src=null,e[mt]=null)):dt(t)}}}function Nt(t){return t in wt?wt[t]:wt[t]="on"+t}function St(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&At(t),n.call(r,e)}function Pt(t,e){if(t.Y)return!0;if(!ot){if(!e)t:{e=["window","event"];for(var n=c,r=0;r<e.length;r++)if(n=n[e[r]],null==n){e=null;break t}e=n}return e=new ct(e,this),St(t,e)}return St(t,new ct(e,this))}function xt(t){return t=t[mt],t instanceof vt?t:null}var Dt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Rt(t){return"function"==f(t)?t:(t[Dt]||(t[Dt]=function(e){return t.handleEvent(e)}),t[Dt])}function kt(){I.call(this),this.c=new vt(this),this.J=this,this.C=null}function Ot(t,e,n,r){if(e=t.c.a[String(e)],!e)return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var u=s.listener,a=s.ca||s.src;s.Z&&yt(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}E(kt,I),kt.prototype[ft]=!0,s=kt.prototype,s.addEventListener=function(t,e,n,r){bt(this,t,e,n,r)},s.removeEventListener=function(t,e,n,r){Tt(this,t,e,n,r)},s.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"===typeof t)t=new at(t,n);else if(t instanceof at)t.target=t.target||n;else{var i=t;t=new at(r,n),q(t,i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];i=Ot(s,r,!0,t)&&i}if(s=t.a=n,i=Ot(s,r,!0,t)&&i,i=Ot(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)s=t.a=e[o],i=Ot(s,r,!1,t)&&i;return i},s.G=function(){if(kt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)dt(n[r]);delete e.a[t],e.b--}}this.C=null},s.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},s.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Lt=c.JSON.stringify;function Ct(){this.b=this.a=null}var Vt,Ut=new(function(){function t(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())((function(){return new Ft}),(function(t){t.reset()}),100);function Mt(){var t=zt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Ft(){this.next=this.b=this.a=null}function qt(t){c.setTimeout((function(){throw t}),0)}function jt(t,e){Vt||Gt(),Bt||(Vt(),Bt=!0),zt.add(t,e)}function Gt(){var t=c.Promise.resolve(void 0);Vt=function(){t.then(Ht)}}Ct.prototype.add=function(t,e){var n=Ut.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Ft.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Ft.prototype.reset=function(){this.next=this.b=this.a=null};var Bt=!1,zt=new Ct;function Ht(){for(var t;t=Mt();){try{t.a.call(t.b)}catch(n){qt(n)}var e=Ut;e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)}Bt=!1}function Wt(t,e){kt.call(this),this.b=t||1,this.a=e||c,this.f=w(this.Ya,this),this.g=_()}function Kt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Yt(t,e,n){if("function"==f(t))n&&(t=w(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=w(t.handleEvent,t)}return 2147483647<Number(e)?-1:c.setTimeout(t,e||0)}function Xt(t){t.a=Yt((function(){t.a=null,t.c&&(t.c=!1,Xt(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}E(Wt,kt),s=Wt.prototype,s.aa=!1,s.M=null,s.Ya=function(){if(this.aa){var t=_()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(Kt(this),this.start()))}},s.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=_())},s.G=function(){Wt.S.G.call(this),Kt(this),delete this.a};var Qt=function(t){function e(e,n,r){var i=t.call(this)||this;return i.g=null!=r?e.bind(r):e,i.h=n,i.b=null,i.c=!1,i.a=null,i}return i(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Xt(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(c.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(I);function Zt(t){I.call(this),this.b=t,this.a={}}E(Zt,I);var Jt=[];function $t(t,e,n,r){Array.isArray(n)||(n&&(Jt[0]=n.toString()),n=Jt);for(var i=0;i<n.length;i++){var o=bt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function te(t){U(t.a,(function(t,e){this.a.hasOwnProperty(e)&&At(t)}),t),t.a={}}function ee(){this.a=!0}function ne(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var f=h.split("_");s=2<=f.length&&"type"==f[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}function re(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}function ie(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+se(t,n)+(r?" "+r:"")}))}function oe(t,e){t.info((function(){return"TIMEOUT: "+e}))}function se(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Lt(n)}catch(u){return e}}Zt.prototype.G=function(){Zt.S.G.call(this),te(this)},Zt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ee.prototype.info=function(){};var ue=null;function ae(){return ue=ue||new kt}function ce(t){at.call(this,"serverreachability",t)}function he(t){var e=ae();e.dispatchEvent(new ce(e,t))}function fe(t){at.call(this,"statevent",t)}function le(t){var e=ae();e.dispatchEvent(new fe(e,t))}function pe(t){at.call(this,"timingevent",t)}function de(t,e){if("function"!=f(t))throw Error("Fn must not be null and must be a function");return c.setTimeout((function(){t()}),e)}E(ce,at),E(fe,at),E(pe,at);var ve={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},ye={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function ge(){}function me(t){var e;return(e=t.a)||(e=t.a={}),e}function we(){}ge.prototype.a=null;var be,_e={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Ee(){at.call(this,"d")}function Ie(){at.call(this,"c")}function Te(){}function Ae(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new Zt(this),this.P=Ne,t=K?125:void 0,this.R=new Wt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}E(Ee,at),E(Ie,at),E(Te,ge),be=new Te;var Ne=45e3,Se={},Pe={};function xe(t,e,n){t.H=1,t.i=$e(Ke(e)),t.j=n,t.I=!0,De(t,null)}function De(t,e){t.u=_(),Oe(t),t.l=Ke(t.i);var n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.D=0,t.a=dr(t.g,t.g.C?e:null),0<t.O&&(t.F=new Qt(w(t.Ca,t,t.a),t.O)),$t(t.J,t.a,"readystatechange",t.Wa),e=t.B?M(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),he(1),ne(t.c,t.m,t.l,t.f,t.T,t.j)}function Re(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=ke(t,n);if(i==Pe){4==e&&(t.h=4,le(14),r=!1),ie(t.c,t.f,null,"[Incomplete Response]");break}if(i==Se){t.h=4,le(15),ie(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}ie(t.c,t.f,i,null),Me(t,i)}4==e&&0==n.length&&(t.h=1,le(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.W&&(t.W=!0,e=t.g,e.a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),sr(e),e.F=!0)):(ie(t.c,t.f,n,"[Invalid Chunked Response]"),Ue(t),Ve(t))}function ke(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?Pe:(n=Number(e.substring(n,r)),isNaN(n)?Se:(r+=1,r+n>e.length?Pe:(e=e.substr(r,n),t.D=r+n,e)))}function Oe(t){t.U=_()+t.P,Le(t,t.P)}function Le(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=de(w(t.Ua,t),e)}function Ce(t){t.o&&(c.clearTimeout(t.o),t.o=null)}function Ve(t){0==t.g.v||t.A||cr(t.g,t)}function Ue(t){Ce(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Kt(t.R),te(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Me(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||In(n.b,t)))if(n.I=t.N,!t.C&&In(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(y){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;ar(n),Qn(n)}or(n),le(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=de(w(n.Ra,n),6e3));if(1>=En(n.b)&&n.ea){try{n.ea()}catch(y){}n.ea=void 0}}else fr(n,11)}else if((t.C||n.a==t)&&ar(n),!D(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var u=i[5];if(null!=u&&"number"===typeof u&&0<u){var a=1.5*u;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=a.b;!f.a&&(O(h,"spdy")||O(h,"quic")||O(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(Tn(f,f.b),f.b=null))}if(a.A){var l=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(a.na=l,Je(a.B,a.A,l))}}n.v=3,n.f&&n.f.ta(),n.V&&(n.N=_()-t.u,n.c.info("Handshake RTT: "+n.N+"ms")),a=n;var p=t;if(a.la=pr(a,a.C?a.ga:null,a.fa),p.C){An(a.b,p);var d=p,v=a.D;v&&d.setTimeout(v),d.o&&(Ce(d),Oe(d)),a.a=p}else ir(a);0<n.g.length&&$n(n)}else"stop"!=i[0]&&"close"!=i[0]||fr(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?fr(n,7):Xn(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);he(4)}catch(y){}}function Fe(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"===typeof t)return t.split("");if(l(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function qe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(l(t)||"string"===typeof t)N(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(l(t)||"string"===typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;r=Fe(t),i=r.length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function je(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof je)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ge(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Be(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)r=t.a[e],Be(i,r)||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Be(t,e){return Object.prototype.hasOwnProperty.call(t,e)}s=Ae.prototype,s.setTimeout=function(t){this.P=t},s.Wa=function(t){t=t.target;var e=this.F;e&&3==zn(t)?e.f():this.Ca(t)},s.Ca=function(t){try{if(t==this.a)t:{var e=zn(this.a),n=this.a.ua(),r=this.a.X();if(!(3>e||3==e&&!K&&!this.a.$())){this.A||4!=e||7==n||he(8==n||0>=r?3:2),Ce(this);var i=this.a.X();this.N=i;var o=this.a.$();if(this.b=200==i,re(this.c,this.m,this.l,this.f,this.T,e,i),this.b){if(this.V&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,le(12),Ue(this),Ve(this);break t}ie(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Me(this,a)}this.I?(Re(this,e,o),K&&this.b&&3==e&&($t(this.J,this.R,"tick",this.Va),this.R.start())):(ie(this.c,this.f,o,null),Me(this,o)),4==e&&Ue(this),this.b&&!this.A&&(4==e?cr(this.g,this):(this.b=!1,Oe(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,le(12)):(this.h=0,le(13)),Ue(this),Ve(this)}}}catch(c){}},s.Va=function(){if(this.a){var t=zn(this.a),e=this.a.$();this.D<e.length&&(Ce(this),Re(this,t,e),this.b&&4!=t&&Oe(this))}},s.cancel=function(){this.A=!0,Ue(this)},s.Ua=function(){this.o=null;var t=_();0<=t-this.U?(oe(this.c,this.l),2!=this.H&&(he(3),le(17)),Ue(this),this.h=2,Ve(this)):Le(this,this.U-t)},s=je.prototype,s.K=function(){Ge(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},s.L=function(){return Ge(this),this.a.concat()},s.get=function(t,e){return Be(this.b,t)?this.b[t]:e},s.set=function(t,e){Be(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},s.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var ze=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function He(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function We(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof We){this.a=void 0!==e?e:t.a,Ye(this,t.f),this.j=t.j,Xe(this,t.c),Qe(this,t.h),this.g=t.g,e=t.b;var n=new fn;n.c=e.c,e.a&&(n.a=new je(e.a),n.b=e.b),Ze(this,n),this.i=t.i}else t&&(n=String(t).match(ze))?(this.a=!!e,Ye(this,n[1]||"",!0),this.j=nn(n[2]||""),Xe(this,n[3]||"",!0),Qe(this,n[4]),this.g=nn(n[5]||"",!0),Ze(this,n[6]||"",!0),this.i=nn(n[7]||"")):(this.a=!!e,this.b=new fn(null,this.a))}function Ke(t){return new We(t)}function Ye(t,e,n){t.f=n?nn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Xe(t,e,n){t.c=n?nn(e,!0):e}function Qe(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ze(t,e,n){e instanceof fn?(t.b=e,gn(t.b,t.a)):(n||(e=rn(e,cn)),t.b=new fn(e,t.a))}function Je(t,e,n){t.b.set(e,n)}function $e(t){return Je(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^_()).toString(36)),t}function tn(t){return t instanceof We?Ke(t):new We(t,void 0)}function en(t,e,n,r){var i=new We(null,void 0);return t&&Ye(i,t),e&&Xe(i,e),n&&Qe(i,n),r&&(i.g=r),i}function nn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function rn(t,e,n){return"string"===typeof t?(t=encodeURI(t).replace(e,on),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function on(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(15&t).toString(16)}We.prototype.toString=function(){var t=[],e=this.f;e&&t.push(rn(e,sn,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(rn(e,sn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.h,null!=n&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(rn(n,"/"==n.charAt(0)?an:un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",rn(n,hn)),t.join("")};var sn=/[#\/\?@]/g,un=/[#\?:]/g,an=/[#\?]/g,cn=/[#\?@]/g,hn=/#/g;function fn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ln(t){t.a||(t.a=new je,t.b=0,t.c&&He(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function pn(t,e){ln(t),e=yn(t,e),Be(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,t=t.a,Be(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ge(t)))}function dn(t,e){return ln(t),e=yn(t,e),Be(t.a.b,e)}function vn(t,e,n){pn(t,e),0<n.length&&(t.c=null,t.a.set(yn(t,e),x(n)),t.b+=n.length)}function yn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function gn(t,e){e&&!t.f&&(ln(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(pn(this,e),vn(this,n,t))}),t)),t.f=e}function mn(t,e){this.b=t,this.a=e}function wn(t){this.g=t||bn,c.PerformanceNavigationTiming?(t=c.performance.getEntriesByType("navigation"),t=0<t.length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol)):t=!!(c.ia&&c.ia.ya&&c.ia.ya()&&c.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}s=fn.prototype,s.add=function(t,e){ln(this),this.c=null,t=yn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},s.forEach=function(t,e){ln(this),this.a.forEach((function(n,r){N(n,(function(n){t.call(e,n,r,this)}),this)}),this)},s.L=function(){ln(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},s.K=function(t){ln(this);var e=[];if("string"===typeof t)dn(this,t)&&(e=P(e,this.a.get(yn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=P(e,t[n])}return e},s.set=function(t,e){return ln(this),this.c=null,t=yn(this,t),dn(this,t)&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},s.get=function(t,e){return t?(t=this.K(t),0<t.length?String(t[0]):e):e},s.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var bn=10;function _n(t){return!!t.b||!!t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function In(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function An(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=o(t.a.values()),s=i.next();!s.done;s=i.next()){var u=s.value;r=r.concat(u.s)}}catch(a){e={error:a}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return x(t.c)}function Sn(){}function Pn(){this.a=new Sn}function xn(t,e,n){var r=n||"";try{qe(t,(function(t,n){var i=t;p(t)&&(i=Lt(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function Dn(t,e){var n=new ee;if(c.Image){var r=new Image;r.onload=b(Rn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=b(Rn,n,r,"TestLoadImage: error",!1,e),r.onabort=b(Rn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=b(Rn,n,r,"TestLoadImage: timeout",!1,e),c.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}function Rn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}wn.prototype.cancel=function(){var t,e;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=o(this.a.values()),r=n.next();!r.done;r=n.next()){var i=r.value;i.cancel()}}catch(s){t={error:s}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Sn.prototype.stringify=function(t){return c.JSON.stringify(t,void 0)},Sn.prototype.parse=function(t){return c.JSON.parse(t,void 0)};var kn=c.JSON.parse;function On(t){kt.call(this),this.headers=new je,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Ln,this.D=this.F=!1}E(On,kt);var Ln="",Cn=/^https?$/i,Vn=["POST","PUT"];function Un(t){return H&&nt(9)&&"number"===typeof t.timeout&&void 0!==t.ontimeout}function Mn(t){return"content-type"==t.toLowerCase()}function Fn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,qn(t),Gn(t)}function qn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function jn(t){if(t.b&&"undefined"!=typeof a&&(!t.s[1]||4!=zn(t)||2!=t.X()))if(t.l&&4==zn(t))Yt(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==zn(t)){t.b=!1;try{var e,n=t.X();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(ze)[1]||null;if(!o&&c.self&&c.self.location){var s=c.self.location.protocol;o=s.substr(0,s.length-1)}i=!Cn.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<zn(t)?t.a.statusText:""}catch(h){u=""}t.f=u+" ["+t.X()+"]",qn(t)}}finally{Gn(t)}}}function Gn(t,e){if(t.a){Bn(t);var n=t.a,r=t.s[0]?h:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){}}}function Bn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(c.clearTimeout(t.m),t.m=null)}function zn(t){return t.a?t.a.readyState:0}function Hn(t){var e="";return U(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function Wn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=Hn(n),"string"===typeof t?null!=n&&encodeURIComponent(String(n)):Je(t,e,n))}function Kn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Yn(t){this.pa=0,this.g=[],this.c=new ee,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Kn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Kn("baseRetryDelayMs",5e3,t),this.Ma=Kn("retryDelaySeedMs",1e4,t),this.Ja=Kn("forwardChannelMaxRetries",2,t),this.ma=Kn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new Pn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Xn(t){if(Zn(t),3==t.v){var e=t.R++,n=Ke(t.B);Je(n,"SID",t.J),Je(n,"RID",e),Je(n,"TYPE","terminate"),nr(t,n),e=new Ae(t,t.c,e,void 0),e.H=2,e.i=$e(Ke(n)),n=!1,c.navigator&&c.navigator.sendBeacon&&(n=c.navigator.sendBeacon(e.i.toString(),"")),!n&&c.Image&&((new Image).src=e.i,n=!0),n||(e.a=dr(e.g,null),e.a.ba(e.i)),e.u=_(),Oe(e)}lr(t)}function Qn(t){t.a&&(sr(t),t.a.cancel(),t.a=null)}function Zn(t){Qn(t),t.j&&(c.clearTimeout(t.j),t.j=null),ar(t),t.b.cancel(),t.h&&("number"===typeof t.h&&c.clearTimeout(t.h),t.h=null)}function Jn(t,e){t.g.push(new mn(t.La++,e)),3==t.v&&$n(t)}function $n(t){_n(t.b)||t.h||(t.h=!0,jt(t.Ba,t),t.u=0)}function tr(t,e){return!(En(t.b)>=t.b.f-(t.h?1:0))&&(t.h?(t.g=e.s.concat(t.g),!0):!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja))&&(t.h=de(w(t.Ba,t,e),hr(t,t.u)),t.u++,!0))}function er(t,e){var n;n=e?e.f:t.R++;var r=Ke(t.B);Je(r,"SID",t.J),Je(r,"RID",n),Je(r,"AID",t.P),nr(t,r),t.i&&t.l&&Wn(r,t.i,t.l),n=new Ae(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=rr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Tn(t.b,n),xe(n,r,e)}function nr(t,e){t.f&&qe({},(function(t,n){Je(e,n,t)}))}function rr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?w(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(c-=o,0>c)o=Math.max(0,i[a].b-100),u=!1;else try{xn(h,s,"req"+c+"_")}catch(f){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function ir(t){t.a||t.j||(t.U=1,jt(t.Aa,t),t.o=0)}function or(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=de(w(t.Aa,t),hr(t,t.o)),t.o++,!0)}function sr(t){null!=t.s&&(c.clearTimeout(t.s),t.s=null)}function ur(t){t.a=new Ae(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ke(t.la);Je(e,"RID","rpc"),Je(e,"SID",t.J),Je(e,"CI",t.H?"0":"1"),Je(e,"AID",t.P),nr(t,e),Je(e,"TYPE","xmlhttp"),t.i&&t.l&&Wn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=$e(Ke(e)),n.j=null,n.I=!0,De(n,t)}function ar(t){null!=t.m&&(c.clearTimeout(t.m),t.m=null)}function cr(t,e){var n=null;if(t.a==e){ar(t),sr(t),t.a=null;var r=2}else{if(!In(t.b,e))return;n=e.s,An(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=_()-e.u;var i=t.u;r=ae(),r.dispatchEvent(new pe(r,n,e,i)),$n(t)}else ir(t);else if(i=e.h,3==i||0==i&&0<t.I||!(1==r&&tr(t,e)||2==r&&or(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:fr(t,5);break;case 4:fr(t,10);break;case 3:fr(t,6);break;default:fr(t,2)}}function hr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function fr(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=w(t.Xa,t);n||(n=new We("//www.google.com/images/cleardot.gif"),c.location&&"http"==c.location.protocol||Ye(n,"https"),$e(n)),Dn(n.toString(),r)}else le(2);t.v=0,t.f&&t.f.ra(e),lr(t),Zn(t)}function lr(t){t.v=0,t.I=-1,t.f&&(0==Nn(t.b).length&&0==t.g.length||(t.b.c.length=0,x(t.g),t.g.length=0),t.f.qa())}function pr(t,e,n){var r=tn(n);if(""!=r.c)e&&Xe(r,e+"."+r.c),Qe(r,r.h);else{var i=c.location;r=en(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.W&&U(t.W,(function(t,e){Je(r,e,t)})),e=t.A,n=t.na,e&&n&&Je(r,e,n),Je(r,"VER",t.ha),nr(t,r),r}function dr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return e=new On(t.Ka),e.F=t.C,e}function vr(){}function yr(){if(H&&!(10<=Number(it)))throw Error("Environmental error: no available transport.")}function gr(t,e){kt.call(this),this.a=new Yn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!D(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!D(e)&&(this.a.A=e,t=this.b,null!==t&&e in t&&(t=this.b,e in t&&delete t[e])),this.f=new br(this)}function mr(t){Ee.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function wr(){Ie.call(this),this.status=1}function br(t){this.a=t}s=On.prototype,s.ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?me(this.H):me(be),this.a.onreadystatechange=w(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void Fn(this,o)}t=n||"";var i=new je(this.headers);r&&qe(r,(function(t,e){i.set(e,t)})),r=S(i.L()),n=c.FormData&&t instanceof c.FormData,!(0<=A(Vn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Bn(this),0<this.o&&((this.D=Un(this.a))?(this.a.timeout=this.o,this.a.ontimeout=w(this.xa,this)):this.m=Yt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){Fn(this,o)}},s.xa=function(){"undefined"!=typeof a&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},s.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Gn(this))},s.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Gn(this,!0)),On.S.G.call(this)},s.za=function(){this.j||(this.A||this.l||this.g?jn(this):this.Ta())},s.Ta=function(){jn(this)},s.X=function(){try{return 2<zn(this)?this.a.status:-1}catch(t){return-1}},s.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},s.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),kn(e)}},s.ua=function(){return this.h},s.Qa=function(){return"string"===typeof this.f?this.f:String(this.f)},s=Yn.prototype,s.ha=8,s.v=1,s.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ae(this,this.c,t,void 0),r=this.l;if(this.O&&(r?(r=M(r),q(r,this.O)):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(o="__data__"in o.a&&(o=o.a.__data__,"string"===typeof o)?o.length:void 0,void 0===o)break;if(e+=o,4096<e){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=rr(this,n,e),i=Ke(this.B),Je(i,"RID",t),Je(i,"CVER",22),this.A&&Je(i,"X-HTTP-Session-Id",this.A),nr(this,i),this.i&&r&&Wn(i,this.i,r),Tn(this.b,n),this.Ga&&Je(i,"TYPE","init"),this.da?(Je(i,"$req",e),Je(i,"SID","null"),n.V=!0,xe(n,i,null)):xe(n,i,e),this.v=2}}else 3==this.v&&(t?er(this,t):0==this.g.length||_n(this.b)||er(this))},s.Aa=function(){if(this.j=null,ur(this),this.V&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=de(w(this.Sa,this),t)}},s.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Qn(this),ur(this))},s.Ra=function(){null!=this.m&&(this.m=null,Qn(this),or(this),le(19))},s.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),le(2)):(this.c.info("Failed to ping google.com"),le(1))},s=vr.prototype,s.ta=function(){},s.sa=function(){},s.ra=function(){},s.qa=function(){},s.Ha=function(){},yr.prototype.a=function(t,e){return new gr(t,e)},E(gr,kt),s=gr.prototype,s.addEventListener=function(t,e,n,r){gr.S.addEventListener.call(this,t,e,n,r)},s.removeEventListener=function(t,e,n,r){gr.S.removeEventListener.call(this,t,e,n,r)},s.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;le(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=pr(t,null,t.fa),$n(t)},s.close=function(){Xn(this.a)},s.Pa=function(t){if("string"===typeof t){var e={};e.__data__=t,Jn(this.a,e)}else this.g?(e={},e.__data__=Lt(t),Jn(this.a,e)):Jn(this.a,t)},s.G=function(){this.a.f=null,delete this.f,Xn(this.a),delete this.a,gr.S.G.call(this)},E(mr,Ee),E(wr,Ie),E(br,vr),br.prototype.ta=function(){this.a.dispatchEvent("a")},br.prototype.sa=function(t){this.a.dispatchEvent(new mr(t))},br.prototype.ra=function(t){this.a.dispatchEvent(new wr(t))},br.prototype.qa=function(){this.a.dispatchEvent("b")},yr.prototype.createWebChannel=yr.prototype.a,gr.prototype.send=gr.prototype.Pa,gr.prototype.open=gr.prototype.Oa,gr.prototype.close=gr.prototype.close,ve.NO_ERROR=0,ve.TIMEOUT=8,ve.HTTP_ERROR=6,ye.COMPLETE="complete",we.EventType=_e,_e.OPEN="a",_e.CLOSE="b",_e.ERROR="c",_e.MESSAGE="d",kt.prototype.listen=kt.prototype.va,On.prototype.listenOnce=On.prototype.wa,On.prototype.getLastError=On.prototype.Qa,On.prototype.getLastErrorCode=On.prototype.ua,On.prototype.getStatus=On.prototype.X,On.prototype.getResponseJson=On.prototype.Na,On.prototype.getResponseText=On.prototype.$,On.prototype.send=On.prototype.ba;var _r={createWebChannelTransport:function(){return new yr},ErrorCode:ve,EventType:ye,WebChannel:we,XhrIo:On},Er=_r.createWebChannelTransport,Ir=_r.ErrorCode,Tr=_r.EventType,Ar=_r.WebChannel,Nr=_r.XhrIo;e["default"]=_r}.call(this,n("c8ba"))},df7c:function(t,e,n){(function(t){function n(t,e){for(var n=0,r=t.length-1;r>=0;r--){var i=t[r];"."===i?t.splice(r,1):".."===i?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function r(t){"string"!==typeof t&&(t+="");var e,n=0,r=-1,i=!0;for(e=t.length-1;e>=0;--e)if(47===t.charCodeAt(e)){if(!i){n=e+1;break}}else-1===r&&(i=!1,r=e+1);return-1===r?"":t.slice(n,r)}function i(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}e.resolve=function(){for(var e="",r=!1,o=arguments.length-1;o>=-1&&!r;o--){var s=o>=0?arguments[o]:t.cwd();if("string"!==typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(e=s+"/"+e,r="/"===s.charAt(0))}return e=n(i(e.split("/"),(function(t){return!!t})),!r).join("/"),(r?"/":"")+e||"."},e.normalize=function(t){var r=e.isAbsolute(t),s="/"===o(t,-1);return t=n(i(t.split("/"),(function(t){return!!t})),!r).join("/"),t||r||(t="."),t&&s&&(t+="/"),(r?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(i(t,(function(t,e){if("string"!==typeof t)throw new TypeError("Arguments to path.join must be strings");return t})).join("/"))},e.relative=function(t,n){function r(t){for(var e=0;e<t.length;e++)if(""!==t[e])break;for(var n=t.length-1;n>=0;n--)if(""!==t[n])break;return e>n?[]:t.slice(e,n-e+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var i=r(t.split("/")),o=r(n.split("/")),s=Math.min(i.length,o.length),u=s,a=0;a<s;a++)if(i[a]!==o[a]){u=a;break}var c=[];for(a=u;a<i.length;a++)c.push("..");return c=c.concat(o.slice(u)),c.join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){if("string"!==typeof t&&(t+=""),0===t.length)return".";for(var e=t.charCodeAt(0),n=47===e,r=-1,i=!0,o=t.length-1;o>=1;--o)if(e=t.charCodeAt(o),47===e){if(!i){r=o;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"/":t.slice(0,r)},e.basename=function(t,e){var n=r(t);return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},e.extname=function(t){"string"!==typeof t&&(t+="");for(var e=-1,n=0,r=-1,i=!0,o=0,s=t.length-1;s>=0;--s){var u=t.charCodeAt(s);if(47!==u)-1===r&&(i=!1,r=s+1),46===u?-1===e?e=s:1!==o&&(o=1):-1!==e&&(o=-1);else if(!i){n=s+1;break}}return-1===e||-1===r||0===o||1===o&&e===r-1&&e===n+1?"":t.slice(e,r)};var o="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(this,n("4362"))},e71f:function(t,e,n){"use strict";n.r(e);n("e89a")},e89a:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var r=n("a2cd"),i=n("c23d"),o=n("abfd"),s=n("cd51"),u=n("c7b2"),a=n("4be4");function c(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var h=c(i),f=new o.Logger("@firebase/firestore");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l(){return f.logLevel}function p(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(f.logLevel<=o.LogLevel.DEBUG){var i=e.map(y);f.debug.apply(f,r.__spreadArrays(["Firestore (7.19.1): "+t],i))}}function d(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(f.logLevel<=o.LogLevel.ERROR){var i=e.map(y);f.error.apply(f,r.__spreadArrays(["Firestore (7.19.1): "+t],i))}}function v(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(f.logLevel<=o.LogLevel.WARN){var i=e.map(y);f.warn.apply(f,r.__spreadArrays(["Firestore (7.19.1): "+t],i))}}function y(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (7.19.1) INTERNAL ASSERTION FAILED: "+t;throw d(e),new Error(e)}function m(t,e){t||g()}function w(t,e){return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _=function(){function t(){}return t.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=b(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function E(t,e){return t<e?-1:t>e?1:0}function I(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function T(t){return t+"\0"}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var A=function(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i},N=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.o=function(t){return E(this.projectId,t.projectId)||E(this.database,t.database)},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function P(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function x(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var D=function(){function t(t,e){this.h=t,this.u=e,this.l={}}return t.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.u(s,t))return u}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){P(this.l,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];t(s,u)}}))},t.prototype._=function(){return x(this.l)},t}(),R={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},k=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return r.__extends(e,t),e}(Error),O=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new k(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new k(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new k(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new k(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.T=function(t){return this.seconds===t.seconds?E(this.nanoseconds,t.nanoseconds):E(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),L=function(){function t(t){this.timestamp=t}return t.I=function(e){return new t(e)},t.min=function(){return new t(new O(0,0))},t.prototype.o=function(t){return this.timestamp.T(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.m=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.A=function(){return this.timestamp},t}(),C=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&g(),void 0===n?n=t.length-e:n>t.length-e&&g(),this.segments=t,this.offset=e,this.R=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.R},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.P(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.g(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.V=function(t){return t=void 0===t?1:t,this.g(this.segments,this.offset+t,this.length-t)},t.prototype.p=function(){return this.g(this.segments,this.offset,this.length-1)},t.prototype.v=function(){return this.segments[this.offset]},t.prototype.S=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype._=function(){return 0===this.length},t.prototype.D=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.C=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.N=function(){return this.segments.slice(this.offset,this.limit())},t.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),V=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.g=function(t,n,r){return new e(t,n,r)},e.prototype.F=function(){return this.N().join("/")},e.prototype.toString=function(){return this.F()},e.k=function(t){if(t.indexOf("//")>=0)throw new k(R.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new e(t.split("/").filter((function(t){return t.length>0})))},e.$=function(){return new e([])},e}(C),U=/^[_a-zA-Z][_a-zA-Z0-9]*$/,M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.g=function(t,n,r){return new e(t,n,r)},e.O=function(t){return U.test(t)},e.prototype.F=function(){return this.N().map((function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.O(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.F()},e.prototype.M=function(){return 1===this.length&&"__name__"===this.get(0)},e.L=function(){return new e(["__name__"])},e.q=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new k(R.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new k(R.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new k(R.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new k(R.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.$=function(){return new e([])},e}(C),F=function(){function t(t){this.path=t}return t.B=function(e){return new t(V.k(e))},t.U=function(e){return new t(V.k(e).V(5))},t.prototype.W=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===V.P(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.P=function(t,e){return V.P(t.path,e.path)},t.j=function(t){return t.length%2==0},t.K=function(e){return new t(new V(e.slice()))},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q(t){return null==t}function j(t){return-0===t&&1/t==-1/0}function G(t){return"number"==typeof t&&Number.isInteger(t)&&!j(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var B=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.G=null};function z(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new B(t,e,n,r,i,o,s)}function H(t){var e=w(t);if(null===e.G){var n=e.path.F();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.F()+t.op.toString()+Vt(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return(e=t).field.F()+e.dir;var e})).join(","),q(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Cn(e.startAt)),e.endAt&&(n+="|ub:",n+=Cn(e.endAt)),e.G=n}return e.G}function W(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!qn(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!kt(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Un(t.startAt,e.startAt)&&Un(t.endAt,e.endAt)}function K(t){return F.j(t.path)&&null===t.collectionGroup&&0===t.filters.length}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Y=function(){function t(t){this.H=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.H,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.H)},t.prototype.Y=function(){return 2*this.H.length},t.prototype.o=function(t){return E(this.H,t.H)},t.prototype.isEqual=function(t){return this.H===t.H},t}();Y.J=new Y("");var X,Q,Z=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=L.min()),void 0===o&&(o=L.min()),void 0===s&&(s=Y.J),this.target=t,this.targetId=e,this.X=n,this.sequenceNumber=r,this.Z=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.tt=function(e){return new t(this.target,this.targetId,this.X,e,this.Z,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.et=function(e,n){return new t(this.target,this.targetId,this.X,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.nt=function(e){return new t(this.target,this.targetId,this.X,this.sequenceNumber,this.Z,e,this.resumeToken)},t}(),J=function(t){this.count=t};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $(t){switch(t){case R.OK:return g();case R.CANCELLED:case R.UNKNOWN:case R.DEADLINE_EXCEEDED:case R.RESOURCE_EXHAUSTED:case R.INTERNAL:case R.UNAVAILABLE:case R.UNAUTHENTICATED:return!1;case R.INVALID_ARGUMENT:case R.NOT_FOUND:case R.ALREADY_EXISTS:case R.PERMISSION_DENIED:case R.FAILED_PRECONDITION:case R.ABORTED:case R.OUT_OF_RANGE:case R.UNIMPLEMENTED:case R.DATA_LOSS:return!0;default:return g()}}function tt(t){if(void 0===t)return d("GRPC error has no .code"),R.UNKNOWN;switch(t){case X.OK:return R.OK;case X.CANCELLED:return R.CANCELLED;case X.UNKNOWN:return R.UNKNOWN;case X.DEADLINE_EXCEEDED:return R.DEADLINE_EXCEEDED;case X.RESOURCE_EXHAUSTED:return R.RESOURCE_EXHAUSTED;case X.INTERNAL:return R.INTERNAL;case X.UNAVAILABLE:return R.UNAVAILABLE;case X.UNAUTHENTICATED:return R.UNAUTHENTICATED;case X.INVALID_ARGUMENT:return R.INVALID_ARGUMENT;case X.NOT_FOUND:return R.NOT_FOUND;case X.ALREADY_EXISTS:return R.ALREADY_EXISTS;case X.PERMISSION_DENIED:return R.PERMISSION_DENIED;case X.FAILED_PRECONDITION:return R.FAILED_PRECONDITION;case X.ABORTED:return R.ABORTED;case X.OUT_OF_RANGE:return R.OUT_OF_RANGE;case X.UNIMPLEMENTED:return R.UNIMPLEMENTED;case X.DATA_LOSS:return R.DATA_LOSS;default:return g()}}(Q=X||(X={}))[Q.OK=0]="OK",Q[Q.CANCELLED=1]="CANCELLED",Q[Q.UNKNOWN=2]="UNKNOWN",Q[Q.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Q[Q.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Q[Q.NOT_FOUND=5]="NOT_FOUND",Q[Q.ALREADY_EXISTS=6]="ALREADY_EXISTS",Q[Q.PERMISSION_DENIED=7]="PERMISSION_DENIED",Q[Q.UNAUTHENTICATED=16]="UNAUTHENTICATED",Q[Q.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Q[Q.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Q[Q.ABORTED=10]="ABORTED",Q[Q.OUT_OF_RANGE=11]="OUT_OF_RANGE",Q[Q.UNIMPLEMENTED=12]="UNIMPLEMENTED",Q[Q.INTERNAL=13]="INTERNAL",Q[Q.UNAVAILABLE=14]="UNAVAILABLE",Q[Q.DATA_LOSS=15]="DATA_LOSS";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var et=function(){function t(t,e){this.P=t,this.root=e||rt.EMPTY}return t.prototype.st=function(e,n){return new t(this.P,this.root.st(e,n,this.P).copy(null,null,rt.it,null,null))},t.prototype.remove=function(e){return new t(this.P,this.root.remove(e,this.P).copy(null,null,rt.it,null,null))},t.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype._=function(){return this.root._()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.rt=function(){return this.root.rt()},t.prototype.ot=function(){return this.root.ot()},t.prototype.ht=function(t){return this.root.ht(t)},t.prototype.forEach=function(t){this.ht((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.ht((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.at=function(t){return this.root.at(t)},t.prototype.ut=function(){return new nt(this.root,null,this.P,!1)},t.prototype.ct=function(t){return new nt(this.root,t,this.P,!1)},t.prototype.lt=function(){return new nt(this.root,null,this.P,!0)},t.prototype._t=function(t){return new nt(this.root,t,this.P,!0)},t}(),nt=function(){function t(t,e,n,r){this.ft=r,this.dt=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.ft?t.left:t.right;else{if(0===i){this.dt.push(t);break}this.dt.push(t),t=this.ft?t.right:t.left}}return t.prototype.wt=function(){var t=this.dt.pop(),e={key:t.key,value:t.value};if(this.ft)for(t=t.left;!t._();)this.dt.push(t),t=t.right;else for(t=t.right;!t._();)this.dt.push(t),t=t.left;return e},t.prototype.Tt=function(){return this.dt.length>0},t.prototype.Et=function(){if(0===this.dt.length)return null;var t=this.dt[this.dt.length-1];return{key:t.key,value:t.value}},t}(),rt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype._=function(){return!1},t.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},t.prototype.at=function(t){return this.right.at(t)||t(this.key,this.value)||this.left.at(t)},t.prototype.min=function(){return this.left._()?this:this.left.min()},t.prototype.rt=function(){return this.min().key},t.prototype.ot=function(){return this.right._()?this.key:this.right.ot()},t.prototype.st=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.st(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.st(t,e,n))).It()},t.prototype.At=function(){if(this.left._())return t.EMPTY;var e=this;return e.left.Rt()||e.left.left.Rt()||(e=e.Pt()),(e=e.copy(null,null,null,e.left.At(),null)).It()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left._()||i.left.Rt()||i.left.left.Rt()||(i=i.Pt()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.Rt()&&(i=i.gt()),i.right._()||i.right.Rt()||i.right.left.Rt()||(i=i.Vt()),0===n(e,i.key)){if(i.right._())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.At())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.It()},t.prototype.Rt=function(){return this.color},t.prototype.It=function(){var t=this;return t.right.Rt()&&!t.left.Rt()&&(t=t.yt()),t.left.Rt()&&t.left.left.Rt()&&(t=t.gt()),t.left.Rt()&&t.right.Rt()&&(t=t.pt()),t},t.prototype.Pt=function(){var t=this.pt();return t.right.left.Rt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.gt())).yt()).pt()),t},t.prototype.Vt=function(){var t=this.pt();return t.left.left.Rt()&&(t=(t=t.gt()).pt()),t},t.prototype.yt=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.gt=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.pt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.bt=function(){var t=this.vt();return Math.pow(2,t)<=this.size+1},t.prototype.vt=function(){if(this.Rt()&&this.left.Rt())throw g();if(this.right.Rt())throw g();var t=this.left.vt();if(t!==this.right.vt())throw g();return t+(this.Rt()?0:1)},t}();rt.EMPTY=null,rt.RED=!0,rt.it=!1,rt.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw g()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw g()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw g()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw g()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw g()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.st=function(t,e,n){return new rt(t,e)},t.prototype.remove=function(t,e){return this},t.prototype._=function(){return!0},t.prototype.ht=function(t){return!1},t.prototype.at=function(t){return!1},t.prototype.rt=function(){return null},t.prototype.ot=function(){return null},t.prototype.Rt=function(){return!1},t.prototype.bt=function(){return!0},t.prototype.vt=function(){return 0},t}());
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var it=function(){function t(t){this.P=t,this.data=new et(this.P)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.rt()},t.prototype.last=function(){return this.data.ot()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.ht((function(e,n){return t(e),!1}))},t.prototype.St=function(t,e){for(var n=this.data.ct(t[0]);n.Tt();){var r=n.wt();if(this.P(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Dt=function(t,e){var n;for(n=void 0!==e?this.data.ct(e):this.data.ut();n.Tt();)if(!t(n.wt().key))return},t.prototype.Ct=function(t){var e=this.data.ct(t);return e.Tt()?e.wt().key:null},t.prototype.ut=function(){return new ot(this.data.ut())},t.prototype.ct=function(t){return new ot(this.data.ct(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).st(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype._=function(){return this.data._()},t.prototype.Nt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.ut(),r=e.data.ut();n.Tt();){var i=n.wt().key,o=r.wt().key;if(0!==this.P(i,o))return!1}return!0},t.prototype.N=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.P);return n.data=e,n},t}(),ot=function(){function t(t){this.Ft=t}return t.prototype.wt=function(){return this.Ft.wt().key},t.prototype.Tt=function(){return this.Ft.Tt()},t}(),st=new et(F.P);function ut(){return st}function at(){return ut()}var ct=new et(F.P);function ht(){return ct}var ft=new et(F.P),lt=new it(F.P);function pt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=lt,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var dt=new it(E);function vt(){return dt}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yt=function(){function t(t){this.P=t?function(e,n){return t(e,n)||F.P(e.key,n.key)}:function(t,e){return F.P(t.key,e.key)},this.kt=ht(),this.$t=new et(this.P)}return t.xt=function(e){return new t(e.P)},t.prototype.has=function(t){return null!=this.kt.get(t)},t.prototype.get=function(t){return this.kt.get(t)},t.prototype.first=function(){return this.$t.rt()},t.prototype.last=function(){return this.$t.ot()},t.prototype._=function(){return this.$t._()},t.prototype.indexOf=function(t){var e=this.kt.get(t);return e?this.$t.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.$t.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.$t.ht((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.kt.st(t.key,t),e.$t.st(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.kt.remove(t),this.$t.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.$t.ut(),r=e.$t.ut();n.Tt();){var i=n.wt().key,o=r.wt().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.P=this.P,r.kt=e,r.$t=n,r},t}(),gt=function(){function t(){this.Ot=new et(F.P)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Ot.get(e);n?0!==t.type&&3===n.type?this.Ot=this.Ot.st(e,t):3===t.type&&1!==n.type?this.Ot=this.Ot.st(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ot=this.Ot.st(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ot=this.Ot.st(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ot=this.Ot.remove(e):1===t.type&&2===n.type?this.Ot=this.Ot.st(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ot=this.Ot.st(e,{type:2,doc:t.doc}):g():this.Ot=this.Ot.st(e,t)},t.prototype.Mt=function(){var t=[];return this.Ot.ht((function(e,n){t.push(n)})),t},t}(),mt=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Lt=n,this.docChanges=r,this.qt=i,this.fromCache=o,this.Bt=s,this.Ut=u}return t.Qt=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,yt.xt(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.qt._()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Bt===t.Bt&&this.qt.isEqual(t.qt)&&bn(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Lt.isEqual(t.Lt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),wt=function(){function t(t,e,n,r,i){this.Z=t,this.Wt=e,this.jt=n,this.Kt=r,this.Gt=i}return t.zt=function(e,n){var r=new Map;return r.set(e,bt.Ht(e,n)),new t(L.min(),r,vt(),ut(),pt())},t}(),bt=function(){function t(t,e,n,r,i){this.resumeToken=t,this.Yt=e,this.Jt=n,this.Xt=r,this.Zt=i}return t.Ht=function(e,n){return new t(Y.J,n,pt(),pt(),pt())},t}(),_t=function(t,e,n,r){this.te=t,this.removedTargetIds=e,this.key=n,this.ee=r},Et=function(t,e){this.targetId=t,this.ne=e},It=function(t,e,n,r){void 0===n&&(n=Y.J),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Tt=function(){function t(){this.se=0,this.ie=St(),this.re=Y.J,this.oe=!1,this.he=!0}return Object.defineProperty(t.prototype,"Yt",{get:function(){return this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ae",{get:function(){return 0!==this.se},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ue",{get:function(){return this.he},enumerable:!1,configurable:!0}),t.prototype.ce=function(t){t.Y()>0&&(this.he=!0,this.re=t)},t.prototype.le=function(){var t=pt(),e=pt(),n=pt();return this.ie.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:g()}})),new bt(this.re,this.oe,t,e,n)},t.prototype._e=function(){this.he=!1,this.ie=St()},t.prototype.fe=function(t,e){this.he=!0,this.ie=this.ie.st(t,e)},t.prototype.de=function(t){this.he=!0,this.ie=this.ie.remove(t)},t.prototype.we=function(){this.se+=1},t.prototype.Te=function(){this.se-=1},t.prototype.Ee=function(){this.he=!0,this.oe=!0},t}(),At=function(){function t(t){this.Ie=t,this.me=new Map,this.Ae=ut(),this.Re=Nt(),this.Pe=new it(E)}return t.prototype.ge=function(t){for(var e=0,n=t.te;e<n.length;e++){var r=n[e];t.ee instanceof un?this.Ve(r,t.ee):t.ee instanceof an&&this.ye(r,t.key,t.ee)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ye(s,t.key,t.ee)}},t.prototype.pe=function(t){var e=this;this.be(t,(function(n){var r=e.ve(n);switch(t.state){case 0:e.Se(n)&&r.ce(t.resumeToken);break;case 1:r.Te(),r.ae||r._e(),r.ce(t.resumeToken);break;case 2:r.Te(),r.ae||e.removeTarget(n);break;case 3:e.Se(n)&&(r.Ee(),r.ce(t.resumeToken));break;case 4:e.Se(n)&&(e.De(n),r.ce(t.resumeToken));break;default:g()}}))},t.prototype.be=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.me.forEach((function(t,r){n.Se(r)&&e(r)}))},t.prototype.Ce=function(t){var e=t.targetId,n=t.ne.count,r=this.Ne(e);if(r){var i=r.target;if(K(i))if(0===n){var o=new F(i.path);this.ye(e,o,new an(o,L.min()))}else m(1===n);else this.Fe(e)!==n&&(this.De(e),this.Pe=this.Pe.add(e))}},t.prototype.ke=function(t){var e=this,n=new Map;this.me.forEach((function(r,i){var o=e.Ne(i);if(o){if(r.Yt&&K(o.target)){var s=new F(o.target.path);null!==e.Ae.get(s)||e.$e(i,s)||e.ye(i,s,new an(s,t))}r.ue&&(n.set(i,r.le()),r._e())}}));var r=pt();this.Re.forEach((function(t,n){var i=!0;n.Dt((function(t){var n=e.Ne(t);return!n||2===n.X||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new wt(t,n,this.Pe,this.Ae,r);return this.Ae=ut(),this.Re=Nt(),this.Pe=new it(E),i},t.prototype.Ve=function(t,e){if(this.Se(t)){var n=this.$e(t,e.key)?2:0;this.ve(t).fe(e.key,n),this.Ae=this.Ae.st(e.key,e),this.Re=this.Re.st(e.key,this.xe(e.key).add(t))}},t.prototype.ye=function(t,e,n){if(this.Se(t)){var r=this.ve(t);this.$e(t,e)?r.fe(e,1):r.de(e),this.Re=this.Re.st(e,this.xe(e).delete(t)),n&&(this.Ae=this.Ae.st(e,n))}},t.prototype.removeTarget=function(t){this.me.delete(t)},t.prototype.Fe=function(t){var e=this.ve(t).le();return this.Ie.Oe(t).size+e.Jt.size-e.Zt.size},t.prototype.we=function(t){this.ve(t).we()},t.prototype.ve=function(t){var e=this.me.get(t);return e||(e=new Tt,this.me.set(t,e)),e},t.prototype.xe=function(t){var e=this.Re.get(t);return e||(e=new it(E),this.Re=this.Re.st(t,e)),e},t.prototype.Se=function(t){var e=null!==this.Ne(t);return e||p("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.Ne=function(t){var e=this.me.get(t);return e&&e.ae?null:this.Ie.Me(t)},t.prototype.De=function(t){var e=this;this.me.set(t,new Tt),this.Ie.Oe(t).forEach((function(n){e.ye(t,n,null)}))},t.prototype.$e=function(t,e){return this.Ie.Oe(t).has(e)},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nt(){return new et(F.P)}function St(){return new et(F.P)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pt(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function xt(t){var e=Ut(t.mapValue.fields.__local_write_time__.timestampValue);return new O(e.seconds,e.nanos)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Rt(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Pt(t)?4:10:g()}function kt(t,e){var n=Rt(t);if(n!==Rt(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return xt(t).isEqual(xt(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Ut(t.timestampValue),r=Ut(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Ft(t.bytesValue).isEqual(Ft(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Mt(t.geoPointValue.latitude)===Mt(e.geoPointValue.latitude)&&Mt(t.geoPointValue.longitude)===Mt(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Mt(t.integerValue)===Mt(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Mt(t.doubleValue),r=Mt(e.doubleValue);return n===r?j(n)===j(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return I(t.arrayValue.values||[],e.arrayValue.values||[],kt);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(S(n)!==S(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!kt(n[i],r[i])))return!1;return!0}(t,e);default:return g()}}function Ot(t,e){return void 0!==(t.values||[]).find((function(t){return kt(t,e)}))}function Lt(t,e){var n=Rt(t),r=Rt(e);if(n!==r)return E(n,r);switch(n){case 0:return 0;case 1:return E(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Mt(t.integerValue||t.doubleValue),r=Mt(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Ct(t.timestampValue,e.timestampValue);case 4:return Ct(xt(t),xt(e));case 5:return E(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Ft(t),r=Ft(e);return n.o(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=E(n[i],r[i]);if(0!==o)return o}return E(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=E(Mt(t.latitude),Mt(e.latitude));return 0!==n?n:E(Mt(t.longitude),Mt(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Lt(n[i],r[i]);if(o)return o}return E(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=E(r[s],o[s]);if(0!==u)return u;var a=Lt(n[r[s]],i[o[s]]);if(0!==a)return a}return E(r.length,o.length)}(t.mapValue,e.mapValue);default:throw g()}}function Ct(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return E(t,e);var n=Ut(t),r=Ut(e),i=E(n.seconds,r.seconds);return 0!==i?i:E(n.nanos,r.nanos)}function Vt(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){var e=Ut(t);return"time("+e.seconds+","+e.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Ft(e.bytesValue).toBase64():"referenceValue"in e?(r=e.referenceValue,F.U(r).toString()):"geoPointValue"in e?"geo("+(n=e.geoPointValue).latitude+","+n.longitude+")":"arrayValue"in e?function(e){for(var n="[",r=!0,i=0,o=e.values||[];i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=t(s)}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var n="{",r=!0,i=0,o=Object.keys(e.fields||{}).sort();i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=s+":"+t(e.fields[s])}return n+"}"}(e.mapValue):g();var n,r}(t)}function Ut(t){if(m(!!t),"string"==typeof t){var e=0,n=Dt.exec(t);if(m(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Mt(t.seconds),nanos:Mt(t.nanos)}}function Mt(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ft(t){return"string"==typeof t?Y.fromBase64String(t):Y.fromUint8Array(t)}function qt(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.F()}}function jt(t){return!!t&&"integerValue"in t}function Gt(t){return!!t&&"arrayValue"in t}function Bt(t){return!!t&&"nullValue"in t}function zt(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ht(t){return!!t&&"mapValue"in t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wt={asc:"ASCENDING",desc:"DESCENDING"},Kt={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Yt=function(t,e){this.s=t,this.Le=e};function Xt(t){return{integerValue:""+t}}function Qt(t,e){if(t.Le){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:j(e)?"-0":e}}function Zt(t,e){return G(e)?Xt(e):Qt(t,e)}function Jt(t,e){return t.Le?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function $t(t,e){return t.Le?e.toBase64():e.toUint8Array()}function te(t,e){return Jt(t,e.A())}function ee(t){return m(!!t),L.I(function(t){var e=Ut(t);return new O(e.seconds,e.nanos)}(t))}function ne(t,e){return function(t){return new V(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).F()}function re(t){var e=V.k(t);return m(Te(e)),e}function ie(t,e){return ne(t.s,e.path)}function oe(t,e){var n=re(e);return m(n.get(1)===t.s.projectId),m(!n.get(3)&&!t.s.database||n.get(3)===t.s.database),new F(ce(n))}function se(t,e){return ne(t.s,e)}function ue(t){var e=re(t);return 4===e.length?V.$():ce(e)}function ae(t){return new V(["projects",t.s.projectId,"databases",t.s.database]).F()}function ce(t){return m(t.length>4&&"documents"===t.get(4)),t.V(5)}function he(t,e,n){return{name:ie(t,e),fields:n.proto.mapValue.fields}}function fe(t,e){var n;if(e instanceof Ye)n={update:he(t,e.key,e.value)};else if(e instanceof tn)n={delete:ie(t,e.key)};else if(e instanceof Xe)n={update:he(t,e.key,e.data),updateMask:Ie(e.qe)};else if(e instanceof Ze)n={transform:{document:ie(t,e.key),fieldTransforms:e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof xe)return{fieldPath:e.field.F(),setToServerValue:"REQUEST_TIME"};if(n instanceof De)return{fieldPath:e.field.F(),appendMissingElements:{values:n.elements}};if(n instanceof ke)return{fieldPath:e.field.F(),removeAllFromArray:{values:n.elements}};if(n instanceof Le)return{fieldPath:e.field.F(),increment:n.Be};throw g()}(0,t)}))}};else{if(!(e instanceof en))return g();n={verify:ie(t,e.key)}}return e.Qe.Ue||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:te(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:g()}(t,e.Qe)),n}function le(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?qe.updateTime(ee(t.updateTime)):void 0!==t.exists?qe.exists(t.exists):qe.We()}(e.currentDocument):qe.We();if(e.update){e.update.name;var r=oe(t,e.update.name),i=new nn({mapValue:{fields:e.update.fields}});if(e.updateMask){var o=function(t){var e=t.fieldPaths||[];return new Ue(e.map((function(t){return M.q(t)})))}(e.updateMask);return new Xe(r,i,o,n)}return new Ye(r,i,n)}if(e.delete){var s=oe(t,e.delete);return new tn(s,n)}if(e.transform){var u=oe(t,e.transform.document),a=e.transform.fieldTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)m("REQUEST_TIME"===e.setToServerValue),n=new xe;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new De(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new ke(i)}else"increment"in e?n=new Le(t,e.increment):g();var o=M.q(e.fieldPath);return new Me(o,n)}(t,e)}));return m(!0===n.exists),new Ze(u,a)}if(e.verify){var c=oe(t,e.verify);return new en(c,n)}return g()}function pe(t,e){return{documents:[se(t,e.path)]}}function de(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=se(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=se(t,r.p()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(zt(t.value))return{unaryFilter:{field:we(t.field),op:"IS_NAN"}};if(Bt(t.value))return{unaryFilter:{field:we(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(zt(t.value))return{unaryFilter:{field:we(t.field),op:"IS_NOT_NAN"}};if(Bt(t.value))return{unaryFilter:{field:we(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:we(t.field),op:me(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:we(t.field),direction:ge(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.Le||q(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=ve(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ve(e.endAt)),n}function ve(t){return{before:t.before,values:t.position}}function ye(t){var e=!!t.before,n=t.values||[];return new Ln(n,e)}function ge(t){return Wt[t]}function me(t){return Kt[t]}function we(t){return{fieldPath:t.F()}}function be(t){return M.q(t.fieldPath)}function _e(t){return An.create(be(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return g()}}(t.fieldFilter.op),t.fieldFilter.value)}function Ee(t){switch(t.unaryFilter.op){case"IS_NAN":var e=be(t.unaryFilter.field);return An.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=be(t.unaryFilter.field);return An.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=be(t.unaryFilter.field);return An.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=be(t.unaryFilter.field);return An.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return g()}}function Ie(t){var e=[];return t.fields.forEach((function(t){return e.push(t.F())})),{fieldPaths:e}}function Te(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ae=function(){this.je=void 0};function Ne(t,e,n){return t instanceof xe?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof De?Re(t,e):t instanceof ke?Oe(t,e):function(t,e){var n=Pe(t,e),r=Ce(n)+Ce(t.Be);return jt(n)&&jt(t.Be)?Xt(r):Qt(t.serializer,r)}(t,e)}function Se(t,e,n){return t instanceof De?Re(t,e):t instanceof ke?Oe(t,e):n}function Pe(t,e){return t instanceof Le?jt(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var xe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(Ae),De=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return r.__extends(e,t),e}(Ae);function Re(t,e){for(var n=Ve(e),r=function(t){n.some((function(e){return kt(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ke=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return r.__extends(e,t),e}(Ae);function Oe(t,e){for(var n=Ve(e),r=function(t){n=n.filter((function(e){return!kt(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Le=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).serializer=e,r.Be=n,r}return r.__extends(e,t),e}(Ae);function Ce(t){return Mt(t.integerValue||t.doubleValue)}function Ve(t){return Gt(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ue=function(){function t(t){this.fields=t,t.sort(M.P)}return t.prototype.Ke=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].D(t))return!0;return!1},t.prototype.isEqual=function(t){return I(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),Me=function(t,e){this.field=t,this.transform=e},Fe=function(t,e){this.version=t,this.transformResults=e},qe=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.We=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"Ue",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function je(t,e){return void 0!==t.updateTime?e instanceof un&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof un}var Ge=function(){};function Be(t,e,n){return t instanceof Ye?function(t,e,n){return new un(t.key,n.version,t.value,{hasCommittedMutations:!0})}(t,0,n):t instanceof Xe?function(t,e,n){if(!je(t.Qe,e))return new cn(t.key,n.version);var r=Qe(t,e);return new un(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Ze?function(t,e,n){if(m(null!=n.transformResults),!je(t.Qe,e))return new cn(t.key,n.version);var r=Je(t,e),i=function(t,e,n){var r=[];m(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof un&&(u=e.field(o.field)),r.push(Se(s,u,n[i]))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=$e(t,r.data(),i);return new un(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new an(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function ze(t,e,n,r){return t instanceof Ye?function(t,e){if(!je(t.Qe,e))return e;var n=Ke(e);return new un(t.key,n,t.value,{Ge:!0})}(t,e):t instanceof Xe?function(t,e){if(!je(t.Qe,e))return e;var n=Ke(e),r=Qe(t,e);return new un(t.key,n,r,{Ge:!0})}(t,e):t instanceof Ze?function(t,e,n,r){if(!je(t.Qe,e))return e;var i=Je(t,e),o=function(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof un&&(c=n.field(u.field)),null===c&&r instanceof un&&(c=r.field(u.field)),i.push(Ne(a,c,e))}return i}(t.fieldTransforms,n,e,r),s=$e(t,i.data(),o);return new un(t.key,i.version,s,{Ge:!0})}(t,e,r,n):function(t,e){return je(t.Qe,e)?new an(t.key,L.min()):e}(t,e)}function He(t,e){return t instanceof Ze?function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e instanceof un?e.field(o.field):void 0,u=Pe(o.transform,s||null);null!=u&&(n=null==n?(new rn).set(o.field,u):n.set(o.field,u))}return n?n.ze():null}(t,e):null}function We(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Qe.isEqual(e.Qe)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.qe.isEqual(e.qe):2!==t.type||I(t.fieldTransforms,t.fieldTransforms,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof De&&e instanceof De||t instanceof ke&&e instanceof ke?I(t.elements,e.elements,kt):t instanceof Le&&e instanceof Le?kt(t.Be,e.Be):t instanceof xe&&e instanceof xe}(t.transform,e.transform)}(t,e)})))}function Ke(t){return t instanceof un?t.version:L.min()}var Ye=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.Qe=r,i.type=0,i}return r.__extends(e,t),e}(Ge),Xe=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.qe=r,o.Qe=i,o.type=1,o}return r.__extends(e,t),e}(Ge);function Qe(t,e){return function(t,e){var n=new rn(e);return t.qe.fields.forEach((function(e){if(!e._()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}})),n.ze()}(t,e instanceof un?e.data():nn.empty())}var Ze=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.Qe=qe.exists(!0),r}return r.__extends(e,t),e}(Ge);function Je(t,e){return e}function $e(t,e,n){for(var r=new rn(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.ze()}var tn=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Qe=n,r.type=3,r}return r.__extends(e,t),e}(Ge),en=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Qe=n,r.type=4,r}return r.__extends(e,t),e}(Ge),nn=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Ht(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},t.prototype.isEqual=function(t){return kt(this.proto,t.proto)},t}(),rn=function(){function t(t){void 0===t&&(t=nn.empty()),this.He=t,this.Ye=new Map}return t.prototype.set=function(t,e){return this.Je(t,e),this},t.prototype.delete=function(t){return this.Je(t,null),this},t.prototype.Je=function(t,e){for(var n=this.Ye,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===Rt(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.S(),e)},t.prototype.ze=function(){var t=this.Xe(M.$(),this.Ye);return null!=t?new nn(t):this.He},t.prototype.Xe=function(t,e){var n=this,r=!1,i=this.He.field(t),o=Ht(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var s=n.Xe(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function on(t){var e=[];return P(t.fields||{},(function(t,n){var r=new M([t]);if(Ht(n)){var i=on(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var u=s[o];e.push(r.child(u))}}else e.push(r)})),new Ue(e)
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var sn=function(t,e){this.key=t,this.version=e},un=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).Ze=r,o.Ge=!!i.Ge,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return r.__extends(e,t),e.prototype.field=function(t){return this.Ze.field(t)},e.prototype.data=function(){return this.Ze},e.prototype.tn=function(){return this.Ze.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ge===t.Ge&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ze.isEqual(t.Ze)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ze.toString()+", {hasLocalMutations: "+this.Ge+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.Ge||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(sn),an=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return r.__extends(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(sn),cn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(sn);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hn(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new k(R.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new k(R.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fn=function(){function t(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.en=n,this.filters=r,this.limit=i,this.nn=o,this.startAt=s,this.endAt=u,this.sn=null,this.rn=null,this.startAt,this.endAt}return t.prototype.on=function(e){return new t(e,null,this.en.slice(),this.filters.slice(),this.limit,this.nn,this.startAt,this.endAt)},t.prototype.hn=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.en.length||1===this.en.length&&this.en[0].field.M())},t.prototype.an=function(){return!q(this.limit)&&"F"===this.nn},t.prototype.un=function(){return!q(this.limit)&&"L"===this.nn},t.prototype.cn=function(){return this.en.length>0?this.en[0].field:null},t.prototype.ln=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n._n())return n.field}return null},t.prototype.fn=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(t.indexOf(r.op)>=0)return r.op}return null},t}();function ln(t,e,n,r,i,o,s,u){return new fn(t,e,n,r,i,o,s,u)}function pn(t){return new fn(t)}function dn(t){return null!==t.collectionGroup}function vn(t){var e=hn(t,fn);if(null===e.sn){e.sn=[];var n=e.ln(),r=e.cn();if(null!==n&&null===r)n.M()||e.sn.push(new Mn(n)),e.sn.push(new Mn(M.L(),"asc"));else{for(var i=!1,o=0,s=e.en;o<s.length;o++){var u=s[o];e.sn.push(u),u.field.M()&&(i=!0)}if(!i){var a=e.en.length>0?e.en[e.en.length-1].dir:"asc";e.sn.push(new Mn(M.L(),a))}}}return e.sn}function yn(t){var e=hn(t,fn);if(!e.rn)if("F"===e.nn)e.rn=z(e.path,e.collectionGroup,vn(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=vn(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Mn(o.field,s))}var u=e.endAt?new Ln(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Ln(e.startAt.position,!e.startAt.before):null;e.rn=z(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.rn}function gn(t,e,n){return new fn(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function mn(t,e){return new fn(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,e,t.endAt)}function wn(t,e){return new fn(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,t.startAt,e)}function bn(t,e){return W(yn(t),yn(e))&&t.nn===e.nn}function _n(t){return H(yn(t))+"|lt:"+t.nn}function En(t){return"Query(target="+function(t){var e=t.path.F();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.F()+" "+e.op+" "+Vt(e.value);var e})).join(", ")+"]"),q(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return(e=t).field.F()+" ("+e.dir+")";var e})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Cn(t.startAt)),t.endAt&&(e+=", endAt: "+Cn(t.endAt)),"Target("+e+")"}(yn(t))+"; limitType="+t.nn+")"}function In(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.W(t.collectionGroup)&&t.path.D(n):F.j(t.path)?t.path.isEqual(n):t.path.C(n)}(t,e)&&function(t,e){for(var n=0,r=t.en;n<r.length;n++){var i=r[n];if(!i.field.M()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Vn(t.startAt,vn(t),e))&&(!t.endAt||!Vn(t.endAt,vn(t),e))}(t,e)}function Tn(t){return function(e,n){for(var r=!1,i=0,o=vn(t);i<o.length;i++){var s=o[i],u=Fn(s,e,n);if(0!==u)return u;r=r||s.field.M()}return 0}}var An=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return r.__extends(e,t),e.create=function(t,n,r){if(t.M())return"in"===n||"not-in"===n?this.dn(t,n,r):new Nn(t,n,r);if(Bt(r)){if("=="!==n&&"!="!==n)throw new k(R.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new e(t,n,r)}if(zt(r)){if("=="!==n&&"!="!==n)throw new k(R.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new e(t,n,r)}return"array-contains"===n?new Dn(t,r):"in"===n?new Rn(t,r):"not-in"===n?new kn(t,r):"array-contains-any"===n?new On(t,r):new e(t,n,r)},e.dn=function(t,e,n){return"in"===e?new Sn(t,n):new Pn(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.wn(Lt(e,this.value)):null!==e&&Rt(this.value)===Rt(e)&&this.wn(Lt(e,this.value))},e.prototype.wn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return g()}},e.prototype._n=function(){return["<","<=",">",">=","!="].indexOf(this.op)>=0},e}((function(){})),Nn=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=F.U(r.referenceValue),i}return r.__extends(e,t),e.prototype.matches=function(t){var e=F.P(t.key,this.key);return this.wn(e)},e}(An),Sn=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=xn("in",n),r}return r.__extends(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(An),Pn=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=xn("not-in",n),r}return r.__extends(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(An);function xn(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return F.U(t.referenceValue)}))}var Dn=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return r.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return Gt(e)&&Ot(e.arrayValue,this.value)},e}(An),Rn=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return r.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Ot(this.value.arrayValue,e)},e}(An),kn=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return r.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&!Ot(this.value.arrayValue,e)},e}(An),On=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return r.__extends(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Gt(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return Ot(e.value.arrayValue,t)}))},e}(An),Ln=function(t,e){this.position=t,this.before=e};function Cn(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return Vt(t)})).join(",")}function Vn(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.M()?F.P(F.U(s.referenceValue),n.key):Lt(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Un(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!kt(t.position[n],e.position[n]))return!1;return!0}var Mn=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Fn(t,e,n){var r=t.field.M()?F.P(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?Lt(r,i):g()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return g()}}function qn(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var jn=function(){function t(t,e,n,r){this.batchId=t,this.Tn=e,this.baseMutations=n,this.mutations=r}return t.prototype.En=function(t,e,n){for(var r=n.In,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Be(o,e,r[i]))}return e},t.prototype.mn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=ze(i,e,e,this.Tn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=ze(a,e,o,this.Tn))}return e},t.prototype.An=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.mn(r.key,t.get(r.key));i&&(n=n.st(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),pt())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&I(this.mutations,t.mutations,(function(t,e){return We(t,e)}))&&I(this.baseMutations,t.baseMutations,(function(t,e){return We(t,e)}))},t}(),Gn=function(){function t(t,e,n,r){this.batch=t,this.Rn=e,this.In=n,this.Pn=r}return t.from=function(e,n,r){m(e.mutations.length===r.length);for(var i=ft,o=e.mutations,s=0;s<o.length;s++)i=i.st(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Bn=function(){function t(t){var e=this;this.gn=null,this.Vn=null,this.result=void 0,this.error=void 0,this.yn=!1,this.pn=!1,t((function(t){e.yn=!0,e.result=t,e.gn&&e.gn(t)}),(function(t){e.yn=!0,e.error=t,e.Vn&&e.Vn(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.pn&&g(),this.pn=!0,this.yn?this.error?this.bn(n,this.error):this.vn(e,this.result):new t((function(t,i){r.gn=function(n){r.vn(e,n).next(t,i)},r.Vn=function(e){r.bn(n,e).next(t,i)}}))},t.prototype.Sn=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.Dn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.vn=function(e,n){return e?this.Dn((function(){return e(n)})):t.resolve(n)},t.prototype.bn=function(e,n){return e?this.Dn((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.Cn=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.Nn=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.Cn(r)},t}(),zn=function(){function t(){this.Fn=new D((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.kn=!1}return Object.defineProperty(t.prototype,"readTime",{get:function(){return this.$n},set:function(t){this.$n=t},enumerable:!1,configurable:!0}),t.prototype.xn=function(t,e){this.On(),this.readTime=e,this.Fn.set(t.key,t)},t.prototype.Mn=function(t,e){this.On(),e&&(this.readTime=e),this.Fn.set(t,null)},t.prototype.Ln=function(t,e){this.On();var n=this.Fn.get(e);return void 0!==n?Bn.resolve(n):this.qn(t,e)},t.prototype.getEntries=function(t,e){return this.Bn(t,e)},t.prototype.apply=function(t){return this.On(),this.kn=!0,this.Un(t)},t.prototype.On=function(){},t}(),Hn="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Wn=function(){function t(){this.Qn=[]}return t.prototype.Wn=function(t){this.Qn.push(t)},t.prototype.jn=function(){this.Qn.forEach((function(t){return t()}))},t}(),Kn=function(){function t(t,e,n){this.Kn=t,this.Gn=e,this.zn=n}return t.prototype.Hn=function(t,e){var n=this;return this.Gn.Yn(t,e).next((function(r){return n.Jn(t,e,r)}))},t.prototype.Jn=function(t,e,n){return this.Kn.Ln(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].mn(e,t);return t}))},t.prototype.Xn=function(t,e,n){var r=at();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].mn(t,e);r=r.st(t,e)})),r},t.prototype.Zn=function(t,e){var n=this;return this.Kn.getEntries(t,e).next((function(e){return n.ts(t,e)}))},t.prototype.ts=function(t,e){var n=this;return this.Gn.es(t,e).next((function(r){var i=n.Xn(t,e,r),o=ut();return i.forEach((function(t,e){e||(e=new an(t,L.min())),o=o.st(t,e)})),o}))},t.prototype.ns=function(t,e,n){return function(t){return F.j(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.ss(t,e.path):dn(e)?this.rs(t,e,n):this.os(t,e,n)},t.prototype.ss=function(t,e){return this.Hn(t,new F(e)).next((function(t){var e=ht();return t instanceof un&&(e=e.st(t.key,t)),e}))},t.prototype.rs=function(t,e,n){var r=this,i=e.collectionGroup,o=ht();return this.zn.hs(t,i).next((function(s){return Bn.forEach(s,(function(s){var u=e.on(s.child(i));return r.os(t,u,n).next((function(t){t.forEach((function(t,e){o=o.st(t,e)}))}))})).next((function(){return o}))}))},t.prototype.os=function(t,e,n){var r,i,o=this;return this.Kn.ns(t,e,n).next((function(n){return r=n,o.Gn.as(t,e)})).next((function(e){return i=e,o.us(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=r.get(c),f=ze(a,h,h,o.Tn);r=f instanceof un?r.st(c,f):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){In(e,n)||(r=r.remove(t))})),r}))},t.prototype.us=function(t,e,n){for(var r=pt(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Xe&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Kn.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof un&&(c=c.st(t,e))})),c}))},t}(),Yn=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.cs=n,this.ls=r}return t._s=function(e,n){for(var r=pt(),i=pt(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Xn=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.fs=function(t){return n.ds(t)},this.ws=function(t){return e.Ts(t)})}return t.prototype.ds=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.ws&&this.ws(t),t},t}();Xn.Es=-1;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Qn=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},Zn=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Is=t,this.ms=e,this.As=n,this.Rs=r,this.Ps=i,this.gs=0,this.Vs=null,this.ys=Date.now(),this.reset()}return t.prototype.reset=function(){this.gs=0},t.prototype.ps=function(){this.gs=this.Ps},t.prototype.bs=function(t){var e=this;this.cancel();var n=Math.floor(this.gs+this.vs()),r=Math.max(0,Date.now()-this.ys),i=Math.max(0,n-r);i>0&&p("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.gs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Vs=this.Is.Ss(this.ms,i,(function(){return e.ys=Date.now(),t()})),this.gs*=this.Rs,this.gs<this.As&&(this.gs=this.As),this.gs>this.Ps&&(this.gs=this.Ps)},t.prototype.Ds=function(){null!==this.Vs&&(this.Vs.Cs(),this.Vs=null)},t.prototype.cancel=function(){null!==this.Vs&&(this.Vs.cancel(),this.Vs=null)},t.prototype.vs=function(){return(Math.random()-.5)*this.gs},t}(),Jn=function(){function e(t,n,r){this.name=t,this.version=n,this.Ns=r,12.2===e.Fs(s.getUA())&&d("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e.delete=function(t){return p("SimpleDb","Removing database:",t),ir(window.indexedDB.deleteDatabase(t)).Sn()},e.ks=function(){if("undefined"==typeof indexedDB)return!1;if(e.$s())return!0;var t=s.getUA(),n=e.Fs(t),r=0<n&&n<10,i=e.xs(t),o=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||o)},e.$s=function(){var e;return"undefined"!=typeof t&&"YES"===(null===(e=Object({NODE_ENV:"production",VUE_APP_BASE_TITLE:"Presentator",VUE_APP_SUPPORT_EMAIL:"support@presentator.io",VUE_APP_SHOW_CREDITS:"1",VUE_APP_SHOW_SEND_FEEDBACK:"1",VUE_APP_SHOW_SPAM_REPORT:"1",VUE_APP_ALLOW_HOTSPOTS_URL:"1",VUE_APP_FOOTER_LINKS:"",VUE_APP_API_URL:"/api",VUE_APP_REPO_URL:"https://github.com/presentator/presentator",VUE_APP_RELEASES_URL:"https://github.com/presentator/presentator/releases",VUE_APP_ISSUES_URL:"https://github.com/presentator/presentator/issues",VUE_APP_TERMS_URL:"https://presentator.io/terms-and-conditions",VUE_APP_PROJECT_URL:"https://presentator.io",VUE_APP_USER_REFRESH_THRESHOLD:"1850000",VUE_APP_NOTIFICATIONS_INTERVAL:"45000",VUE_APP_FIRESTORE_PROJECT_ID:"",VUE_APP_FIRESTORE_COLLECTION:"presentator_notifications",VUE_APP_PREFERRED_LANGUAGE_STORAGE_KEY:"preferred_language",VUE_APP_AFTER_LOGIN_ROUTE_STORAGE_KEY:"after_login_route",VUE_APP_USER_DATA_STORAGE_KEY:"user_data",VUE_APP_AUTH_CLIENT_NAME_STORAGE_KEY:"auth_client_name",VUE_APP_AUTH_CLIENT_STATE_STORAGE_KEY:"auth_client_state",VUE_APP_BASE_PREVIEW_TOKEN_STORAGE_KEY:"preview_token",VUE_APP_PREVIEW_COMMENT_FROM_STORAGE_KEY:"preview_comment_from",VUE_APP_PREVIEW_LAST_COMMENTS_LOAD_STORAGE_KEY:"preview_last_comments_load",VUE_APP_PREVIEW_BAR_VISIBLITY_STORAGE_KEY:"preview_bar_is_active",BASE_URL:"/"}))||void 0===e?void 0:e.Os)},e.Ms=function(t,e){return t.store(e)},e.Fs=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},e.xs=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},e.prototype.Ls=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,e=this;return r.__generator(this,(function(n){switch(n.label){case 0:return this.db?[3,2]:(p("SimpleDb","Opening database:",this.name),t=this,[4,new Promise((function(t,n){var r=indexedDB.open(e.name,e.version);r.onsuccess=function(e){var n=e.target.result;t(n)},r.onblocked=function(){n(new tr("Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){var e=t.target.error;"VersionError"===e.name?n(new k(R.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new tr(e))},r.onupgradeneeded=function(t){p("SimpleDb",'Database "'+e.name+'" requires upgrade from version:',t.oldVersion);var n=t.target.result;e.Ns.createOrUpgrade(n,r.transaction,t.oldVersion,e.version).next((function(){p("SimpleDb","Database upgrade to version "+e.version+" complete")}))}}))]);case 1:t.db=n.sent(),n.label=2;case 2:return[2,(this.qs&&(this.db.onversionchange=function(t){return e.qs(t)}),this.db)]}}))}))},e.prototype.Bs=function(t){this.qs=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},e.prototype.runTransaction=function(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s,u,a;return r.__generator(this,(function(c){switch(c.label){case 0:i="readonly"===t,o=0,s=function(){var t,s,a,c,h;return r.__generator(this,(function(r){switch(r.label){case 0:++o,r.label=1;case 1:return r.trys.push([1,4,,5]),[4,u.Ls()];case 2:return u.db=r.sent(),t=nr.open(u.db,i?"readonly":"readwrite",e),s=n(t).catch((function(e){return t.abort(e),Bn.reject(e)})).Sn(),a={},s.catch((function(){})),[4,t.Us];case 3:return[2,(a.value=(r.sent(),s),a)];case 4:return c=r.sent(),h="FirebaseError"!==c.name&&o<3,p("SimpleDb","Transaction failed with error: %s. Retrying: %s.",c.message,h),u.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},u=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(a=c.sent()))return[2,a.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},e.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},e}(),$n=function(){function t(t){this.Qs=t,this.Ws=!1,this.js=null}return Object.defineProperty(t.prototype,"yn",{get:function(){return this.Ws},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Ks",{get:function(){return this.js},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Qs=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Ws=!0},t.prototype.Gs=function(t){this.js=t},t.prototype.delete=function(){return ir(this.Qs.delete())},t}(),tr=function(t){function e(e){var n=this;return(n=t.call(this,R.UNAVAILABLE,"IndexedDB transaction failed: "+e)||this).name="IndexedDbTransactionError",n}return r.__extends(e,t),e}(k);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function er(t){return"IndexedDbTransactionError"===t.name}var nr=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.zs=new Qn,this.transaction.oncomplete=function(){e.zs.resolve()},this.transaction.onabort=function(){t.error?e.zs.reject(new tr(t.error)):e.zs.resolve()},this.transaction.onerror=function(t){var n=sr(t.target.error);e.zs.reject(new tr(n))}}return t.open=function(e,n,r){try{return new t(e.transaction(r,n))}catch(e){throw new tr(e)}},Object.defineProperty(t.prototype,"Us",{get:function(){return this.zs.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.zs.reject(t),this.aborted||(p("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new rr(e)},t}(),rr=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(p("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(p("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),ir(n)},t.prototype.add=function(t){return p("SimpleDb","ADD",this.store.name,t,t),ir(this.store.add(t))},t.prototype.get=function(t){var e=this;return ir(this.store.get(t)).next((function(n){return void 0===n&&(n=null),p("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return p("SimpleDb","DELETE",this.store.name,t),ir(this.store.delete(t))},t.prototype.count=function(){return p("SimpleDb","COUNT",this.store.name),ir(this.store.count())},t.prototype.Hs=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.Ys(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.Js=function(t,e){p("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Xs=!1;var r=this.cursor(n);return this.Ys(r,(function(t,e,n){return n.delete()}))},t.prototype.Zs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.Ys(r,e)},t.prototype.ti=function(t){var e=this.cursor({});return new Bn((function(n,r){e.onerror=function(t){var e=sr(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.Ys=function(t,e){var n=[];return new Bn((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new $n(i),s=e(i.primaryKey,i.value,o);if(s instanceof Bn){var u=s.catch((function(t){return o.done(),Bn.reject(t)}));n.push(u)}o.yn?r():null===o.Ks?i.continue():i.continue(o.Ks)}else r()}})).next((function(){return Bn.Cn(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Xs?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function ir(t){return new Bn((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=sr(t.target.error);n(e)}}))}var or=!1;function sr(t){var e=Jn.Fs(s.getUA());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new k("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return or||(or=!0,setTimeout((function(){throw r}),0)),r}}return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ur(){return"undefined"!=typeof window?window:null}function ar(){return"undefined"!=typeof document?document:null}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cr=function(){function t(t,e,n,r,i){this.ei=t,this.ms=e,this.ni=n,this.op=r,this.si=i,this.ii=new Qn,this.then=this.ii.promise.then.bind(this.ii.promise),this.ii.promise.catch((function(t){}))}return t.ri=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.oi=setTimeout((function(){return e.hi()}),t)},t.prototype.Cs=function(){return this.hi()},t.prototype.cancel=function(t){null!==this.oi&&(this.clearTimeout(),this.ii.reject(new k(R.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.hi=function(){var t=this;this.ei.ai((function(){return null!==t.oi?(t.clearTimeout(),t.op().then((function(e){return t.ii.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.oi&&(this.si(this),clearTimeout(this.oi),this.oi=null)},t}(),hr=function(){function t(){var t=this;this.ui=Promise.resolve(),this.ci=[],this.li=!1,this._i=[],this.fi=null,this.di=!1,this.wi=[],this.Ti=new Zn(this,"async_queue_retry"),this.Ei=function(){var e=ar();e&&p("AsyncQueue","Visibility state changed to  ",e.visibilityState),t.Ti.Ds()};var e=ar();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ei)}return Object.defineProperty(t.prototype,"Ii",{get:function(){return this.li},enumerable:!1,configurable:!0}),t.prototype.ai=function(t){this.enqueue(t)},t.prototype.mi=function(t){this.Ai(),this.Ri(t)},t.prototype.Pi=function(){if(!this.li){this.li=!0;var t=ar();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ei)}},t.prototype.enqueue=function(t){return this.Ai(),this.li?new Promise((function(t){})):this.Ri(t)},t.prototype.gi=function(t){var e=this;this.ci.push(t),this.ai((function(){return e.Vi()}))},t.prototype.Vi=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,e=this;return r.__generator(this,(function(n){switch(n.label){case 0:if(0===this.ci.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.ci[0]()];case 2:return n.sent(),this.ci.shift(),this.Ti.reset(),[3,4];case 3:if(!er(t=n.sent()))throw t;return p("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.ci.length>0&&this.Ti.bs((function(){return e.Vi()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Ri=function(t){var e=this,n=this.ui.then((function(){return e.di=!0,t().catch((function(t){throw e.fi=t,e.di=!1,d("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.di=!1,t}))}));return this.ui=n,n},t.prototype.Ss=function(t,e,n){var r=this;this.Ai(),this.wi.indexOf(t)>-1&&(e=0);var i=cr.ri(this,t,e,n,(function(t){return r.yi(t)}));return this._i.push(i),i},t.prototype.Ai=function(){this.fi&&g()},t.prototype.pi=function(){},t.prototype.bi=function(){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(e){switch(e.label){case 0:return[4,t=this.ui];case 1:e.sent(),e.label=2;case 2:if(t!==this.ui)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.vi=function(t){for(var e=0,n=this._i;e<n.length;e++)if(n[e].ms===t)return!0;return!1},t.prototype.Si=function(t){var e=this;return this.bi().then((function(){e._i.sort((function(t,e){return t.ni-e.ni}));for(var n=0,r=e._i;n<r.length;n++){var i=r[n];if(i.Cs(),"all"!==t&&i.ms===t)break}return e.bi()}))},t.prototype.Di=function(t){this.wi.push(t)},t.prototype.yi=function(t){var e=this._i.indexOf(t);this._i.splice(e,1)},t}();function fr(t,e){if(d("AsyncQueue",e+": "+t),er(t))return new k(R.UNAVAILABLE,e+": "+t);throw t}function lr(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=E(n,i);return 0===s?E(r,o):s}var pr=function(){function t(t){this.Ci=t,this.buffer=new it(lr),this.Ni=0}return t.prototype.Fi=function(){return++this.Ni},t.prototype.ki=function(t){var e=[t,this.Fi()];if(this.buffer.size<this.Ci)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();lr(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),dr={$i:!1,xi:0,Oi:0,Mi:0},vr=function(){function t(t,e,n){this.Li=t,this.qi=e,this.Bi=n}return t.Ui=function(e){return new t(e,t.Qi,t.Wi)},t}();vr.ji=-1,vr.Ki=1048576,vr.Gi=41943040,vr.Qi=10,vr.Wi=1e3,vr.zi=new vr(vr.Gi,vr.Qi,vr.Wi),vr.Hi=new vr(vr.ji,0,0);var yr=function(){function t(t,e){this.Yi=t,this.ei=e,this.Ji=!1,this.Xi=null}return t.prototype.start=function(t){this.Yi.params.Li!==vr.ji&&this.Zi(t)},t.prototype.stop=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},Object.defineProperty(t.prototype,"tr",{get:function(){return null!==this.Xi},enumerable:!1,configurable:!0}),t.prototype.Zi=function(t){var e=this,n=this.Ji?3e5:6e4;p("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.Xi=this.ei.Ss("lru_garbage_collection",n,(function(){return r.__awaiter(e,void 0,void 0,(function(){var e;return r.__generator(this,(function(n){switch(n.label){case 0:this.Xi=null,this.Ji=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.er(this.Yi)];case 2:return n.sent(),[3,7];case 3:return er(e=n.sent())?(p("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,ki(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.Zi(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),gr=function(){function t(t,e){this.nr=t,this.params=e}return t.prototype.sr=function(t,e){return this.nr.ir(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.rr=function(t,e){var n=this;if(0===e)return Bn.resolve(Xn.Es);var r=new pr(e);return this.nr.be(t,(function(t){return r.ki(t.sequenceNumber)})).next((function(){return n.nr.or(t,(function(t){return r.ki(t)}))})).next((function(){return r.maxValue}))},t.prototype.hr=function(t,e,n){return this.nr.hr(t,e,n)},t.prototype.ar=function(t,e){return this.nr.ar(t,e)},t.prototype.ur=function(t,e){var n=this;return this.params.Li===vr.ji?(p("LruGarbageCollector","Garbage collection skipped; disabled"),Bn.resolve(dr)):this.cr(t).next((function(r){return r<n.params.Li?(p("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Li),dr):n.lr(t,e)}))},t.prototype.cr=function(t){return this.nr.cr(t)},t.prototype.lr=function(t,e){var n,r,i,s,u,a,c,h=this,f=Date.now();return this.sr(t,this.params.qi).next((function(e){return e>h.params.Bi?(p("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Bi+" from "+e),r=h.params.Bi):r=e,s=Date.now(),h.rr(t,r)})).next((function(r){return n=r,u=Date.now(),h.hr(t,n,e)})).next((function(e){return i=e,a=Date.now(),h.ar(t,n)})).next((function(t){return c=Date.now(),l()<=o.LogLevel.DEBUG&&p("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+r+" in "+(u-s)+"ms\n\tRemoved "+i+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),Bn.resolve({$i:!0,xi:r,Oi:i,Mi:t})}))},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mr(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=br(e)),e=wr(t.get(n),e);return br(e)}function wr(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function br(t){return t+""}function _r(t){var e=t.length;if(m(e>=2),2===e)return m(""===t.charAt(0)&&""===t.charAt(1)),V.$();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&g(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:g()}o=s+2}return new V(r)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Er=function(t){this._r=t};function Ir(t,e){if(e.document)return function(t,e,n){var r=oe(t,e.name),i=ee(e.updateTime),o=new nn({mapValue:{fields:e.fields}});return new un(r,i,o,{hasCommittedMutations:!!n})}(t._r,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=F.K(e.noDocument.path),r=Pr(e.noDocument.readTime);return new an(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=F.K(e.unknownDocument.path),o=Pr(e.unknownDocument.version);return new cn(i,o)}return g()}function Tr(t,e,n){var r=Ar(n),i=e.key.path.p().N();if(e instanceof un){var o=function(t,e){return{name:ie(t,e.key),fields:e.tn().mapValue.fields,updateTime:Jt(t,e.version.A())}}(t._r,e),s=e.hasCommittedMutations;return new $r(null,null,o,s,r,i)}if(e instanceof an){var u=e.key.path.N(),a=Sr(e.version),c=e.hasCommittedMutations;return new $r(null,new Zr(u,a),null,c,r,i)}if(e instanceof cn){var h=e.key.path.N(),f=Sr(e.version);return new $r(new Jr(h,f),null,null,!0,r,i)}return g()}function Ar(t){var e=t.A();return[e.seconds,e.nanoseconds]}function Nr(t){var e=new O(t[0],t[1]);return L.I(e)}function Sr(t){var e=t.A();return new Wr(e.seconds,e.nanoseconds)}function Pr(t){var e=new O(t.seconds,t.nanoseconds);return L.I(e)}function xr(t,e){var n=(e.baseMutations||[]).map((function(e){return le(t._r,e)})),r=e.mutations.map((function(e){return le(t._r,e)})),i=O.fromMillis(e.localWriteTimeMs);return new jn(e.batchId,i,n,r)}function Dr(t){var e,n,r=Pr(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Pr(t.lastLimboFreeSnapshotVersion):L.min();return void 0!==t.query.documents?(m(1===(n=t.query).documents.length),e=yn(pn(ue(n.documents[0])))):e=function(t){var e=ue(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){m(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[Ee(e)]:void 0!==e.fieldFilter?[_e(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return t(e)})).reduce((function(t,e){return t.concat(e)})):g():[]}(n.where));var u=[];n.orderBy&&(u=n.orderBy.map((function(t){return function(t){return new Mn(be(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var a=null;n.limit&&(a=function(t){var e;return q(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=ye(n.startAt));var h=null;return n.endAt&&(h=ye(n.endAt)),yn(ln(e,i,u,s,a,"F",c,h))}(t.query),new Z(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Y.fromBase64String(t.resumeToken))}function Rr(t,e){var n,r=Sr(e.Z),i=Sr(e.lastLimboFreeSnapshotVersion);n=K(e.target)?pe(t._r,e.target):de(t._r,e.target);var o=e.resumeToken.toBase64();return new ei(e.targetId,H(e.target),r,o,e.sequenceNumber,i,n)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kr=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.zn=n,this.dr=r,this.wr={}}return t.Tr=function(e,n,r,i){return m(""!==e.uid),new t(e.Er()?e.uid:"",n,r,i)},t.prototype.Ir=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Cr(t).Zs({index:Xr.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.mr=function(t,e,n,r){var i=this,o=Vr(t),s=Cr(t);return s.add({}).next((function(u){m("number"==typeof u);for(var a=new jn(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return fe(t._r,e)})),i=n.mutations.map((function(e){return fe(t._r,e)}));return new Xr(e,n.batchId,n.Tn.toMillis(),r,i)}(i.serializer,i.userId,a),h=[],f=new it((function(t,e){return E(t.F(),e.F())})),l=0,p=r;l<p.length;l++){var d=p[l],v=Qr.key(i.userId,d.key.path,u);f=f.add(d.key.path.p()),h.push(s.put(c)),h.push(o.put(v,Qr.PLACEHOLDER))}return f.forEach((function(e){h.push(i.zn.Ar(t,e))})),t.Wn((function(){i.wr[u]=a.keys()})),Bn.Cn(h).next((function(){return a}))}))},t.prototype.Rr=function(t,e){var n=this;return Cr(t).get(e).next((function(t){return t?(m(t.userId===n.userId),xr(n.serializer,t)):null}))},t.prototype.Pr=function(t,e){var n=this;return this.wr[e]?Bn.resolve(this.wr[e]):this.Rr(t,e).next((function(t){if(t){var r=t.keys();return n.wr[e]=r,r}return null}))},t.prototype.gr=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Cr(t).Zs({index:Xr.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(m(e.batchId>=r),o=xr(n.serializer,e)),i.done()})).next((function(){return o}))},t.prototype.Vr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Cr(t).Zs({index:Xr.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.yr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Cr(t).Hs(Xr.userMutationsIndex,n).next((function(t){return t.map((function(t){return xr(e.serializer,t)}))}))},t.prototype.Yn=function(t,e){var n=this,r=Qr.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Vr(t).Zs({range:i},(function(r,i,s){var u=r[0],a=r[1],c=r[2],h=_r(a);if(u===n.userId&&e.path.isEqual(h))return Cr(t).get(c).next((function(t){if(!t)throw g();m(t.userId===n.userId),o.push(xr(n.serializer,t))}));s.done()})).next((function(){return o}))},t.prototype.es=function(t,e){var n=this,r=new it(E),i=[];return e.forEach((function(e){var o=Qr.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=Vr(t).Zs({range:s},(function(t,i,o){var s=t[0],u=t[1],a=t[2],c=_r(u);s===n.userId&&e.path.isEqual(c)?r=r.add(a):o.done()}));i.push(u)})),Bn.Cn(i).next((function(){return n.pr(t,r)}))},t.prototype.as=function(t,e){var n=this,r=e.path,i=r.length+1,o=Qr.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new it(E);return Vr(t).Zs({range:s},(function(t,e,o){var s=t[0],a=t[1],c=t[2],h=_r(a);s===n.userId&&r.D(h)?h.length===i&&(u=u.add(c)):o.done()})).next((function(){return n.pr(t,u)}))},t.prototype.pr=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Cr(t).get(e).next((function(t){if(null===t)throw g();m(t.userId===n.userId),r.push(xr(n.serializer,t))})))})),Bn.Cn(i).next((function(){return r}))},t.prototype.br=function(t,e){var n=this;return Lr(t.vr,this.userId,e).next((function(r){return t.Wn((function(){n.Sr(e.batchId)})),Bn.forEach(r,(function(e){return n.dr.Dr(t,e)}))}))},t.prototype.Sr=function(t){delete this.wr[t]},t.prototype.Cr=function(t){var e=this;return this.Ir(t).next((function(n){if(!n)return Bn.resolve();var r=IDBKeyRange.lowerBound(Qr.prefixForUser(e.userId)),i=[];return Vr(t).Zs({range:r},(function(t,n,r){if(t[0]===e.userId){var o=_r(t[1]);i.push(o)}else r.done()})).next((function(){m(0===i.length)}))}))},t.prototype.Nr=function(t,e){return Or(t,this.userId,e)},t.prototype.Fr=function(t){var e=this;return Ur(t).get(this.userId).next((function(t){return t||new Yr(e.userId,-1,"")}))},t}();function Or(t,e,n){var r=Qr.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Vr(t).Zs({range:o,Xs:!0},(function(t,n,r){var o=t[0],u=t[1];t[2],o===e&&u===i&&(s=!0),r.done()})).next((function(){return s}))}function Lr(t,e,n){var r=t.store(Xr.store),i=t.store(Qr.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Zs({range:s},(function(t,e,n){return u++,n.delete()}));o.push(a.next((function(){m(1===u)})));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=Qr.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return Bn.Cn(o).next((function(){return c}))}function Cr(t){return gi.Ms(t,Xr.store)}function Vr(t){return gi.Ms(t,Qr.store)}function Ur(t){return gi.Ms(t,Yr.store)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Mr=function(){function t(t,e){this.serializer=t,this.zn=e}return t.prototype.xn=function(t,e,n){return qr(t).put(jr(e),n)},t.prototype.Mn=function(t,e){var n=qr(t),r=jr(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.kr(t,r)}))},t.prototype.Ln=function(t,e){var n=this;return qr(t).get(jr(e)).next((function(t){return n.$r(t)}))},t.prototype.xr=function(t,e){var n=this;return qr(t).get(jr(e)).next((function(t){var e=n.$r(t);return e?{Or:e,size:Gr(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=at();return this.Mr(t,e,(function(t,e){var i=n.$r(e);r=r.st(t,i)})).next((function(){return r}))},t.prototype.Lr=function(t,e){var n=this,r=at(),i=new et(F.P);return this.Mr(t,e,(function(t,e){var o=n.$r(e);o?(r=r.st(t,o),i=i.st(t,Gr(e))):(r=r.st(t,null),i=i.st(t,0))})).next((function(){return{qr:r,Br:i}}))},t.prototype.Mr=function(t,e,n){if(e._())return Bn.resolve();var r=IDBKeyRange.bound(e.first().path.N(),e.last().path.N()),i=e.ut(),o=i.wt();return qr(t).Zs({range:r},(function(t,e,r){for(var s=F.K(t);o&&F.P(o,s)<0;)n(o,null),o=i.wt();o&&o.isEqual(s)&&(n(o,e),o=i.Tt()?i.wt():null),o?r.Gs(o.path.N()):r.done()})).next((function(){for(;o;)n(o,null),o=i.Tt()?i.wt():null}))},t.prototype.ns=function(t,e,n){var r=this,i=ht(),o=e.path.length+1,s={};if(n.isEqual(L.min())){var u=e.path.N();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.N(),c=Ar(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=$r.collectionReadTimeIndex}return qr(t).Zs(s,(function(t,n,s){if(t.length===o){var u=Ir(r.serializer,n);e.path.D(u.key.path)?u instanceof un&&In(e,u)&&(i=i.st(u.key,u)):s.done()}})).next((function(){return i}))},t.prototype.Ur=function(t,e){var n=this,r=ut(),i=Ar(e),o=qr(t),s=IDBKeyRange.lowerBound(i,!0);return o.Zs({index:$r.readTimeIndex,range:s},(function(t,e){var o=Ir(n.serializer,e);r=r.st(o.key,o),i=e.readTime})).next((function(){return{Qr:r,readTime:Nr(i)}}))},t.prototype.Wr=function(t){var e=qr(t),n=L.min();return e.Zs({index:$r.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=Nr(e.readTime)),r.done()})).next((function(){return n}))},t.prototype.jr=function(e){return new t.Kr(this,!!e&&e.Gr)},t.prototype.zr=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return Fr(t).get(ti.key).next((function(t){return m(!!t),t}))},t.prototype.kr=function(t,e){return Fr(t).put(ti.key,e)},t.prototype.$r=function(t){if(t){var e=Ir(this.serializer,t);return e instanceof an&&e.version.isEqual(L.min())?null:e}return null},t}();function Fr(t){return gi.Ms(t,ti.store)}function qr(t){return gi.Ms(t,$r.store)}function jr(t){return t.path.N()}function Gr(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw g();e=t.noDocument}return JSON.stringify(e).length}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Mr.Kr=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Hr=e,r.Gr=n,r.Yr=new D((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return r.__extends(e,t),e.prototype.Un=function(t){var e=this,n=[],r=0,i=new it((function(t,e){return E(t.F(),e.F())}));return this.Fn.forEach((function(o,s){var u=e.Yr.get(o);if(s){var a=Tr(e.Hr.serializer,s,e.readTime);i=i.add(o.path.p());var c=Gr(a);r+=c-u,n.push(e.Hr.xn(t,o,a))}else if(r-=u,e.Gr){var h=Tr(e.Hr.serializer,new an(o,L.min()),e.readTime);n.push(e.Hr.xn(t,o,h))}else n.push(e.Hr.Mn(t,o))})),i.forEach((function(r){n.push(e.Hr.zn.Ar(t,r))})),n.push(this.Hr.updateMetadata(t,r)),Bn.Cn(n)},e.prototype.qn=function(t,e){var n=this;return this.Hr.xr(t,e).next((function(t){return null===t?(n.Yr.set(e,0),null):(n.Yr.set(e,t.size),t.Or)}))},e.prototype.Bn=function(t,e){var n=this;return this.Hr.Lr(t,e).next((function(t){var e=t.qr;return t.Br.forEach((function(t,e){n.Yr.set(t,e)})),e}))},e}(zn);var Br=function(){function t(){this.Jr=new zr}return t.prototype.Ar=function(t,e){return this.Jr.add(e),Bn.resolve()},t.prototype.hs=function(t,e){return Bn.resolve(this.Jr.getEntries(e))},t}(),zr=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.S(),n=t.p(),r=this.index[e]||new it(V.P),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.S(),n=t.p(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new it(V.P)).N()},t}(),Hr=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;m(n<r&&n>=0&&r<=10);var o=new nr(e);n<1&&r>=1&&(function(t){t.createObjectStore(Kr.store)}(t),function(t){t.createObjectStore(Yr.store,{keyPath:Yr.keyPath}),t.createObjectStore(Xr.store,{keyPath:Xr.keyPath,autoIncrement:!0}).createIndex(Xr.userMutationsIndex,Xr.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Qr.store)}(t),oi(t),function(t){t.createObjectStore($r.store)}(t));var s=Bn.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(ni.store),t.deleteObjectStore(ei.store),t.deleteObjectStore(ri.store)}(t),oi(t)),s=s.next((function(){return function(t){var e=t.store(ri.store),n=new ri(0,0,L.min().A(),0);return e.put(ri.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(Xr.store).Hs().next((function(n){t.deleteObjectStore(Xr.store),t.createObjectStore(Xr.store,{keyPath:Xr.keyPath,autoIncrement:!0}).createIndex(Xr.userMutationsIndex,Xr.userMutationsKeyPath,{unique:!0});var r=e.store(Xr.store),i=n.map((function(t){return r.put(t)}));return Bn.Cn(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(si.store,{keyPath:si.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(ti.store)}(t),i.addDocumentGlobal(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.createCollectionParentIndex(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore($r.store);e.createIndex($r.readTimeIndex,$r.readTimeIndexPath,{unique:!1}),e.createIndex($r.collectionReadTimeIndex,$r.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.rewriteCanonicalIds(o)}))),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store($r.store).Zs((function(t,n){e+=Gr(n)})).next((function(){var n=new ti(e);return t.store(ti.store).put(ti.key,n)}))},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(Yr.store),r=t.store(Xr.store);return n.Hs().next((function(n){return Bn.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Hs(Xr.userMutationsIndex,i).next((function(r){return Bn.forEach(r,(function(r){m(r.userId===n.userId);var i=xr(e.serializer,r);return Lr(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(ni.store),n=t.store($r.store);return t.store(ri.store).get(ri.key).next((function(t){var r=[];return n.Zs((function(n,i){var o=new V(n),s=function(t){return[0,mr(t)]}(o);r.push(e.get(s).next((function(n){return n?Bn.resolve():function(n){return e.put(new ni(0,mr(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return Bn.Cn(r)}))}))},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(ii.store,{keyPath:ii.keyPath});var n=e.store(ii.store),r=new zr,i=function(t){if(r.add(t)){var e=t.S(),i=t.p();return n.put({collectionId:e,parent:mr(i)})}};return e.store($r.store).Zs({Xs:!0},(function(t,e){var n=new V(t);return i(n.p())})).next((function(){return e.store(Qr.store).Zs({Xs:!0},(function(t,e){t[0];var n=t[1],r=(t[2],_r(n));return i(r.p())}))}))},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(ei.store);return n.Zs((function(t,r){var i=Dr(r),o=Rr(e.serializer,i);return n.put(o)}))},t}(),Wr=function(t,e){this.seconds=t,this.nanoseconds=e},Kr=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Kr.store="owner",Kr.key="owner";var Yr=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Yr.store="mutationQueues",Yr.keyPath="userId";var Xr=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Xr.store="mutations",Xr.keyPath="batchId",Xr.userMutationsIndex="userMutationsIndex",Xr.userMutationsKeyPath=["userId","batchId"];var Qr=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,mr(e)]},t.key=function(t,e,n){return[t,mr(e),n]},t}();Qr.store="documentMutations",Qr.PLACEHOLDER=new Qr;var Zr=function(t,e){this.path=t,this.readTime=e},Jr=function(t,e){this.path=t,this.version=e},$r=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};$r.store="remoteDocuments",$r.readTimeIndex="readTimeIndex",$r.readTimeIndexPath="readTime",$r.collectionReadTimeIndex="collectionReadTimeIndex",$r.collectionReadTimeIndexPath=["parentPath","readTime"];var ti=function(t){this.byteSize=t};ti.store="remoteDocumentGlobal",ti.key="remoteDocumentGlobalKey";var ei=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};ei.store="targets",ei.keyPath="targetId",ei.queryTargetsIndexName="queryTargetsIndex",ei.queryTargetsKeyPath=["canonicalId","targetId"];var ni=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};ni.store="targetDocuments",ni.keyPath=["targetId","path"],ni.documentTargetsIndex="documentTargetsIndex",ni.documentTargetsKeyPath=["path","targetId"];var ri=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};ri.key="targetGlobalKey",ri.store="targetGlobal";var ii=function(t,e){this.collectionId=t,this.parent=e};function oi(t){t.createObjectStore(ni.store,{keyPath:ni.keyPath}).createIndex(ni.documentTargetsIndex,ni.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(ei.store,{keyPath:ei.keyPath}).createIndex(ei.queryTargetsIndexName,ei.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(ri.store)}ii.store="collectionParents",ii.keyPath=["collectionId","parent"];var si=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};si.store="clientMetadata",si.keyPath="clientId";var ui=r.__spreadArrays(r.__spreadArrays(r.__spreadArrays([Yr.store,Xr.store,Qr.store,$r.store,ei.store,Kr.store,ri.store,ni.store],[si.store]),[ti.store]),[ii.store]),ai=function(){function t(){this.Xr=new zr}return t.prototype.Ar=function(t,e){var n=this;if(!this.Xr.has(e)){var r=e.S(),i=e.p();t.Wn((function(){n.Xr.add(e)}));var o={collectionId:r,parent:mr(i)};return ci(t).put(o)}return Bn.resolve()},t.prototype.hs=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[T(e),""],!1,!0);return ci(t).Hs(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(_r(o.parent))}return n}))},t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ci(t){return gi.Ms(t,ii.store)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hi=function(){function t(t){this.Zr=t}return t.prototype.next=function(){return this.Zr+=2,this.Zr},t.to=function(){return new t(0)},t.eo=function(){return new t(-1)},t}(),fi=function(){function t(t,e){this.dr=t,this.serializer=e}return t.prototype.no=function(t){var e=this;return this.so(t).next((function(n){var r=new hi(n.highestTargetId);return n.highestTargetId=r.next(),e.io(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.ro=function(t){return this.so(t).next((function(t){return L.I(new O(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.oo=function(t){return this.so(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.ho=function(t,e,n){var r=this;return this.so(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.A()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.io(t,i)}))},t.prototype.ao=function(t,e){var n=this;return this.uo(t,e).next((function(){return n.so(t).next((function(r){return r.targetCount+=1,n.co(e,r),n.io(t,r)}))}))},t.prototype.lo=function(t,e){return this.uo(t,e)},t.prototype._o=function(t,e){var n=this;return this.fo(t,e.targetId).next((function(){return li(t).delete(e.targetId)})).next((function(){return n.so(t)})).next((function(e){return m(e.targetCount>0),e.targetCount-=1,n.io(t,e)}))},t.prototype.hr=function(t,e,n){var r=this,i=0,o=[];return li(t).Zs((function(s,u){var a=Dr(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r._o(t,a)))})).next((function(){return Bn.Cn(o)})).next((function(){return i}))},t.prototype.be=function(t,e){return li(t).Zs((function(t,n){var r=Dr(n);e(r)}))},t.prototype.so=function(t){return pi(t).get(ri.key).next((function(t){return m(null!==t),t}))},t.prototype.io=function(t,e){return pi(t).put(ri.key,e)},t.prototype.uo=function(t,e){return li(t).put(Rr(this.serializer,e))},t.prototype.co=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.do=function(t){return this.so(t).next((function(t){return t.targetCount}))},t.prototype.wo=function(t,e){var n=H(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return li(t).Zs({range:r,index:ei.queryTargetsIndexName},(function(t,n,r){var o=Dr(n);W(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.To=function(t,e,n){var r=this,i=[],o=di(t);return e.forEach((function(e){var s=mr(e.path);i.push(o.put(new ni(n,s))),i.push(r.dr.Eo(t,n,e))})),Bn.Cn(i)},t.prototype.Io=function(t,e,n){var r=this,i=di(t);return Bn.forEach(e,(function(e){var o=mr(e.path);return Bn.Cn([i.delete([n,o]),r.dr.mo(t,n,e)])}))},t.prototype.fo=function(t,e){var n=di(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.Ao=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=di(t),i=pt();return r.Zs({range:n,Xs:!0},(function(t,e,n){var r=_r(t[1]),o=new F(r);i=i.add(o)})).next((function(){return i}))},t.prototype.Nr=function(t,e){var n=mr(e.path),r=IDBKeyRange.bound([n],[T(n)],!1,!0),i=0;return di(t).Zs({index:ni.documentTargetsIndex,Xs:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.Me=function(t,e){return li(t).get(e).next((function(t){return t?Dr(t):null}))},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function li(t){return gi.Ms(t,ei.store)}function pi(t){return gi.Ms(t,ri.store)}function di(t){return gi.Ms(t,ni.store)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vi="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",yi=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).vr=e,r.Ro=n,r}return r.__extends(e,t),e}(Wn),gi=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Is=o,this.window=s,this.document=u,this.Po=c,this.Vo=h,this.yo=null,this.po=!1,this.isPrimary=!1,this.networkEnabled=!0,this.bo=null,this.inForeground=!1,this.vo=null,this.So=null,this.Do=Number.NEGATIVE_INFINITY,this.Co=function(t){return Promise.resolve()},!t.ks())throw new k(R.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.dr=new bi(this,i),this.No=n+"main",this.serializer=new Er(a),this.Fo=new Jn(this.No,10,new Hr(this.serializer)),this.ko=new fi(this.dr,this.serializer),this.zn=new ai,this.Kn=new Mr(this.serializer,this.zn),this.window&&this.window.localStorage?this.$o=this.window.localStorage:(this.$o=null,!1===h&&d("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.Ms=function(t,e){if(t instanceof yi)return Jn.Ms(t.vr,e);throw g()},t.prototype.start=function(){var t=this;return this.xo().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new k(R.FAILED_PRECONDITION,vi);return t.Oo(),t.Mo(),t.Lo(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.ko.oo(e)}))})).then((function(e){t.yo=new Xn(e,t.Po)})).then((function(){t.po=!0})).catch((function(e){return t.Fo&&t.Fo.close(),Promise.reject(e)}))},t.prototype.qo=function(t){var e=this;return this.Co=function(n){return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(e){return this.tr?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.Bo=function(t){var e=this;this.Fo.Bs((function(n){return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.Uo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Is.ai((function(){return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return this.tr?[4,this.xo()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.xo=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return wi(e).put(new si(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Qo(e).next((function(e){e||(t.isPrimary=!1,t.Is.gi((function(){return t.Co(!1)})))}))})).next((function(){return t.Wo(e)})).next((function(n){return t.isPrimary&&!n?t.jo(e).next((function(){return!1})):!!n&&t.Ko(e).next((function(){return!0}))}))})).catch((function(e){if(er(e))return p("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return p("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Is.gi((function(){return t.Co(e)})),t.isPrimary=e}))},t.prototype.Qo=function(t){var e=this;return mi(t).get(Kr.key).next((function(t){return Bn.resolve(e.Go(t))}))},t.prototype.zo=function(t){return wi(t).delete(this.clientId)},t.prototype.Ho=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,n,i,o,s=this;return r.__generator(this,(function(r){switch(r.label){case 0:return!this.isPrimary||this.Yo(this.Do,18e5)?[3,2]:(this.Do=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var n=t.Ms(e,si.store);return n.Hs().next((function(t){var e=s.Jo(t,18e5),r=t.filter((function(t){return-1===e.indexOf(t)}));return Bn.forEach(r,(function(t){return n.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(e=r.sent(),this.$o)for(n=0,i=e;n<i.length;n++)o=i[n],this.$o.removeItem(this.Xo(o.clientId));r.label=2;case 2:return[2]}}))}))},t.prototype.Lo=function(){var t=this;this.So=this.Is.Ss("client_metadata_refresh",4e3,(function(){return t.xo().then((function(){return t.Ho()})).then((function(){return t.Lo()}))}))},t.prototype.Go=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Wo=function(t){var e=this;return this.Vo?Bn.resolve(!0):mi(t).get(Kr.key).next((function(n){if(null!==n&&e.Yo(n.leaseTimestampMs,5e3)&&!e.Zo(n.ownerId)){if(e.Go(n)&&e.networkEnabled)return!0;if(!e.Go(n)){if(!n.allowTabSynchronization)throw new k(R.FAILED_PRECONDITION,vi);return!1}}return!(!e.networkEnabled||!e.inForeground)||wi(t).Hs().next((function(t){return void 0===e.Jo(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&p("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.th=function(){return r.__awaiter(this,void 0,void 0,(function(){var t=this;return r.__generator(this,(function(e){switch(e.label){case 0:return this.po=!1,this.eh(),this.So&&(this.So.cancel(),this.So=null),this.nh(),this.sh(),[4,this.Fo.runTransaction("readwrite",[Kr.store,si.store],(function(e){var n=new yi(e,Xn.Es);return t.jo(n).next((function(){return t.zo(n)}))}))];case 1:return e.sent(),this.Fo.close(),this.ih(),[2]}}))}))},t.prototype.Jo=function(t,e){var n=this;return t.filter((function(t){return n.Yo(t.updateTimeMs,e)&&!n.Zo(t.clientId)}))},t.prototype.rh=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return wi(e).Hs().next((function(e){return t.Jo(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"tr",{get:function(){return this.po},enumerable:!1,configurable:!0}),t.prototype.oh=function(t){return kr.Tr(t,this.serializer,this.zn,this.dr)},t.prototype.hh=function(){return this.ko},t.prototype.ah=function(){return this.Kn},t.prototype.uh=function(){return this.zn},t.prototype.runTransaction=function(t,e,n){var r=this;p("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Fo.runTransaction(o,ui,(function(o){return i=new yi(o,r.yo?r.yo.next():Xn.Es),"readwrite-primary"===e?r.Qo(i).next((function(t){return!!t||r.Wo(i)})).next((function(e){if(!e)throw d("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Is.gi((function(){return r.Co(!1)})),new k(R.FAILED_PRECONDITION,Hn);return n(i)})).next((function(t){return r.Ko(i).next((function(){return t}))})):r.lh(i).next((function(){return n(i)}))})).then((function(t){return i.jn(),t}))},t.prototype.lh=function(t){var e=this;return mi(t).get(Kr.key).next((function(t){if(null!==t&&e.Yo(t.leaseTimestampMs,5e3)&&!e.Zo(t.ownerId)&&!e.Go(t)&&!(e.Vo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new k(R.FAILED_PRECONDITION,vi)}))},t.prototype.Ko=function(t){var e=new Kr(this.clientId,this.allowTabSynchronization,Date.now());return mi(t).put(Kr.key,e)},t.ks=function(){return Jn.ks()},t.prototype.jo=function(t){var e=this,n=mi(t);return n.get(Kr.key).next((function(t){return e.Go(t)?(p("IndexedDbPersistence","Releasing primary lease."),n.delete(Kr.key)):Bn.resolve()}))},t.prototype.Yo=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(d("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Oo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.vo=function(){t.Is.ai((function(){return t.inForeground="visible"===t.document.visibilityState,t.xo()}))},this.document.addEventListener("visibilitychange",this.vo),this.inForeground="visible"===this.document.visibilityState)},t.prototype.nh=function(){this.vo&&(this.document.removeEventListener("visibilitychange",this.vo),this.vo=null)},t.prototype.Mo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.bo=function(){e.eh(),e.Is.ai((function(){return e.th()}))},this.window.addEventListener("unload",this.bo))},t.prototype.sh=function(){this.bo&&(this.window.removeEventListener("unload",this.bo),this.bo=null)},t.prototype.Zo=function(t){var e;try{var n=null!==(null===(e=this.$o)||void 0===e?void 0:e.getItem(this.Xo(t)));return p("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return d("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.eh=function(){if(this.$o)try{this.$o.setItem(this.Xo(this.clientId),String(Date.now()))}catch(r){d("Failed to set zombie client id.",r)}},t.prototype.ih=function(){if(this.$o)try{this.$o.removeItem(this.Xo(this.clientId))}catch(r){}},t.prototype.Xo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function mi(t){return gi.Ms(t,Kr.store)}function wi(t){return gi.Ms(t,si.store)}var bi=function(){function t(t,e){this.db=t,this.Yi=new gr(this,e)}return t.prototype.ir=function(t){var e=this._h(t);return this.db.hh().do(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype._h=function(t){var e=0;return this.or(t,(function(t){e++})).next((function(){return e}))},t.prototype.be=function(t,e){return this.db.hh().be(t,e)},t.prototype.or=function(t,e){return this.fh(t,(function(t,n){return e(n)}))},t.prototype.Eo=function(t,e,n){return _i(t,n)},t.prototype.mo=function(t,e,n){return _i(t,n)},t.prototype.hr=function(t,e,n){return this.db.hh().hr(t,e,n)},t.prototype.Dr=function(t,e){return _i(t,e)},t.prototype.dh=function(t,e){return function(t,e){var n=!1;return Ur(t).ti((function(r){return Or(t,r,e).next((function(t){return t&&(n=!0),Bn.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.ar=function(t,e){var n=this,r=this.db.ah().jr(),i=[],o=0;return this.fh(t,(function(s,u){if(u<=e){var a=n.dh(t,s).next((function(e){if(!e)return o++,r.Ln(t,s).next((function(){return r.Mn(s),di(t).delete([0,mr(s.path)])}))}));i.push(a)}})).next((function(){return Bn.Cn(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.tt(t.Ro);return this.db.hh().lo(t,n)},t.prototype.wh=function(t,e){return _i(t,e)},t.prototype.fh=function(t,e){var n,r=di(t),i=Xn.Es;return r.Zs({index:ni.documentTargetsIndex},(function(t,r){var o=t[0],s=(t[1],r.path),u=r.sequenceNumber;0===o?(i!==Xn.Es&&e(new F(_r(n)),i),i=u,n=s):i=Xn.Es})).next((function(){i!==Xn.Es&&e(new F(_r(n)),i)}))},t.prototype.cr=function(t){return this.db.ah().zr(t)},t}();function _i(t,e){return di(t).put(function(t,e){return new ni(0,mr(t.path),e)}(e,t.Ro))}function Ei(t,e){var n=t.projectId;return t.i||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Ii=function(){function t(t,e,n){this.persistence=t,this.Th=e,this.Eh=new et(E),this.Ih=new D((function(t){return H(t)}),W),this.mh=L.min(),this.Gn=t.oh(n),this.Ah=t.ah(),this.ko=t.hh(),this.Rh=new Kn(this.Ah,this.Gn,this.persistence.uh()),this.Th.Ph(this.Rh)}return t.prototype.er=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.ur(n,e.Eh)}))},t}();function Ti(t,e){var n=w(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.Ah.jr({Gr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=Bn.resolve();return o.forEach((function(t){s=s.next((function(){return r.Ln(e,t)})).next((function(e){var o=e,s=n.Pn.get(t);m(null!==s),(!o||o.version.o(s)<0)&&(o=i.En(t,o,n))&&r.xn(o,n.Rn)}))})),s.next((function(){return t.Gn.br(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n.Gn.Cr(t)})).next((function(){return n.Rh.Zn(t,r)}))}))}function Ai(t){var e=w(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.ko.ro(t)}))}function Ni(t,e){var n=w(t),r=e.Z,i=n.Eh;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.Ah.jr({Gr:!0});i=n.Eh;var s=[];e.Wt.forEach((function(e,o){var u=i.get(o);if(u){s.push(n.ko.Io(t,e.Zt,o).next((function(){return n.ko.To(t,e.Jt,o)})));var a=e.resumeToken;if(a.Y()>0){var c=u.et(a,r).tt(t.Ro);i=i.st(o,c),function(t,e,n){return m(e.resumeToken.Y()>0),0===t.resumeToken.Y()||e.Z.m()-t.Z.m()>=3e8||n.Jt.size+n.Xt.size+n.Zt.size>0}(u,c,e)&&s.push(n.ko.lo(t,c))}}}));var u=ut(),a=pt();if(e.Kt.forEach((function(t,e){a=a.add(t)})),s.push(o.getEntries(t,a).next((function(i){e.Kt.forEach((function(a,c){var h=i.get(a);c instanceof an&&c.version.isEqual(L.min())?(o.Mn(a,r),u=u.st(a,c)):null==h||c.version.o(h.version)>0||0===c.version.o(h.version)&&h.hasPendingWrites?(o.xn(c,r),u=u.st(a,c)):p("LocalStore","Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",c.version),e.Gt.has(a)&&s.push(n.persistence.dr.wh(t,a))}))}))),!r.isEqual(L.min())){var c=n.ko.ro(t).next((function(e){return n.ko.ho(t,t.Ro,r)}));s.push(c)}return Bn.Cn(s).next((function(){return o.apply(t)})).next((function(){return n.Rh.ts(t,u)}))})).then((function(t){return n.Eh=i,t}))}function Si(t,e){var n=w(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.Gn.gr(t,e)}))}function Pi(t,e){var n=w(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.ko.wo(t,e).next((function(i){return i?(r=i,Bn.resolve(r)):n.ko.no(t).next((function(i){return r=new Z(e,i,0,t.Ro),n.ko.ao(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Eh.get(t.targetId);return(null===r||t.Z.o(r.Z)>0)&&(n.Eh=n.Eh.st(t.targetId,t),n.Ih.set(e,t.targetId)),t}))}function xi(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s,u;return r.__generator(this,(function(r){switch(r.label){case 0:i=w(t),o=i.Eh.get(e),s=n?"readwrite":"readwrite-primary",r.label=1;case 1:return r.trys.push([1,4,,5]),n?[3,3]:[4,i.persistence.runTransaction("Release target",s,(function(t){return i.persistence.dr.removeTarget(t,o)}))];case 2:r.sent(),r.label=3;case 3:return[3,5];case 4:if(!er(u=r.sent()))throw u;return p("LocalStore","Failed to update sequence numbers for target "+e+": "+u),[3,5];case 5:return i.Eh=i.Eh.remove(e),i.Ih.delete(o.target),[2]}}))}))}function Di(t,e,n){var r=w(t),i=L.min(),o=pt();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=w(t),i=r.Ih.get(n);return void 0!==i?Bn.resolve(r.Eh.get(i)):r.ko.wo(e,n)}(r,t,yn(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.ko.Ao(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.Th.ns(t,e,n?i:L.min(),n?o:pt())})).next((function(t){return{documents:t,gh:o}}))}))}function Ri(t,e){var n=w(t),r=w(n.ko),i=n.Eh.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.Me(t,e).next((function(t){return t?t.target:null}))}))}function ki(t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){if(t.code!==R.FAILED_PRECONDITION||t.message!==Hn)throw t;return p("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Oi=function(){function t(){this.Vh=new it(Li.yh),this.ph=new it(Li.bh)}return t.prototype._=function(){return this.Vh._()},t.prototype.Eo=function(t,e){var n=new Li(t,e);this.Vh=this.Vh.add(n),this.ph=this.ph.add(n)},t.prototype.vh=function(t,e){var n=this;t.forEach((function(t){return n.Eo(t,e)}))},t.prototype.mo=function(t,e){this.Sh(new Li(t,e))},t.prototype.Dh=function(t,e){var n=this;t.forEach((function(t){return n.mo(t,e)}))},t.prototype.Ch=function(t){var e=this,n=new F(new V([])),r=new Li(n,t),i=new Li(n,t+1),o=[];return this.ph.St([r,i],(function(t){e.Sh(t),o.push(t.key)})),o},t.prototype.Nh=function(){var t=this;this.Vh.forEach((function(e){return t.Sh(e)}))},t.prototype.Sh=function(t){this.Vh=this.Vh.delete(t),this.ph=this.ph.delete(t)},t.prototype.Fh=function(t){var e=new F(new V([])),n=new Li(e,t),r=new Li(e,t+1),i=pt();return this.ph.St([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.Nr=function(t){var e=new Li(t,0),n=this.Vh.Ct(e);return null!==n&&t.isEqual(n.key)},t}(),Li=function(){function t(t,e){this.key=t,this.kh=e}return t.yh=function(t,e){return F.P(t.key,e.key)||E(t.kh,e.kh)},t.bh=function(t,e){return E(t.kh,e.kh)||F.P(t.key,e.key)},t}(),Ci=function(){function t(t){this.uid=t}return t.prototype.Er=function(){return null!=this.uid},t.prototype.$h=function(){return this.Er()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Ci.UNAUTHENTICATED=new Ci(null),Ci.xh=new Ci("google-credentials-uid"),Ci.Oh=new Ci("first-party-uid");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Vi=function(t,e){this.user=e,this.type="OAuth",this.Mh={},this.Mh.Authorization="Bearer "+t},Ui=function(){function t(){this.Lh=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.qh=function(){},t.prototype.Bh=function(t){this.Lh=t,t(Ci.UNAUTHENTICATED)},t.prototype.Uh=function(){this.Lh=null},t}(),Mi=function(){function t(t){var e=this;this.Qh=null,this.currentUser=Ci.UNAUTHENTICATED,this.Wh=!1,this.jh=0,this.Lh=null,this.forceRefresh=!1,this.Qh=function(){e.jh++,e.currentUser=e.Kh(),e.Wh=!0,e.Lh&&e.Lh(e.currentUser)},this.jh=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Qh):(this.Qh(null),t.get().then((function(t){e.auth=t,e.Qh&&e.auth.addAuthTokenListener(e.Qh)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.jh,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.jh!==e?(p("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(m("string"==typeof n.accessToken),new Vi(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.qh=function(){this.forceRefresh=!0},t.prototype.Bh=function(t){this.Lh=t,this.Wh&&t(this.currentUser)},t.prototype.Uh=function(){this.auth&&this.auth.removeAuthTokenListener(this.Qh),this.Qh=null,this.Lh=null},t.prototype.Kh=function(){var t=this.auth&&this.auth.getUid();return m(null===t||"string"==typeof t),new Ci(t)},t}(),Fi=function(){function t(t,e){this.Gh=t,this.zh=e,this.type="FirstParty",this.user=Ci.Oh}return Object.defineProperty(t.prototype,"Mh",{get:function(){var t={"X-Goog-AuthUser":this.zh},e=this.Gh.auth.Hh([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),qi=function(){function t(t,e){this.Gh=t,this.zh=e}return t.prototype.getToken=function(){return Promise.resolve(new Fi(this.Gh,this.zh))},t.prototype.Bh=function(t){t(Ci.Oh)},t.prototype.Uh=function(){},t.prototype.qh=function(){},t}(),ji=function(){function t(t,e,n,r,i,o){this.Is=t,this.Yh=n,this.Jh=r,this.Xh=i,this.listener=o,this.state=0,this.Zh=0,this.ta=null,this.stream=null,this.Ti=new Zn(t,e)}return t.prototype.ea=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.na=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.sa()},t.prototype.stop=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return this.ea()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.ia=function(){this.state=0,this.Ti.reset()},t.prototype.ra=function(){var t=this;this.na()&&null===this.ta&&(this.ta=this.Is.Ss(this.Yh,6e4,(function(){return t.oa()})))},t.prototype.ha=function(t){this.aa(),this.stream.send(t)},t.prototype.oa=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){return this.na()?[2,this.close(0)]:[2]}))}))},t.prototype.aa=function(){this.ta&&(this.ta.cancel(),this.ta=null)},t.prototype.close=function(t,e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(n){switch(n.label){case 0:return this.aa(),this.Ti.cancel(),this.Zh++,3!==t?this.Ti.reset():e&&e.code===R.RESOURCE_EXHAUSTED?(d(e.toString()),d("Using maximum backoff delay to prevent overloading the backend."),this.Ti.ps()):e&&e.code===R.UNAUTHENTICATED&&this.Xh.qh(),null!==this.stream&&(this.ua(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.ca(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ua=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.la(this.Zh),n=this.Zh;this.Xh.getToken().then((function(e){t.Zh===n&&t._a(e)}),(function(n){e((function(){var e=new k(R.UNKNOWN,"Fetching auth token failed: "+n.message);return t.fa(e)}))}))},t.prototype._a=function(t){var e=this,n=this.la(this.Zh);this.stream=this.da(t),this.stream.wa((function(){n((function(){return e.state=2,e.listener.wa()}))})),this.stream.ca((function(t){n((function(){return e.fa(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.sa=function(){var t=this;this.state=4,this.Ti.bs((function(){return r.__awaiter(t,void 0,void 0,(function(){return r.__generator(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.fa=function(t){return p("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.la=function(t){var e=this;return function(n){e.Is.ai((function(){return e.Zh===t?n():(p("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Gi=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,s}return r.__extends(e,t),e.prototype.da=function(t){return this.Jh.Ta("Listen",t)},e.prototype.onMessage=function(t){this.Ti.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:g()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.Le?(m(void 0===e||"string"==typeof e),Y.fromBase64String(e||"")):(m(void 0===e||e instanceof Uint8Array),Y.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,u=s&&function(t){var e=void 0===t.code?R.UNKNOWN:tt(t.code);return new k(e,t.message||"")}(s);n=new It(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;var a=e.documentChange;a.document,a.document.name,a.document.updateTime;var c=oe(t,a.document.name),h=ee(a.document.updateTime),f=new nn({mapValue:{fields:a.document.fields}}),l=new un(c,h,f,{}),p=a.targetIds||[],d=a.removedTargetIds||[];n=new _t(p,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;var v=e.documentDelete;v.document;var y=oe(t,v.document),w=v.readTime?ee(v.readTime):L.min(),b=new an(y,w),_=v.removedTargetIds||[];n=new _t([],_,b.key,b)}else if("documentRemove"in e){e.documentRemove;var E=e.documentRemove;E.document;var I=oe(t,E.document),T=E.removedTargetIds||[];n=new _t([],T,I,null)}else{if(!("filter"in e))return g();e.filter;var A=e.filter;A.targetId;var N=A.count||0,S=new J(N),P=A.targetId;n=new Et(P,S)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return L.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?L.min():e.readTime?ee(e.readTime):L.min()}(t);return this.listener.Ea(e,n)},e.prototype.Ia=function(t){var e={};e.database=ae(this.serializer),e.addTarget=function(t,e){var n,r=e.target;return(n=K(r)?{documents:pe(t,r)}:{query:de(t,r)}).targetId=e.targetId,e.resumeToken.Y()>0&&(n.resumeToken=$t(t,e.resumeToken)),n}(this.serializer,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return g()}}(0,e.X);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.ha(e)},e.prototype.ma=function(t){var e={};e.database=ae(this.serializer),e.removeTarget=t,this.ha(e)},e}(ji),Bi=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,s.Aa=!1,s}return r.__extends(e,t),Object.defineProperty(e.prototype,"Ra",{get:function(){return this.Aa},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.Aa=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ua=function(){this.Aa&&this.Pa([])},e.prototype.da=function(t){return this.Jh.Ta("Write",t)},e.prototype.onMessage=function(t){if(m(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Aa){this.Ti.reset();var e=function(t,e){return t&&t.length>0?(m(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?ee(t.updateTime):ee(e);n.isEqual(L.min())&&(n=ee(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new Fe(n,r)}(t,e)}))):[]}(t.writeResults,t.commitTime),n=ee(t.commitTime);return this.listener.ga(n,e)}return m(!t.writeResults||0===t.writeResults.length),this.Aa=!0,this.listener.Va()},e.prototype.ya=function(){var t={};t.database=ae(this.serializer),this.ha(t)},e.prototype.Pa=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return fe(e.serializer,t)}))};this.ha(n)},e}(ji),zi=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Jh=n,i.serializer=r,i.pa=!1,i}return r.__extends(e,t),e.prototype.ba=function(){if(this.pa)throw new k(R.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.va=function(t,e,n){var r=this;return this.ba(),this.credentials.getToken().then((function(i){return r.Jh.va(t,e,n,i)})).catch((function(t){throw t.code===R.UNAUTHENTICATED&&r.credentials.qh(),t}))},e.prototype.Sa=function(t,e,n){var r=this;return this.ba(),this.credentials.getToken().then((function(i){return r.Jh.Sa(t,e,n,i)})).catch((function(t){throw t.code===R.UNAUTHENTICATED&&r.credentials.qh(),t}))},e.prototype.terminate=function(){this.pa=!1},e}((function(){})),Hi=function(){function t(t,e){this.ei=t,this.Da=e,this.state="Unknown",this.Ca=0,this.Na=null,this.Fa=!0}return t.prototype.ka=function(){var t=this;0===this.Ca&&(this.$a("Unknown"),this.Na=this.ei.Ss("online_state_timeout",1e4,(function(){return t.Na=null,t.xa("Backend didn't respond within 10 seconds."),t.$a("Offline"),Promise.resolve()})))},t.prototype.Oa=function(t){"Online"===this.state?this.$a("Unknown"):(this.Ca++,this.Ca>=1&&(this.Ma(),this.xa("Connection failed 1 times. Most recent error: "+t.toString()),this.$a("Offline")))},t.prototype.set=function(t){this.Ma(),this.Ca=0,"Online"===t&&(this.Fa=!1),this.$a(t)},t.prototype.$a=function(t){t!==this.state&&(this.state=t,this.Da(t))},t.prototype.xa=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Fa?(d(e),this.Fa=!1):p("OnlineStateTracker",e)},t.prototype.Ma=function(){null!==this.Na&&(this.Na.cancel(),this.Na=null)},t}(),Wi=function(){function t(t,e,n,i,o){var s=this;this.La=t,this.qa=e,this.ei=n,this.Ba=[],this.Ua=new Map,this.Qa=null,this.Wa=new Set,this.ja=o,this.ja.Ka((function(t){n.ai((function(){return r.__awaiter(s,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return this.Ga()?(p("RemoteStore","Restarting streams for network reachability change."),[4,this.za()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Ha=new Hi(n,i),this.Ya=function(t,e,n){var r=w(t);return r.ba(),new Gi(e,r.Jh,r.credentials,r.serializer,n)}(this.qa,n,{wa:this.Ja.bind(this),ca:this.Xa.bind(this),Ea:this.Za.bind(this)}),this.tu=function(t,e,n){var r=w(t);return r.ba(),new Bi(e,r.Jh,r.credentials,r.serializer,n)}(this.qa,n,{wa:this.eu.bind(this),ca:this.nu.bind(this),Va:this.su.bind(this),ga:this.ga.bind(this)})}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.enableNetwork=function(){return this.Wa.delete(0),this.iu()},t.prototype.iu=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return this.Ga()?(this.ru()?this.ou():this.Ha.set("Unknown"),[4,this.hu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.disableNetwork=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return this.Wa.add(0),[4,this.au()];case 1:return t.sent(),this.Ha.set("Offline"),[2]}}))}))},t.prototype.au=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,this.tu.stop()];case 1:return t.sent(),[4,this.Ya.stop()];case 2:return t.sent(),this.Ba.length>0&&(p("RemoteStore","Stopping write stream with "+this.Ba.length+" pending writes"),this.Ba=[]),this.uu(),[2]}}))}))},t.prototype.th=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return p("RemoteStore","RemoteStore shutting down."),this.Wa.add(5),[4,this.au()];case 1:return t.sent(),this.ja.th(),this.Ha.set("Unknown"),[2]}}))}))},t.prototype.listen=function(t){this.Ua.has(t.targetId)||(this.Ua.set(t.targetId,t),this.ru()?this.ou():this.Ya.na()&&this.cu(t))},t.prototype.lu=function(t){this.Ua.delete(t),this.Ya.na()&&this._u(t),0===this.Ua.size&&(this.Ya.na()?this.Ya.ra():this.Ga()&&this.Ha.set("Unknown"))},t.prototype.Me=function(t){return this.Ua.get(t)||null},t.prototype.Oe=function(t){return this.fu.Oe(t)},t.prototype.cu=function(t){this.Qa.we(t.targetId),this.Ya.Ia(t)},t.prototype._u=function(t){this.Qa.we(t),this.Ya.ma(t)},t.prototype.ou=function(){this.Qa=new At(this),this.Ya.start(),this.Ha.ka()},t.prototype.ru=function(){return this.Ga()&&!this.Ya.ea()&&this.Ua.size>0},t.prototype.Ga=function(){return 0===this.Wa.size},t.prototype.uu=function(){this.Qa=null},t.prototype.Ja=function(){return r.__awaiter(this,void 0,void 0,(function(){var t=this;return r.__generator(this,(function(e){return this.Ua.forEach((function(e,n){t.cu(e)})),[2]}))}))},t.prototype.Xa=function(t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){return this.uu(),this.ru()?(this.Ha.Oa(t),this.ou()):this.Ha.set("Unknown"),[2]}))}))},t.prototype.Za=function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o;return r.__generator(this,(function(r){switch(r.label){case 0:if(this.Ha.set("Online"),!(t instanceof It&&2===t.state&&t.cause))return[3,6];r.label=1;case 1:return r.trys.push([1,3,,5]),[4,this.du(t)];case 2:return r.sent(),[3,5];case 3:return n=r.sent(),p("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),[4,this.wu(n)];case 4:return r.sent(),[3,5];case 5:return[3,13];case 6:if(t instanceof _t?this.Qa.ge(t):t instanceof Et?this.Qa.Ce(t):this.Qa.pe(t),e.isEqual(L.min()))return[3,13];r.label=7;case 7:return r.trys.push([7,11,,13]),[4,Ai(this.La)];case 8:return i=r.sent(),e.o(i)>=0?[4,this.Tu(e)]:[3,10];case 9:r.sent(),r.label=10;case 10:return[3,13];case 11:return p("RemoteStore","Failed to raise snapshot:",o=r.sent()),[4,this.wu(o)];case 12:return r.sent(),[3,13];case 13:return[2]}}))}))},t.prototype.wu=function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n=this;return r.__generator(this,(function(i){switch(i.label){case 0:if(!er(t))throw t;return this.Wa.add(1),[4,this.au()];case 1:return i.sent(),this.Ha.set("Offline"),e||(e=function(){return Ai(n.La)}),this.ei.gi((function(){return r.__awaiter(n,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return p("RemoteStore","Retrying IndexedDB access"),[4,e()];case 1:return t.sent(),this.Wa.delete(1),[4,this.iu()];case 2:return t.sent(),[2]}}))}))})),[2]}}))}))},t.prototype.Eu=function(t){var e=this;return t().catch((function(n){return e.wu(n,t)}))},t.prototype.Tu=function(t){var e=this,n=this.Qa.ke(t);return n.Wt.forEach((function(n,r){if(n.resumeToken.Y()>0){var i=e.Ua.get(r);i&&e.Ua.set(r,i.et(n.resumeToken,t))}})),n.jt.forEach((function(t){var n=e.Ua.get(t);if(n){e.Ua.set(t,n.et(Y.J,n.Z)),e._u(t);var r=new Z(n.target,t,1,n.sequenceNumber);e.cu(r)}})),this.fu.Iu(n)},t.prototype.du=function(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n,i,o;return r.__generator(this,(function(r){switch(r.label){case 0:e=t.cause,n=0,i=t.targetIds,r.label=1;case 1:return n<i.length?(o=i[n],this.Ua.has(o)?[4,this.fu.mu(o,e)]:[3,3]):[3,5];case 2:r.sent(),this.Ua.delete(o),this.Qa.removeTarget(o),r.label=3;case 3:r.label=4;case 4:return n++,[3,1];case 5:return[2]}}))}))},t.prototype.hu=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,e,n;return r.__generator(this,(function(r){switch(r.label){case 0:t=this.Ba.length>0?this.Ba[this.Ba.length-1].batchId:-1,r.label=1;case 1:if(!this.Au())return[3,7];r.label=2;case 2:return r.trys.push([2,4,,6]),[4,Si(this.La,t)];case 3:return null===(e=r.sent())?(0===this.Ba.length&&this.tu.ra(),[3,7]):(t=e.batchId,this.Ru(e),[3,6]);case 4:return n=r.sent(),[4,this.wu(n)];case 5:return r.sent(),[3,6];case 6:return[3,1];case 7:return this.Pu()&&this.gu(),[2]}}))}))},t.prototype.Au=function(){return this.Ga()&&this.Ba.length<10},t.prototype.Vu=function(){return this.Ba.length},t.prototype.Ru=function(t){this.Ba.push(t),this.tu.na()&&this.tu.Ra&&this.tu.Pa(t.mutations)},t.prototype.Pu=function(){return this.Ga()&&!this.tu.ea()&&this.Ba.length>0},t.prototype.gu=function(){this.tu.start()},t.prototype.eu=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){return this.tu.ya(),[2]}))}))},t.prototype.su=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,e,n;return r.__generator(this,(function(r){for(t=0,e=this.Ba;t<e.length;t++)n=e[t],this.tu.Pa(n.mutations);return[2]}))}))},t.prototype.ga=function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o=this;return r.__generator(this,(function(r){switch(r.label){case 0:return n=this.Ba.shift(),i=Gn.from(n,t,e),[4,this.Eu((function(){return o.fu.yu(i)}))];case 1:return r.sent(),[4,this.hu()];case 2:return r.sent(),[2]}}))}))},t.prototype.nu=function(t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return t&&this.tu.Ra?[4,this.pu(t)]:[3,2];case 1:e.sent(),e.label=2;case 2:return this.Pu()&&this.gu(),[2]}}))}))},t.prototype.pu=function(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n,i=this;return r.__generator(this,(function(r){switch(r.label){case 0:return $(n=t.code)&&n!==R.ABORTED?(e=this.Ba.shift(),this.tu.ia(),[4,this.Eu((function(){return i.fu.bu(e.batchId,t)}))]):[3,3];case 1:return r.sent(),[4,this.hu()];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},t.prototype.za=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return this.Wa.add(4),[4,this.au()];case 1:return t.sent(),this.Ha.set("Unknown"),this.tu.ia(),this.Ya.ia(),this.Wa.delete(4),[4,this.iu()];case 2:return t.sent(),[2]}}))}))},t.prototype.vu=function(t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return this.ei.pi(),p("RemoteStore","RemoteStore received new credentials"),this.Wa.add(3),[4,this.au()];case 1:return e.sent(),this.Ha.set("Unknown"),[4,this.fu.vu(t)];case 2:return e.sent(),this.Wa.delete(3),[4,this.iu()];case 3:return e.sent(),[2]}}))}))},t.prototype.Su=function(t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return t?(this.Wa.delete(2),[4,this.iu()]):[3,2];case 1:return e.sent(),[3,5];case 2:return t?[3,4]:(this.Wa.add(2),[4,this.au()]);case 3:e.sent(),this.Ha.set("Unknown"),e.label=4;case 4:e.label=5;case 5:return[2]}}))}))},t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ki(t,e){return"firestore_clients_"+t+"_"+e}function Yi(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Er()&&(r+="_"+e.uid),r}function Xi(t,e){return"firestore_targets_"+t+"_"+e}var Qi=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Du=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new k(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(d("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Cu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Zi=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Du=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new k(r.error.code,r.error.message)),i?new t(e,r.state,o):(d("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Cu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Ji=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Du=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=vt(),s=0;i&&s<r.activeTargetIds.length;++s)i=G(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(d("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),$i=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Du=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(d("SharedClientState","Failed to parse online state: "+e),null)},t}(),to=function(){function t(){this.activeTargetIds=vt()}return t.prototype.Nu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Fu=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Cu=function(){var t={activeTargetIds:this.activeTargetIds.N(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),eo=function(){function t(t,e,n,r,i){this.window=t,this.Is=e,this.persistenceKey=n,this.ku=r,this.fu=null,this.Da=null,this.fs=null,this.$u=this.xu.bind(this),this.Ou=new et(E),this.tr=!1,this.Mu=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Lu=Ki(this.persistenceKey,this.ku),this.qu=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Ou=this.Ou.st(this.ku,new to),this.Bu=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Uu=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Qu=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Wu=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.$u)}return t.ks=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,e,n,i,o,s,u,a,c,h,f,l=this;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.fu.rh()];case 1:for(t=r.sent(),e=0,n=t;e<n.length;e++)(i=n[e])!==this.ku&&(o=this.getItem(Ki(this.persistenceKey,i)))&&(s=Ji.Du(i,o))&&(this.Ou=this.Ou.st(s.clientId,s));for(this.ju(),(u=this.storage.getItem(this.Wu))&&(a=this.Ku(u))&&this.Gu(a),c=0,h=this.Mu;c<h.length;c++)f=h[c],this.xu(f);return this.Mu=[],this.window.addEventListener("unload",(function(){return l.th()})),this.tr=!0,[2]}}))}))},t.prototype.Ts=function(t){this.setItem(this.qu,JSON.stringify(t))},t.prototype.zu=function(){return this.Hu(this.Ou)},t.prototype.Yu=function(t){var e=!1;return this.Ou.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.Ju=function(t){this.Xu(t,"pending")},t.prototype.Zu=function(t,e,n){this.Xu(t,e,n),this.tc(t)},t.prototype.ec=function(t){var e="not-current";if(this.Yu(t)){var n=this.storage.getItem(Xi(this.persistenceKey,t));if(n){var r=Zi.Du(t,n);r&&(e=r.state)}}return this.nc.Nu(t),this.ju(),e},t.prototype.sc=function(t){this.nc.Fu(t),this.ju()},t.prototype.ic=function(t){return this.nc.activeTargetIds.has(t)},t.prototype.rc=function(t){this.removeItem(Xi(this.persistenceKey,t))},t.prototype.oc=function(t,e,n){this.hc(t,e,n)},t.prototype.ac=function(t,e,n){var r=this;e.forEach((function(t){r.tc(t)})),this.currentUser=t,n.forEach((function(t){r.Ju(t)}))},t.prototype.uc=function(t){this.cc(t)},t.prototype.th=function(){this.tr&&(this.window.removeEventListener("storage",this.$u),this.removeItem(this.Lu),this.tr=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return p("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){p("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){p("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.xu=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(p("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Lu)return void d("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Is.gi((function(){return r.__awaiter(e,void 0,void 0,(function(){var t,e,i,o,s,u;return r.__generator(this,(function(r){if(this.tr){if(null!==n.key)if(this.Bu.test(n.key)){if(null==n.newValue)return t=this.lc(n.key),[2,this._c(t,null)];if(e=this.fc(n.key,n.newValue))return[2,this._c(e.clientId,e)]}else if(this.Uu.test(n.key)){if(null!==n.newValue&&(i=this.dc(n.key,n.newValue)))return[2,this.wc(i)]}else if(this.Qu.test(n.key)){if(null!==n.newValue&&(o=this.Tc(n.key,n.newValue)))return[2,this.Ec(o)]}else if(n.key===this.Wu){if(null!==n.newValue&&(s=this.Ku(n.newValue)))return[2,this.Gu(s)]}else n.key===this.qu&&(u=function(t){var e=Xn.Es;if(null!=t)try{var n=JSON.parse(t);m("number"==typeof n),e=n}catch(t){d("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Xn.Es&&this.fs(u)}else this.Mu.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"nc",{get:function(){return this.Ou.get(this.ku)},enumerable:!1,configurable:!0}),t.prototype.ju=function(){this.setItem(this.Lu,this.nc.Cu())},t.prototype.Xu=function(t,e,n){var r=new Qi(this.currentUser,t,e,n),i=Yi(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Cu())},t.prototype.tc=function(t){var e=Yi(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.cc=function(t){var e={clientId:this.ku,onlineState:t};this.storage.setItem(this.Wu,JSON.stringify(e))},t.prototype.hc=function(t,e,n){var r=Xi(this.persistenceKey,t),i=new Zi(t,e,n);this.setItem(r,i.Cu())},t.prototype.lc=function(t){var e=this.Bu.exec(t);return e?e[1]:null},t.prototype.fc=function(t,e){var n=this.lc(t);return Ji.Du(n,e)},t.prototype.dc=function(t,e){var n=this.Uu.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Qi.Du(new Ci(i),r,e)},t.prototype.Tc=function(t,e){var n=this.Qu.exec(t),r=Number(n[1]);return Zi.Du(r,e)},t.prototype.Ku=function(t){return $i.Du(t)},t.prototype.wc=function(t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.fu.Ic(t.batchId,t.state,t.error)]:(p("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.Ec=function(t){return this.fu.mc(t.targetId,t.state,t.error)},t.prototype._c=function(t,e){var n=this,r=e?this.Ou.st(t,e):this.Ou.remove(t),i=this.Hu(this.Ou),o=this.Hu(r),s=[],u=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||u.push(t)})),this.fu.Ac(s,u).then((function(){n.Ou=r}))},t.prototype.Gu=function(t){this.Ou.get(t.clientId)&&this.Da(t.onlineState)},t.prototype.Hu=function(t){var e=vt();return t.forEach((function(t,n){e=e.Nt(n.activeTargetIds)})),e},t}(),no=function(){function t(){this.Rc=new to,this.Pc={},this.Da=null,this.fs=null}return t.prototype.Ju=function(t){},t.prototype.Zu=function(t,e,n){},t.prototype.ec=function(t){return this.Rc.Nu(t),this.Pc[t]||"not-current"},t.prototype.oc=function(t,e,n){this.Pc[t]=e},t.prototype.sc=function(t){this.Rc.Fu(t)},t.prototype.ic=function(t){return this.Rc.activeTargetIds.has(t)},t.prototype.rc=function(t){delete this.Pc[t]},t.prototype.zu=function(){return this.Rc.activeTargetIds},t.prototype.Yu=function(t){return this.Rc.activeTargetIds.has(t)},t.prototype.start=function(){return this.Rc=new to,Promise.resolve()},t.prototype.ac=function(t,e,n){},t.prototype.uc=function(t){},t.prototype.th=function(){},t.prototype.Ts=function(t){},t}(),ro=function(t){this.key=t},io=function(t){this.key=t},oo=function(){function t(t,e){this.query=t,this.gc=e,this.Vc=null,this.Yt=!1,this.yc=pt(),this.qt=pt(),this.pc=Tn(t),this.bc=new yt(this.pc)}return Object.defineProperty(t.prototype,"vc",{get:function(){return this.gc},enumerable:!1,configurable:!0}),t.prototype.Sc=function(t,e){var n=this,r=e?e.Dc:new gt,i=e?e.bc:this.bc,o=e?e.qt:this.qt,s=i,u=!1,a=this.query.an()&&i.size===this.query.limit?i.last():null,c=this.query.un()&&i.size===this.query.limit?i.first():null;if(t.ht((function(t,e){var h=i.get(t),f=e instanceof un?e:null;f&&(f=In(n.query,f)?f:null);var l=!!h&&n.qt.has(h.key),p=!!f&&(f.Ge||n.qt.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.Cc(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.pc(f,a)>0||c&&n.pc(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),this.query.an()||this.query.un())for(;s.size>this.query.limit;){var h=this.query.an()?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{bc:s,Dc:r,Nc:u,qt:o}},t.prototype.Cc=function(t,e){return t.Ge&&e.hasCommittedMutations&&!e.Ge},t.prototype.Un=function(t,e,n){var r=this,i=this.bc;this.bc=t.bc,this.qt=t.qt;var o=t.Dc.Mt();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return g()}};return n(t)-n(e)}(t.type,e.type)||r.pc(t.doc,e.doc)})),this.Fc(n);var s=e?this.kc():[],u=0===this.yc.size&&this.Yt?1:0,a=u!==this.Vc;return this.Vc=u,0!==o.length||a?{snapshot:new mt(this.query,t.bc,i,o,t.qt,0===u,a,!1),$c:s}:{$c:s}},t.prototype.xc=function(t){return this.Yt&&"Offline"===t?(this.Yt=!1,this.Un({bc:this.bc,Dc:new gt,qt:this.qt,Nc:!1},!1)):{$c:[]}},t.prototype.Oc=function(t){return!this.gc.has(t)&&!!this.bc.has(t)&&!this.bc.get(t).Ge},t.prototype.Fc=function(t){var e=this;t&&(t.Jt.forEach((function(t){return e.gc=e.gc.add(t)})),t.Xt.forEach((function(t){})),t.Zt.forEach((function(t){return e.gc=e.gc.delete(t)})),this.Yt=t.Yt)},t.prototype.kc=function(){var t=this;if(!this.Yt)return[];var e=this.yc;this.yc=pt(),this.bc.forEach((function(e){t.Oc(e.key)&&(t.yc=t.yc.add(e.key))}));var n=[];return e.forEach((function(e){t.yc.has(e)||n.push(new io(e))})),this.yc.forEach((function(t){e.has(t)||n.push(new ro(t))})),n},t.prototype.Mc=function(t){this.gc=t.gh,this.yc=pt();var e=this.Sc(t.documents);return this.Un(e,!0)},t.prototype.Lc=function(){return mt.Qt(this.query,this.bc,this.qt,0===this.Vc)},t}(),so=function(t,e,n){this.query=t,this.targetId=e,this.view=n},uo=function(t){this.key=t,this.qc=!1},ao=function(){function t(t,e,n,r,i,o){this.La=t,this.Bc=e,this.qa=n,this.Uc=r,this.currentUser=i,this.Qc=o,this.Wc=null,this.jc=new D((function(t){return _n(t)}),bn),this.Kc=new Map,this.Gc=[],this.zc=new et(F.P),this.Hc=new Map,this.Yc=new Oi,this.Jc={},this.Xc=new Map,this.Zc=hi.eo(),this.onlineState="Unknown",this.tl=void 0}return Object.defineProperty(t.prototype,"el",{get:function(){return!0===this.tl},enumerable:!1,configurable:!0}),t.prototype.subscribe=function(t){this.Wc=t},t.prototype.listen=function(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n,i,o,s;return r.__generator(this,(function(r){switch(r.label){case 0:return this.nl("listen()"),(i=this.jc.get(t))?(e=i.targetId,this.Uc.ec(e),n=i.view.Lc(),[3,4]):[3,1];case 1:return[4,Pi(this.La,yn(t))];case 2:return o=r.sent(),s=this.Uc.ec(o.targetId),e=o.targetId,[4,this.sl(t,e,"current"===s)];case 3:n=r.sent(),this.el&&this.Bc.listen(o),r.label=4;case 4:return[2,n]}}))}))},t.prototype.sl=function(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s,u,a,c;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,Di(this.La,t,!0)];case 1:return i=r.sent(),o=new oo(t,i.gh),s=o.Sc(i.documents),u=bt.Ht(e,n&&"Offline"!==this.onlineState),a=o.Un(s,this.el,u),this.il(e,a.$c),c=new so(t,e,o),[2,(this.jc.set(t,c),this.Kc.has(e)?this.Kc.get(e).push(t):this.Kc.set(e,[t]),a.snapshot)]}}))}))},t.prototype.lu=function(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n,i=this;return r.__generator(this,(function(r){switch(r.label){case 0:return this.nl("unlisten()"),e=this.jc.get(t),(n=this.Kc.get(e.targetId)).length>1?[2,(this.Kc.set(e.targetId,n.filter((function(e){return!bn(e,t)}))),void this.jc.delete(t))]:this.el?(this.Uc.sc(e.targetId),this.Uc.Yu(e.targetId)?[3,2]:[4,xi(this.La,e.targetId,!1).then((function(){i.Uc.rc(e.targetId),i.Bc.lu(e.targetId),i.rl(e.targetId)})).catch(ki)]):[3,3];case 1:r.sent(),r.label=2;case 2:return[3,5];case 3:return this.rl(e.targetId),[4,xi(this.La,e.targetId,!0)];case 4:r.sent(),r.label=5;case 5:return[2]}}))}))},t.prototype.write=function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o;return r.__generator(this,(function(r){switch(r.label){case 0:this.nl("write()"),r.label=1;case 1:return r.trys.push([1,5,,6]),[4,function(t,e){var n,r=w(t),i=O.now(),o=e.reduce((function(t,e){return t.add(e.key)}),pt());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Rh.Zn(t,o).next((function(o){n=o;for(var s=[],u=0,a=e;u<a.length;u++){var c=a[u],h=He(c,n.get(c.key));null!=h&&s.push(new Xe(c.key,h,on(h.proto.mapValue),qe.exists(!0)))}return r.Gn.mr(t,i,s,e)}))})).then((function(t){var e=t.An(n);return{batchId:t.batchId,Fn:e}}))}(this.La,t)];case 2:return n=r.sent(),this.Uc.Ju(n.batchId),this.ol(n.batchId,e),[4,this.hl(n.Fn)];case 3:return r.sent(),[4,this.Bc.hu()];case 4:return r.sent(),[3,6];case 5:return i=r.sent(),o=fr(i,"Failed to persist write"),e.reject(o),[3,6];case 6:return[2]}}))}))},t.prototype.Iu=function(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n=this;return r.__generator(this,(function(r){switch(r.label){case 0:this.nl("applyRemoteEvent()"),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,Ni(this.La,t)];case 2:return e=r.sent(),t.Wt.forEach((function(t,e){var r=n.Hc.get(e);r&&(m(t.Jt.size+t.Xt.size+t.Zt.size<=1),t.Jt.size>0?r.qc=!0:t.Xt.size>0?m(r.qc):t.Zt.size>0&&(m(r.qc),r.qc=!1))})),[4,this.hl(e,t)];case 3:return r.sent(),[3,6];case 4:return[4,ki(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.xc=function(t,e){if(this.el&&0===e||!this.el&&1===e){this.nl("applyOnlineStateChange()");var n=[];this.jc.forEach((function(e,r){var i=r.view.xc(t);i.snapshot&&n.push(i.snapshot)})),this.Wc.al(t),this.Wc.Ea(n),this.onlineState=t,this.el&&this.Uc.uc(t)}},t.prototype.mu=function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s,u,a=this;return r.__generator(this,(function(r){switch(r.label){case 0:return this.nl("rejectListens()"),this.Uc.oc(t,"rejected",e),n=this.Hc.get(t),(i=n&&n.key)?(o=(o=new et(F.P)).st(i,new an(i,L.min())),s=pt().add(i),u=new wt(L.min(),new Map,new it(E),o,s),[4,this.Iu(u)]):[3,2];case 1:return r.sent(),this.zc=this.zc.remove(i),this.Hc.delete(t),this.ul(),[3,4];case 2:return[4,xi(this.La,t,!1).then((function(){return a.rl(t,e)})).catch(ki)];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))},t.prototype.yu=function(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n;return r.__generator(this,(function(r){switch(r.label){case 0:this.nl("applySuccessfulWrite()"),e=t.batch.batchId,r.label=1;case 1:return r.trys.push([1,4,,6]),[4,Ti(this.La,t)];case 2:return n=r.sent(),this.cl(e,null),this.ll(e),this.Uc.Zu(e,"acknowledged"),[4,this.hl(n)];case 3:return r.sent(),[3,6];case 4:return[4,ki(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.bu=function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n;return r.__generator(this,(function(r){switch(r.label){case 0:this.nl("rejectFailedWrite()"),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,function(t,e){var n=w(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n.Gn.Rr(t,e).next((function(e){return m(null!==e),r=e.keys(),n.Gn.br(t,e)})).next((function(){return n.Gn.Cr(t)})).next((function(){return n.Rh.Zn(t,r)}))}))}(this.La,t)];case 2:return n=r.sent(),this.cl(t,e),this.ll(t),this.Uc.Zu(t,"rejected",e),[4,this.hl(n)];case 3:return r.sent(),[3,6];case 4:return[4,ki(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype._l=function(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n,i,o;return r.__generator(this,(function(r){switch(r.label){case 0:this.Bc.Ga()||p("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,function(t){var e=w(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e.Gn.Vr(t)}))}(this.La)];case 2:return-1===(e=r.sent())?[2,void t.resolve()]:((n=this.Xc.get(e)||[]).push(t),this.Xc.set(e,n),[3,4]);case 3:return i=r.sent(),o=fr(i,"Initialization of waitForPendingWrites() operation failed"),t.reject(o),[3,4];case 4:return[2]}}))}))},t.prototype.ll=function(t){(this.Xc.get(t)||[]).forEach((function(t){t.resolve()})),this.Xc.delete(t)},t.prototype.fl=function(t){this.Xc.forEach((function(e){e.forEach((function(e){e.reject(new k(R.CANCELLED,t))}))})),this.Xc.clear()},t.prototype.ol=function(t,e){var n=this.Jc[this.currentUser.$h()];n||(n=new et(E)),n=n.st(t,e),this.Jc[this.currentUser.$h()]=n},t.prototype.cl=function(t,e){var n=this.Jc[this.currentUser.$h()];if(n){var r=n.get(t);r&&(e?r.reject(e):r.resolve(),n=n.remove(t)),this.Jc[this.currentUser.$h()]=n}},t.prototype.rl=function(t,e){var n=this;void 0===e&&(e=null),this.Uc.sc(t);for(var r=0,i=this.Kc.get(t);r<i.length;r++){var o=i[r];this.jc.delete(o),e&&this.Wc.dl(o,e)}this.Kc.delete(t),this.el&&this.Yc.Ch(t).forEach((function(t){n.Yc.Nr(t)||n.wl(t)}))},t.prototype.wl=function(t){var e=this.zc.get(t);null!==e&&(this.Bc.lu(e),this.zc=this.zc.remove(t),this.Hc.delete(e),this.ul())},t.prototype.il=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof ro?(this.Yc.Eo(i.key,t),this.Tl(i)):i instanceof io?(p("SyncEngine","Document no longer in limbo: "+i.key),this.Yc.mo(i.key,t),this.Yc.Nr(i.key)||this.wl(i.key)):g()}},t.prototype.Tl=function(t){var e=t.key;this.zc.get(e)||(p("SyncEngine","New document in limbo: "+e),this.Gc.push(e),this.ul())},t.prototype.ul=function(){for(;this.Gc.length>0&&this.zc.size<this.Qc;){var t=this.Gc.shift(),e=this.Zc.next();this.Hc.set(e,new uo(t)),this.zc=this.zc.st(t,e),this.Bc.listen(new Z(yn(pn(t.path)),e,2,Xn.Es))}},t.prototype.El=function(){return this.zc},t.prototype.Il=function(){return this.Gc},t.prototype.hl=function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s=this;return r.__generator(this,(function(u){switch(u.label){case 0:return n=[],i=[],o=[],this.jc.forEach((function(r,u){o.push(Promise.resolve().then((function(){var e=u.view.Sc(t);return e.Nc?Di(s.La,u.query,!1).then((function(t){var n=t.documents;return u.view.Sc(n,e)})):e})).then((function(t){var r=e&&e.Wt.get(u.targetId),o=u.view.Un(t,s.el,r);if(s.il(u.targetId,o.$c),o.snapshot){s.el&&s.Uc.oc(u.targetId,o.snapshot.fromCache?"not-current":"current"),n.push(o.snapshot);var a=Yn._s(u.targetId,o.snapshot);i.push(a)}})))})),[4,Promise.all(o)];case 1:return u.sent(),this.Wc.Ea(n),[4,function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s,u,a,c,h,f;return r.__generator(this,(function(r){switch(r.label){case 0:n=w(t),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return Bn.forEach(e,(function(e){return Bn.forEach(e.cs,(function(r){return n.persistence.dr.Eo(t,e.targetId,r)})).next((function(){return Bn.forEach(e.ls,(function(r){return n.persistence.dr.mo(t,e.targetId,r)}))}))}))}))];case 2:return r.sent(),[3,4];case 3:if(!er(i=r.sent()))throw i;return p("LocalStore","Failed to update sequence numbers: "+i),[3,4];case 4:for(o=0,s=e;o<s.length;o++)u=s[o],a=u.targetId,u.fromCache||(c=n.Eh.get(a),h=c.Z,f=c.nt(h),n.Eh=n.Eh.st(a,f));return[2]}}))}))}(this.La,i)];case 2:return u.sent(),[2]}}))}))},t.prototype.nl=function(t){},t.prototype.vu=function(t){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(n){switch(n.label){case 0:return this.currentUser.isEqual(t)?[3,3]:(p("SyncEngine","User change. New user:",t.$h()),[4,function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s;return r.__generator(this,(function(r){switch(r.label){case 0:return n=w(t),i=n.Gn,o=n.Rh,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var r;return n.Gn.yr(t).next((function(s){return r=s,i=n.persistence.oh(e),o=new Kn(n.Ah,i,n.persistence.uh()),i.yr(t)})).next((function(e){for(var n=[],i=[],s=pt(),u=0,a=r;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++){var l=f[h];s=s.add(l.key)}}for(var p=0,d=e;p<d.length;p++){var v=d[p];i.push(v.batchId);for(var y=0,g=v.mutations;y<g.length;y++){var m=g[y];s=s.add(m.key)}}return o.Zn(t,s).next((function(t){return{ml:t,Al:n,Rl:i}}))}))}))];case 1:return s=r.sent(),[2,(n.Gn=i,n.Rh=o,n.Th.Ph(n.Rh),s)]}}))}))}(this.La,t)]);case 1:return e=n.sent(),this.currentUser=t,this.fl("'waitForPendingWrites' promise is rejected due to a user change."),this.Uc.ac(t,e.Al,e.Rl),[4,this.hl(e.ml)];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},t.prototype.Oe=function(t){var e=this.Hc.get(t);if(e&&e.qc)return pt().add(e.key);var n=pt(),r=this.Kc.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++){var s=o[i],u=this.jc.get(s);n=n.Nt(u.view.vc)}return n},t}();function co(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,Di((n=w(t)).La,e.query,!0)];case 1:return i=r.sent(),o=e.view.Mc(i),[2,(n.el&&n.il(e.targetId,o.$c),o)]}}))}))}function ho(t,e,n,i){return r.__awaiter(this,void 0,void 0,(function(){var o,s;return r.__generator(this,(function(r){switch(r.label){case 0:return(o=w(t)).nl("applyBatchState()"),[4,function(t,e){var n=w(t),r=w(n.Gn);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.Pr(t,e).next((function(e){return e?n.Rh.Zn(t,e):Bn.resolve(null)}))}))}(o.La,e)];case 1:return null===(s=r.sent())?[3,6]:"pending"!==n?[3,3]:[4,o.Bc.hu()];case 2:return r.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(o.cl(e,i||null),function(t,e){w(w(t).Gn).Sr(e)}(o.La,e)):g(),r.label=4;case 4:return[4,o.hl(s)];case 5:return r.sent(),[3,7];case 6:p("SyncEngine","Cannot apply mutation batch with id: "+e),r.label=7;case 7:return[2]}}))}))}function fo(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s,u,a,c,h;return r.__generator(this,(function(r){switch(r.label){case 0:return n=w(t),!0!==e||!0===n.tl?[3,3]:(i=n.Uc.zu(),[4,lo(n,i.N())]);case 1:return o=r.sent(),n.tl=!0,[4,n.Bc.Su(!0)];case 2:for(r.sent(),s=0,u=o;s<u.length;s++)a=u[s],n.Bc.listen(a);return[3,7];case 3:return!1!==e||!1===n.tl?[3,7]:(c=[],h=Promise.resolve(),n.Kc.forEach((function(t,e){n.Uc.ic(e)?c.push(e):h=h.then((function(){return n.rl(e),xi(n.La,e,!0)})),n.Bc.lu(e)})),[4,h]);case 4:return r.sent(),[4,lo(n,c)];case 5:return r.sent(),function(t){var e=w(t);e.Hc.forEach((function(t,n){e.Bc.lu(n)})),e.Yc.Nh(),e.Hc=new Map,e.zc=new et(F.P)}(n),n.tl=!1,[4,n.Bc.Su(!1)];case 6:r.sent(),r.label=7;case 7:return[2]}}))}))}function lo(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s,u,a,c,h,f,l,p,d,v,y;return r.__generator(this,(function(r){switch(r.label){case 0:n=w(t),i=[],o=[],s=0,u=e,r.label=1;case 1:return s<u.length?(a=u[s],c=void 0,(h=n.Kc.get(a))&&0!==h.length?[4,Pi(n.La,yn(h[0]))]:[3,7]):[3,13];case 2:c=r.sent(),f=0,l=h,r.label=3;case 3:return f<l.length?(p=l[f],d=n.jc.get(p),[4,co(n,d)]):[3,6];case 4:(v=r.sent()).snapshot&&o.push(v.snapshot),r.label=5;case 5:return f++,[3,3];case 6:return[3,11];case 7:return[4,Ri(n.La,a)];case 8:return y=r.sent(),[4,Pi(n.La,y)];case 9:return c=r.sent(),[4,n.sl(po(y),a,!1)];case 10:r.sent(),r.label=11;case 11:i.push(c),r.label=12;case 12:return s++,[3,1];case 13:return[2,(n.Wc.Ea(o),i)]}}))}))}function po(t){return ln(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function vo(t){var e=w(t);return w(w(e.La).persistence).rh()}function yo(t,e,n,i){return r.__awaiter(this,void 0,void 0,(function(){var o,s,u;return r.__generator(this,(function(r){switch(r.label){case 0:return(o=w(t)).tl?(p("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!o.Kc.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,function(t){var e=w(t),n=w(e.Ah);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return n.Ur(t,e.mh)})).then((function(t){var n=t.Qr,r=t.readTime;return e.mh=r,n}))}(o.La)];case 3:return s=r.sent(),u=wt.zt(e,"current"===n),[4,o.hl(s,u)];case 4:return r.sent(),[3,8];case 5:return[4,xi(o.La,e,!0)];case 6:return r.sent(),o.rl(e,i),[3,8];case 7:g(),r.label=8;case 8:return[2]}}))}))}function go(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s,u,a,c,h,f,l,d;return r.__generator(this,(function(v){switch(v.label){case 0:if(!(i=w(t)).tl)return[3,10];o=0,s=e,v.label=1;case 1:return o<s.length?(u=s[o],i.Kc.has(u)?(p("SyncEngine","Adding an already active target "+u),[3,5]):[4,Ri(i.La,u)]):[3,6];case 2:return a=v.sent(),[4,Pi(i.La,a)];case 3:return c=v.sent(),[4,i.sl(po(a),c.targetId,!1)];case 4:v.sent(),i.Bc.listen(c),v.label=5;case 5:return o++,[3,1];case 6:h=function(t){return r.__generator(this,(function(e){switch(e.label){case 0:return i.Kc.has(t)?[4,xi(i.La,t,!1).then((function(){i.Bc.lu(t),i.rl(t)})).catch(ki)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},f=0,l=n,v.label=7;case 7:return f<l.length?(d=l[f],[5,h(d)]):[3,10];case 8:v.sent(),v.label=9;case 9:return f++,[3,7];case 10:return[2]}}))}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mo=function(){this.Pl=void 0,this.listeners=[]},wo=function(){function t(t){this.fu=t,this.gl=new D((function(t){return _n(t)}),bn),this.onlineState="Unknown",this.Vl=new Set,this.fu.subscribe(this)}return t.prototype.listen=function(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n,i,o,s,u;return r.__generator(this,(function(r){switch(r.label){case 0:if(e=t.query,n=!1,(i=this.gl.get(e))||(n=!0,i=new mo),!n)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),o=i,[4,this.fu.listen(e)];case 2:return o.Pl=r.sent(),[3,4];case 3:return s=r.sent(),u=fr(s,"Initialization of query '"+En(t.query)+"' failed"),[2,void t.onError(u)];case 4:return this.gl.set(e,i),i.listeners.push(t),t.xc(this.onlineState),i.Pl&&t.yl(i.Pl)&&this.pl(),[2]}}))}))},t.prototype.lu=function(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n,i,o;return r.__generator(this,(function(r){return e=t.query,n=!1,(i=this.gl.get(e))&&(o=i.listeners.indexOf(t))>=0&&(i.listeners.splice(o,1),n=0===i.listeners.length),n?[2,(this.gl.delete(e),this.fu.lu(e))]:[2]}))}))},t.prototype.Ea=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.gl.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].yl(i)&&(e=!0);s.Pl=i}}e&&this.pl()},t.prototype.dl=function(t,e){var n=this.gl.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.gl.delete(t)},t.prototype.al=function(t){this.onlineState=t;var e=!1;this.gl.forEach((function(n,r){for(var i=0,o=r.listeners;i<o.length;i++)o[i].xc(t)&&(e=!0)})),e&&this.pl()},t.prototype.bl=function(t){this.Vl.add(t),t.next()},t.prototype.vl=function(t){this.Vl.delete(t)},t.prototype.pl=function(){this.Vl.forEach((function(t){t.next()}))},t}(),bo=function(){function t(t,e,n){this.query=t,this.Sl=e,this.Dl=!1,this.Cl=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.yl=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new mt(t.query,t.docs,t.Lt,e,t.qt,t.fromCache,t.Bt,!0)}var o=!1;return this.Dl?this.Nl(t)&&(this.Sl.next(t),o=!0):this.Fl(t,this.onlineState)&&(this.kl(t),o=!0),this.Cl=t,o},t.prototype.onError=function(t){this.Sl.error(t)},t.prototype.xc=function(t){this.onlineState=t;var e=!1;return this.Cl&&!this.Dl&&this.Fl(this.Cl,t)&&(this.kl(this.Cl),e=!0),e},t.prototype.Fl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.$l&&n||t.docs._()&&"Offline"!==e)},t.prototype.Nl=function(t){if(t.docChanges.length>0)return!0;var e=this.Cl&&this.Cl.hasPendingWrites!==t.hasPendingWrites;return!(!t.Bt&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.kl=function(t){t=mt.Qt(t.query,t.docs,t.qt,t.fromCache),this.Dl=!0,this.Sl.next(t)},t}(),_o=function(){function t(){}return t.prototype.Ph=function(t){this.xl=t},t.prototype.ns=function(t,e,n,r){var i=this;return e.hn()||n.isEqual(L.min())?this.Ol(t,e):this.xl.Zn(t,r).next((function(s){var u=i.Ml(e,s);return(e.an()||e.un())&&i.Nc(e.nn,u,r,n)?i.Ol(t,e):(l()<=o.LogLevel.DEBUG&&p("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),En(e)),i.xl.ns(t,e,n).next((function(t){return u.forEach((function(e){t=t.st(e.key,e)})),t})))}))},t.prototype.Ml=function(t,e){var n=new it(Tn(t));return e.forEach((function(e,r){r instanceof un&&In(t,r)&&(n=n.add(r))})),n},t.prototype.Nc=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.o(r)>0)},t.prototype.Ol=function(t,e){return l()<=o.LogLevel.DEBUG&&p("IndexFreeQueryEngine","Using full collection scan to execute query:",En(e)),this.xl.ns(t,e,L.min())},t}(),Eo=function(){function t(t,e){this.zn=t,this.dr=e,this.Gn=[],this.Ll=1,this.ql=new it(Li.yh)}return t.prototype.Ir=function(t){return Bn.resolve(0===this.Gn.length)},t.prototype.mr=function(t,e,n,r){var i=this.Ll;this.Ll++,this.Gn.length>0&&this.Gn[this.Gn.length-1];var o=new jn(i,e,n,r);this.Gn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.ql=this.ql.add(new Li(a.key,i)),this.zn.Ar(t,a.key.path.p())}return Bn.resolve(o)},t.prototype.Rr=function(t,e){return Bn.resolve(this.Bl(e))},t.prototype.gr=function(t,e){var n=e+1,r=this.Ul(n),i=r<0?0:r;return Bn.resolve(this.Gn.length>i?this.Gn[i]:null)},t.prototype.Vr=function(){return Bn.resolve(0===this.Gn.length?-1:this.Ll-1)},t.prototype.yr=function(t){return Bn.resolve(this.Gn.slice())},t.prototype.Yn=function(t,e){var n=this,r=new Li(e,0),i=new Li(e,Number.POSITIVE_INFINITY),o=[];return this.ql.St([r,i],(function(t){var e=n.Bl(t.kh);o.push(e)})),Bn.resolve(o)},t.prototype.es=function(t,e){var n=this,r=new it(E);return e.forEach((function(t){var e=new Li(t,0),i=new Li(t,Number.POSITIVE_INFINITY);n.ql.St([e,i],(function(t){r=r.add(t.kh)}))})),Bn.resolve(this.Ql(r))},t.prototype.as=function(t,e){var n=e.path,r=n.length+1,i=n;F.j(i)||(i=i.child(""));var o=new Li(new F(i),0),s=new it(E);return this.ql.Dt((function(t){var e=t.key.path;return!!n.D(e)&&(e.length===r&&(s=s.add(t.kh)),!0)}),o),Bn.resolve(this.Ql(s))},t.prototype.Ql=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.Bl(t);null!==r&&n.push(r)})),n},t.prototype.br=function(t,e){var n=this;m(0===this.Wl(e.batchId,"removed")),this.Gn.shift();var r=this.ql;return Bn.forEach(e.mutations,(function(i){var o=new Li(i.key,e.batchId);return r=r.delete(o),n.dr.Dr(t,i.key)})).next((function(){n.ql=r}))},t.prototype.Sr=function(t){},t.prototype.Nr=function(t,e){var n=new Li(e,0),r=this.ql.Ct(n);return Bn.resolve(e.isEqual(r&&r.key))},t.prototype.Cr=function(t){return this.Gn.length,Bn.resolve()},t.prototype.Wl=function(t,e){return this.Ul(t)},t.prototype.Ul=function(t){return 0===this.Gn.length?0:t-this.Gn[0].batchId},t.prototype.Bl=function(t){var e=this.Ul(t);return e<0||e>=this.Gn.length?null:this.Gn[e]},t}(),Io=function(){function t(t,e){this.zn=t,this.jl=e,this.docs=new et(F.P),this.size=0}return t.prototype.xn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.jl(e);return this.docs=this.docs.st(r,{Or:e,size:s,readTime:n}),this.size+=s-o,this.zn.Ar(t,r.path.p())},t.prototype.Mn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Ln=function(t,e){var n=this.docs.get(e);return Bn.resolve(n?n.Or:null)},t.prototype.getEntries=function(t,e){var n=this,r=at();return e.forEach((function(t){var e=n.docs.get(t);r=r.st(t,e?e.Or:null)})),Bn.resolve(r)},t.prototype.ns=function(t,e,n){for(var r=ht(),i=new F(e.path.child("")),o=this.docs.ct(i);o.Tt();){var s=o.wt(),u=s.key,a=s.value,c=a.Or,h=a.readTime;if(!e.path.D(u.path))break;h.o(n)<=0||c instanceof un&&In(e,c)&&(r=r.st(c.key,c))}return Bn.resolve(r)},t.prototype.Kl=function(t,e){return Bn.forEach(this.docs,(function(t){return e(t)}))},t.prototype.jr=function(e){return new t.Kr(this)},t.prototype.zr=function(t){return Bn.resolve(this.size)},t}();Io.Kr=function(t){function e(e){var n=this;return(n=t.call(this)||this).Hr=e,n}return r.__extends(e,t),e.prototype.Un=function(t){var e=this,n=[];return this.Fn.forEach((function(r,i){i?n.push(e.Hr.xn(t,i,e.readTime)):e.Hr.Mn(r)})),Bn.Cn(n)},e.prototype.qn=function(t,e){return this.Hr.Ln(t,e)},e.prototype.Bn=function(t,e){return this.Hr.getEntries(t,e)},e}(zn);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var To=function(){function t(t){this.persistence=t,this.Gl=new D((function(t){return H(t)}),W),this.lastRemoteSnapshotVersion=L.min(),this.highestTargetId=0,this.zl=0,this.Hl=new Oi,this.targetCount=0,this.Yl=hi.to()}return t.prototype.be=function(t,e){return this.Gl.forEach((function(t,n){return e(n)})),Bn.resolve()},t.prototype.ro=function(t){return Bn.resolve(this.lastRemoteSnapshotVersion)},t.prototype.oo=function(t){return Bn.resolve(this.zl)},t.prototype.no=function(t){return this.highestTargetId=this.Yl.next(),Bn.resolve(this.highestTargetId)},t.prototype.ho=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.zl&&(this.zl=e),Bn.resolve()},t.prototype.uo=function(t){this.Gl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yl=new hi(e),this.highestTargetId=e),t.sequenceNumber>this.zl&&(this.zl=t.sequenceNumber)},t.prototype.ao=function(t,e){return this.uo(e),this.targetCount+=1,Bn.resolve()},t.prototype.lo=function(t,e){return this.uo(e),Bn.resolve()},t.prototype._o=function(t,e){return this.Gl.delete(e.target),this.Hl.Ch(e.targetId),this.targetCount-=1,Bn.resolve()},t.prototype.hr=function(t,e,n){var r=this,i=0,o=[];return this.Gl.forEach((function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.Gl.delete(s),o.push(r.fo(t,u.targetId)),i++)})),Bn.Cn(o).next((function(){return i}))},t.prototype.do=function(t){return Bn.resolve(this.targetCount)},t.prototype.wo=function(t,e){var n=this.Gl.get(e)||null;return Bn.resolve(n)},t.prototype.To=function(t,e,n){return this.Hl.vh(e,n),Bn.resolve()},t.prototype.Io=function(t,e,n){this.Hl.Dh(e,n);var r=this.persistence.dr,i=[];return r&&e.forEach((function(e){i.push(r.Dr(t,e))})),Bn.Cn(i)},t.prototype.fo=function(t,e){return this.Hl.Ch(e),Bn.resolve()},t.prototype.Ao=function(t,e){var n=this.Hl.Fh(e);return Bn.resolve(n)},t.prototype.Nr=function(t,e){return Bn.resolve(this.Hl.Nr(e))},t}(),Ao=function(){function t(t){var e=this;this.Jl={},this.yo=new Xn(0),this.po=!1,this.po=!0,this.dr=t(this),this.ko=new To(this),this.zn=new Br,this.Kn=new Io(this.zn,(function(t){return e.dr.Xl(t)}))}return t.prototype.start=function(){return Promise.resolve()},t.prototype.th=function(){return this.po=!1,Promise.resolve()},Object.defineProperty(t.prototype,"tr",{get:function(){return this.po},enumerable:!1,configurable:!0}),t.prototype.Bo=function(){},t.prototype.Uo=function(){},t.prototype.uh=function(){return this.zn},t.prototype.oh=function(t){var e=this.Jl[t.$h()];return e||(e=new Eo(this.zn,this.dr),this.Jl[t.$h()]=e),e},t.prototype.hh=function(){return this.ko},t.prototype.ah=function(){return this.Kn},t.prototype.runTransaction=function(t,e,n){var r=this;p("MemoryPersistence","Starting transaction:",t);var i=new No(this.yo.next());return this.dr.Zl(),n(i).next((function(t){return r.dr.t_(i).next((function(){return t}))})).Sn().then((function(t){return i.jn(),t}))},t.prototype.e_=function(t,e){return Bn.Nn(Object.values(this.Jl).map((function(n){return function(){return n.Nr(t,e)}})))},t}(),No=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ro=e,n}return r.__extends(e,t),e}(Wn),So=function(){function t(t){this.persistence=t,this.n_=new Oi,this.s_=null}return t.i_=function(e){return new t(e)},Object.defineProperty(t.prototype,"r_",{get:function(){if(this.s_)return this.s_;throw g()},enumerable:!1,configurable:!0}),t.prototype.Eo=function(t,e,n){return this.n_.Eo(n,e),this.r_.delete(n.toString()),Bn.resolve()},t.prototype.mo=function(t,e,n){return this.n_.mo(n,e),this.r_.add(n.toString()),Bn.resolve()},t.prototype.Dr=function(t,e){return this.r_.add(e.toString()),Bn.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.n_.Ch(e.targetId).forEach((function(t){return n.r_.add(t.toString())}));var r=this.persistence.hh();return r.Ao(t,e.targetId).next((function(t){t.forEach((function(t){return n.r_.add(t.toString())}))})).next((function(){return r._o(t,e)}))},t.prototype.Zl=function(){this.s_=new Set},t.prototype.t_=function(t){var e=this,n=this.persistence.ah().jr();return Bn.forEach(this.r_,(function(r){var i=F.B(r);return e.o_(t,i).next((function(t){t||n.Mn(i)}))})).next((function(){return e.s_=null,n.apply(t)}))},t.prototype.wh=function(t,e){var n=this;return this.o_(t,e).next((function(t){t?n.r_.delete(e.toString()):n.r_.add(e.toString())}))},t.prototype.Xl=function(t){return 0},t.prototype.o_=function(t,e){var n=this;return Bn.Nn([function(){return Bn.resolve(n.n_.Nr(e))},function(){return n.persistence.hh().Nr(t,e)},function(){return n.persistence.e_(t,e)}])},t}(),Po=function(){function t(t){this.h_=t.h_,this.a_=t.a_}return t.prototype.wa=function(t){this.u_=t},t.prototype.ca=function(t){this.c_=t},t.prototype.onMessage=function(t){this.l_=t},t.prototype.close=function(){this.a_()},t.prototype.send=function(t){this.h_(t)},t.prototype.__=function(){this.u_()},t.prototype.f_=function(t){this.c_(t)},t.prototype.d_=function(t){this.l_(t)},t}(),xo={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Do=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n}return r.__extends(e,t),e.prototype.A_=function(t,e,n,r){return new Promise((function(i,o){var s=new u.XhrIo;s.listenOnce(u.EventType.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case u.ErrorCode.NO_ERROR:var e=s.getResponseJson();p("Connection","XHR received:",JSON.stringify(e)),i(e);break;case u.ErrorCode.TIMEOUT:p("Connection",'RPC "'+t+'" timed out'),o(new k(R.DEADLINE_EXCEEDED,"Request time out"));break;case u.ErrorCode.HTTP_ERROR:var n=s.getStatus();if(p("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace("_","-");return Object.values(R).indexOf(e)>=0?e:R.UNKNOWN}(r.status);o(new k(a,r.message))}else o(new k(R.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new k(R.UNAVAILABLE,"Connection failed."));break;default:g()}}finally{p("Connection",'RPC "'+t+'" completed.')}}));var a=JSON.stringify(r);s.send(e,"POST",a,n,15)}))},e.prototype.Ta=function(t,e){var n=[this.T_,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=u.createWebChannelTransport(),i={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.m_(i.initMessageHeaders,e),s.isMobileCordova()||s.isReactNative()||s.isElectron()||s.isIE()||s.isUWP()||s.isBrowserExtension()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");p("Connection","Creating WebChannel: "+o,i);var a=r.createWebChannel(o,i),c=!1,h=!1,f=new Po({h_:function(t){h?p("Connection","Not sending because WebChannel is closed:",t):(c||(p("Connection","Opening WebChannel transport."),a.open(),c=!0),p("Connection","WebChannel sending:",t),a.send(t))},a_:function(){return a.close()}}),l=function(t,e){a.listen(t,(function(t){try{e(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return l(u.WebChannel.EventType.OPEN,(function(){h||p("Connection","WebChannel transport opened.")})),l(u.WebChannel.EventType.CLOSE,(function(){h||(h=!0,p("Connection","WebChannel transport closed"),f.f_())})),l(u.WebChannel.EventType.ERROR,(function(t){h||(h=!0,v("Connection","WebChannel transport errored:",t),f.f_(new k(R.UNAVAILABLE,"The operation could not be completed")))})),l(u.WebChannel.EventType.MESSAGE,(function(t){var e;if(!h){var n=t.data[0];m(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){p("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=X[t];if(void 0!==e)return tt(e)}(o),u=i.message;void 0===s&&(s=R.INTERNAL,u="Unknown error status: "+o+" with message "+i.message),h=!0,f.f_(new k(s,u)),a.close()}else p("Connection","WebChannel received:",n),f.d_(n)}})),setTimeout((function(){f.__()}),0),f},e}(function(){function t(t){this.w_=t,this.s=t.s;var e=t.ssl?"https":"http";this.T_=e+"://"+t.host,this.E_="projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents"}return t.prototype.va=function(t,e,n,r){var i=this.I_(t,e);p("RestConnection","Sending: ",i,n);var o={};return this.m_(o,r),this.A_(t,i,o,n).then((function(t){return p("RestConnection","Received: ",t),t}),(function(e){throw v("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.Sa=function(t,e,n,r){return this.va(t,e,n,r)},t.prototype.m_=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.19.1",t["Content-Type"]="text/plain",e)for(var n in e.Mh)e.Mh.hasOwnProperty(n)&&(t[n]=e.Mh[n])},t.prototype.I_=function(t,e){var n=xo[t];return this.T_+"/v1/"+e+":"+n},t}()),Ro=function(){function t(){var t=this;this.R_=function(){return t.P_()},this.g_=function(){return t.V_()},this.y_=[],this.p_()}return t.prototype.Ka=function(t){this.y_.push(t)},t.prototype.th=function(){window.removeEventListener("online",this.R_),window.removeEventListener("offline",this.g_)},t.prototype.p_=function(){window.addEventListener("online",this.R_),window.addEventListener("offline",this.g_)},t.prototype.P_=function(){p("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.y_;t<e.length;t++)(0,e[t])(0)},t.prototype.V_=function(){p("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.y_;t<e.length;t++)(0,e[t])(1)},t.ks=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),ko=function(){function t(){}return t.prototype.Ka=function(t){},t.prototype.th=function(){},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oo(t){return new Yt(t,!0)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Lo="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Co=function(){function t(){}return t.prototype.initialize=function(t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return this.Uc=this.b_(t),this.persistence=this.v_(t),[4,this.persistence.start()];case 1:return e.sent(),this.S_=this.D_(t),this.La=this.C_(t),[2]}}))}))},t.prototype.D_=function(t){return null},t.prototype.C_=function(t){return e=this.persistence,n=new _o,r=t.N_,new Ii(e,n,r);var e,n,r},t.prototype.v_=function(t){if(t.k_.F_)throw new k(R.FAILED_PRECONDITION,Lo);return new Ao(So.i_)},t.prototype.b_=function(t){return new no},t.prototype.terminate=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return this.S_&&this.S_.stop(),[4,this.Uc.th()];case 1:return t.sent(),[4,this.persistence.th()];case 2:return t.sent(),[2]}}))}))},t.prototype.clearPersistence=function(t,e){throw new k(R.FAILED_PRECONDITION,Lo)},t}(),Vo=function(t){function e(e){var n=this;return(n=t.call(this)||this).x_=e,n}return r.__extends(e,t),e.prototype.initialize=function(e){return r.__awaiter(this,void 0,void 0,(function(){var n,i=this;return r.__generator(this,(function(o){switch(o.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return o.sent(),[4,this.x_.initialize(this,e)];case 2:return o.sent(),n=this.x_.fu,this.Uc instanceof eo?(this.Uc.fu={Ic:ho.bind(null,n),mc:yo.bind(null,n),Ac:go.bind(null,n),rh:vo.bind(null,n)},[4,this.Uc.start()]):[3,4];case 3:o.sent(),o.label=4;case 4:return[4,this.persistence.qo((function(t){return r.__awaiter(i,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return[4,fo(this.x_.fu,t)];case 1:return e.sent(),this.S_&&(t&&!this.S_.tr?this.S_.start(this.La):t||this.S_.stop()),[2]}}))}))}))];case 5:return o.sent(),[2]}}))}))},e.prototype.b_=function(t){if(t.k_.F_&&t.k_.synchronizeTabs){var e=ur();if(!eo.ks(e))throw new k(R.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Ei(t.w_.s,t.w_.persistenceKey);return new eo(e,t.ei,n,t.clientId,t.N_)}return new no},e}(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.initialize=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,function(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n;return r.__generator(this,(function(r){return e=w(t),n=w(e.Ah),[2,e.persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return n.Wr(t)})).then((function(t){e.mh=t}))]}))}))}(this.La)];case 2:return n.sent(),[2]}}))}))},e.prototype.D_=function(t){var e=this.persistence.dr.Yi;return new yr(e,t.ei)},e.prototype.v_=function(t){var e=Ei(t.w_.s,t.w_.persistenceKey),n=Oo(t.w_.s);return new gi(t.k_.synchronizeTabs,e,t.clientId,vr.Ui(t.k_.cacheSizeBytes),t.ei,ur(),ar(),n,this.Uc,t.k_.Vo)},e.prototype.b_=function(t){return new no},e.prototype.clearPersistence=function(t,e){return function(t){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(n){switch(n.label){case 0:return Jn.ks()?(e=t+"main",[4,Jn.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(Ei(t,e))},e}(Co)),Uo=function(){function t(){}return t.prototype.initialize=function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n=this;return r.__generator(this,(function(r){switch(r.label){case 0:return this.La?[3,3]:(this.La=t.La,this.Uc=t.Uc,this.qa=this.O_(e),this.Bc=this.M_(e),this.fu=this.L_(e),this.q_=this.B_(e),this.Uc.Da=function(t){return n.fu.xc(t,1)},this.Bc.fu=this.fu,[4,this.Bc.start()]);case 1:return r.sent(),[4,this.Bc.Su(this.fu.el)];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},t.prototype.B_=function(t){return new wo(this.fu)},t.prototype.O_=function(t){var e,n=Oo(t.w_.s),r=(e=t.w_,new Do(e));return function(t,e,n){return new zi(t,e,n)}(t.credentials,r,n)},t.prototype.M_=function(t){var e=this;return new Wi(this.La,this.qa,t.ei,(function(t){return e.fu.xc(t,0)}),Ro.ks()?new Ro:new ko)},t.prototype.L_=function(t){return function(t,e,n,r,i,o,s){var u=new ao(t,e,n,r,i,o);return s&&(u.tl=!0),u}(this.La,this.Bc,this.qa,this.Uc,t.N_,t.Qc,!t.k_.F_||!t.k_.synchronizeTabs)},t.prototype.terminate=function(){return this.Bc.th()},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mo(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Fo=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.U_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.U_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Q_=function(){this.muted=!0},t.prototype.U_=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qo(t,e){if(0!==e.length)throw new k(R.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+is(e.length,"argument")+".")}function jo(t,e,n){if(e.length!==n)throw new k(R.INVALID_ARGUMENT,"Function "+t+"() requires "+is(n,"argument")+", but was called with "+is(e.length,"argument")+".")}function Go(t,e,n){if(e.length<n)throw new k(R.INVALID_ARGUMENT,"Function "+t+"() requires at least "+is(n,"argument")+", but was called with "+is(e.length,"argument")+".")}function Bo(t,e,n,r){if(e.length<n||e.length>r)throw new k(R.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+is(e.length,"argument")+".")}function zo(t,e,n,r){Qo(t,e,rs(n)+" argument",r)}function Ho(t,e,n,r){void 0!==r&&zo(t,e,n,r)}function Wo(t,e,n,r){Qo(t,e,n+" option",r)}function Ko(t,e,n,r){void 0!==r&&Wo(t,e,n,r)}function Yo(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var o=[],s=0,u=i;s<u.length;s++){var a=u[s];if(a===r)return;o.push(Jo(a))}var c=Jo(r);throw new k(R.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(t,0,n,r,i)}function Xo(t,e,n,r){if(!e.some((function(t){return t===r})))throw new k(R.INVALID_ARGUMENT,"Invalid value "+Jo(r)+" provided to function "+t+"() for its "+rs(n)+" argument. Acceptable values: "+e.join(", "));return r}function Qo(t,e,n,r){if(!("object"===e?Zo(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Jo(r);throw new k(R.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Zo(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Jo(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":g()}function $o(t,e,n){if(void 0===n)throw new k(R.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+rs(e)+" argument, but it was undefined.")}function ts(t,e,n){P(e,(function(e,r){if(n.indexOf(e)<0)throw new k(R.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))}))}function es(t,e,n,r){var i=Jo(r);return new k(R.INVALID_ARGUMENT,"Function "+t+"() requires its "+rs(n)+" argument to be a "+e+", but it was: "+i)}function ns(t,e,n){if(n<=0)throw new k(R.INVALID_ARGUMENT,"Function "+t+"() requires its "+rs(e)+" argument to be a positive number, but it was: "+n+".")}function rs(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function is(t,e){return t+" "+e+(1===t?"":"s")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function os(){if("undefined"==typeof Uint8Array)throw new k(R.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function ss(){if("undefined"==typeof atob)throw new k(R.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var us=function(){function t(t){ss(),this.W_=t}return t.fromBase64String=function(e){jo("Blob.fromBase64String",arguments,1),zo("Blob.fromBase64String","string",1,e),ss();try{return new t(Y.fromBase64String(e))}catch(e){throw new k(R.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+e)}},t.fromUint8Array=function(e){if(jo("Blob.fromUint8Array",arguments,1),os(),!(e instanceof Uint8Array))throw es("Blob.fromUint8Array","Uint8Array",1,e);return new t(Y.fromUint8Array(e))},t.prototype.toBase64=function(){return jo("Blob.toBase64",arguments,0),ss(),this.W_.toBase64()},t.prototype.toUint8Array=function(){return jo("Blob.toUint8Array",arguments,0),os(),this.W_.toUint8Array()},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.W_.isEqual(t.W_)},t}(),as=function(t){!function(t,e,n,r){if(!(e instanceof Array)||e.length<1)throw new k(R.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least "+is(1,"element")+".")}(0,t);for(var e=0;e<t.length;++e)if(zo("FieldPath","string",e,t[e]),0===t[e].length)throw new k(R.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.j_=new M(t)},cs=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,e)||this}return r.__extends(e,t),e.documentId=function(){return new e(M.L().F())},e.prototype.isEqual=function(t){if(!(t instanceof e))throw es("isEqual","FieldPath",1,t);return this.j_.isEqual(t.j_)},e}(as),hs=new RegExp("[~\\*/\\[\\]]"),fs=function(){this.K_=this},ls=function(t){function e(e){var n=this;return(n=t.call(this)||this).G_=e,n}return r.__extends(e,t),e.prototype.z_=function(t){if(2!==t.H_)throw 1===t.H_?t.Y_(this.G_+"() can only appear at the top level of your update data"):t.Y_(this.G_+"() cannot be used with set() unless you pass {merge:true}");return t.qe.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(fs);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ps(t,e,n){return new Ns({H_:3,J_:e.settings.J_,methodName:t.G_,X_:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var ds=function(t){function e(e){var n=this;return(n=t.call(this)||this).G_=e,n}return r.__extends(e,t),e.prototype.z_=function(t){return new Me(t.path,new xe)},e.prototype.isEqual=function(t){return t instanceof e},e}(fs),vs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).G_=e,r.Z_=n,r}return r.__extends(e,t),e.prototype.z_=function(t){var e=ps(this,t,!0),n=this.Z_.map((function(t){return ks(t,e)})),r=new De(n);return new Me(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(fs),ys=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).G_=e,r.Z_=n,r}return r.__extends(e,t),e.prototype.z_=function(t){var e=ps(this,t,!0),n=this.Z_.map((function(t){return ks(t,e)})),r=new ke(n);return new Me(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(fs),gs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).G_=e,r.tf=n,r}return r.__extends(e,t),e.prototype.z_=function(t){var e=new Le(t.serializer,Zt(t.serializer,this.tf));return new Me(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(fs),ms=function(t){function e(){return t.call(this)||this}return r.__extends(e,t),e.delete=function(){return qo("FieldValue.delete",arguments),new ws(new ls("FieldValue.delete"))},e.serverTimestamp=function(){return qo("FieldValue.serverTimestamp",arguments),new ws(new ds("FieldValue.serverTimestamp"))},e.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Go("FieldValue.arrayUnion",arguments,1),new ws(new vs("FieldValue.arrayUnion",t))},e.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Go("FieldValue.arrayRemove",arguments,1),new ws(new ys("FieldValue.arrayRemove",t))},e.increment=function(t){return zo("FieldValue.increment","number",1,t),jo("FieldValue.increment",arguments,1),new ws(new gs("FieldValue.increment",t))},e}(fs),ws=function(t){function e(e){var n=this;return(n=t.call(this)||this).K_=e,n.G_=e.G_,n}return r.__extends(e,t),e.prototype.z_=function(t){return this.K_.z_(t)},e.prototype.isEqual=function(t){return t instanceof e&&this.K_.isEqual(t.K_)},e}(ms),bs=function(){function t(t,e){if(jo("GeoPoint",arguments,2),zo("GeoPoint","number",1,t),zo("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new k(R.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new k(R.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.ef=t,this.nf=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.ef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.nf},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.ef===t.ef&&this.nf===t.nf},t.prototype.toJSON=function(){return{latitude:this.ef,longitude:this.nf}},t.prototype.T=function(t){return E(this.ef,t.ef)||E(this.nf,t.nf)},t}(),_s=/^__.*__$/,Es=function(t,e,n){this.sf=t,this.if=e,this.rf=n},Is=function(){function t(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}return t.prototype.hf=function(t,e){var n=[];return null!==this.qe?n.push(new Xe(t,this.data,this.qe,e)):n.push(new Ye(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new Ze(t,this.fieldTransforms)),n},t}(),Ts=function(){function t(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}return t.prototype.hf=function(t,e){var n=[new Xe(t,this.data,this.qe,e)];return this.fieldTransforms.length>0&&n.push(new Ze(t,this.fieldTransforms)),n},t}();function As(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw g()}}var Ns=function(){function t(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.af(),this.fieldTransforms=i||[],this.qe=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"H_",{get:function(){return this.settings.H_},enumerable:!1,configurable:!0}),t.prototype.uf=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.qe)},t.prototype.cf=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.uf({path:n,X_:!1});return r.lf(t),r},t.prototype._f=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.uf({path:n,X_:!1});return r.af(),r},t.prototype.ff=function(t){return this.uf({path:void 0,X_:!0})},t.prototype.Y_=function(t){return Ms(t,this.settings.methodName,this.settings.df||!1,this.path,this.settings.J_)},t.prototype.contains=function(t){return void 0!==this.qe.find((function(e){return t.D(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.D(e.field)}))},t.prototype.af=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.lf(this.path.get(t))},t.prototype.lf=function(t){if(0===t.length)throw this.Y_("Document fields must not be empty");if(As(this.H_)&&_s.test(t))throw this.Y_('Document fields cannot begin and end with "__"')},t}(),Ss=function(){function t(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||Oo(t)}return t.prototype.wf=function(t,e,n,r){return void 0===r&&(r=!1),new Ns({H_:t,methodName:e,J_:n,path:M.$(),X_:!1,df:r},this.s,this.serializer,this.ignoreUndefinedProperties)},t}();function Ps(t,e,n,r,i,o){void 0===o&&(o={});var s=t.wf(o.merge||o.mergeFields?2:0,e,n,i);Cs("Data must be an object, but it was:",s,r);var u,a,c=Os(r,s);if(o.merge)u=new Ue(s.qe),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=l[f],d=void 0;if(p instanceof as)d=p.j_;else{if("string"!=typeof p)throw g();d=Us(e,p,n)}if(!s.contains(d))throw new k(R.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Fs(h,d)||h.push(d)}u=new Ue(h),a=s.fieldTransforms.filter((function(t){return u.Ke(t.field)}))}else u=null,a=s.fieldTransforms;return new Is(new nn(c),u,a)}function xs(t,e,n,r){var i=t.wf(1,e,n);Cs("Data must be an object, but it was:",i,r);var o=[],s=new rn;P(r,(function(t,r){var u=Us(e,t,n),a=i._f(u);if(r instanceof fs&&r.K_ instanceof ls)o.push(u);else{var c=ks(r,a);null!=c&&(o.push(u),s.set(u,c))}}));var u=new Ue(o);return new Ts(s.ze(),u,i.fieldTransforms)}function Ds(t,e,n,r,i,o){var s=t.wf(1,e,n),u=[Vs(e,r,n)],a=[i];if(o.length%2!=0)throw new k(R.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Vs(e,o[c])),a.push(o[c+1]);for(var h=[],f=new rn,l=u.length-1;l>=0;--l)if(!Fs(h,u[l])){var p=u[l],d=a[l],v=s._f(p);if(d instanceof fs&&d.K_ instanceof ls)h.push(p);else{var y=ks(d,v);null!=y&&(h.push(p),f.set(p,y))}}var g=new Ue(h);return new Ts(f.ze(),g,s.fieldTransforms)}function Rs(t,e,n,r){return void 0===r&&(r=!1),ks(n,t.wf(r?4:3,e))}function ks(t,e){if(Ls(t))return Cs("Unsupported field value:",e,t),Os(t,e);if(t instanceof fs)return function(t,e){if(!As(e.H_))throw e.Y_(t.G_+"() can only be used with update() and set()");if(!e.path)throw e.Y_(t.G_+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.qe.push(e.path),t instanceof Array){if(e.settings.X_&&4!==e.H_)throw e.Y_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=ks(o[i],e.ff(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Zt(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=O.fromDate(t);return{timestampValue:Jt(e.serializer,n)}}if(t instanceof O){var r=new O(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Jt(e.serializer,r)}}if(t instanceof bs)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof us)return{bytesValue:$t(e.serializer,t)};if(t instanceof Es){var i=e.s,o=t.sf;if(!o.isEqual(i))throw e.Y_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:ne(t.sf||e.s,t.if.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Y_("Unsupported field value: "+Jo(t))}(t,e)}function Os(t,e){var n={};return x(t)?e.path&&e.path.length>0&&e.qe.push(e.path):P(t,(function(t,r){var i=ks(r,e.cf(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Ls(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof O||t instanceof bs||t instanceof us||t instanceof Es||t instanceof fs)}function Cs(t,e,n){if(!Ls(n)||!Zo(n)){var r=Jo(n);throw"an object"===r?e.Y_(t+" a custom object"):e.Y_(t+" "+r)}}function Vs(t,e,n){if(e instanceof as)return e.j_;if("string"==typeof e)return Us(t,e);throw Ms("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Us(t,e,n){try{return function(t){if(t.search(hs)>=0)throw new k(R.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(cs.bind.apply(cs,r.__spreadArrays([void 0],t.split("."))))}catch(r){throw new k(R.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).j_}catch(e){throw Ms((i=e)instanceof Error?i.message:i.toString(),t,!1,void 0,n)}var i}function Ms(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new k(R.INVALID_ARGUMENT,(u+=". ")+t+a)}function Fs(t,e){return t.some((function(t){return t.isEqual(e)}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qs=function(){function t(t){this.qa=t,this.Tf=new Map,this.mutations=[],this.Ef=!1,this.If=null,this.mf=new Set}return t.prototype.Af=function(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n=this;return r.__generator(this,(function(i){switch(i.label){case 0:if(this.Rf(),this.mutations.length>0)throw new k(R.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s,u,a;return r.__generator(this,(function(r){switch(r.label){case 0:return n=w(t),i=ae(n.serializer)+"/documents",o={documents:e.map((function(t){return ie(n.serializer,t)}))},[4,n.Sa("BatchGetDocuments",i,o)];case 1:return s=r.sent(),u=new Map,s.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){m(!!e.found),e.found.name,e.found.updateTime;var n=oe(t,e.found.name),r=ee(e.found.updateTime),i=new nn({mapValue:{fields:e.found.fields}});return new un(n,r,i,{})}(t,e):"missing"in e?function(t,e){m(!!e.missing),m(!!e.readTime);var n=oe(t,e.missing),r=ee(e.readTime);return new an(n,r)}(t,e):g()}(n.serializer,t);u.set(e.key.toString(),e)})),a=[],[2,(e.forEach((function(t){var e=u.get(t.toString());m(!!e),a.push(e)})),a)]}}))}))}(this.qa,t)];case 1:return[2,((e=i.sent()).forEach((function(t){t instanceof an||t instanceof un?n.Pf(t):g()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.hf(t,this.Qe(t))),this.mf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.hf(t,this.gf(t)))}catch(t){this.If=t}this.mf.add(t.toString())},t.prototype.delete=function(t){this.write([new tn(t,this.Qe(t))]),this.mf.add(t.toString())},t.prototype.commit=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,e=this;return r.__generator(this,(function(n){switch(n.label){case 0:if(this.Rf(),this.If)throw this.If;return t=this.Tf,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=F.B(n);e.mutations.push(new en(r,e.Qe(r)))})),[4,function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o;return r.__generator(this,(function(r){switch(r.label){case 0:return n=w(t),i=ae(n.serializer)+"/documents",o={writes:e.map((function(t){return fe(n.serializer,t)}))},[4,n.va("Commit",i,o)];case 1:return r.sent(),[2]}}))}))}(this.qa,this.mutations)];case 1:return n.sent(),this.Ef=!0,[2]}}))}))},t.prototype.Pf=function(t){var e;if(t instanceof un)e=t.version;else{if(!(t instanceof an))throw g();e=L.min()}var n=this.Tf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new k(R.ABORTED,"Document version changed between two reads.")}else this.Tf.set(t.key.toString(),e)},t.prototype.Qe=function(t){var e=this.Tf.get(t.toString());return!this.mf.has(t.toString())&&e?qe.updateTime(e):qe.We()},t.prototype.gf=function(t){var e=this.Tf.get(t.toString());if(!this.mf.has(t.toString())&&e){if(e.isEqual(L.min()))throw new k(R.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return qe.updateTime(e)}return qe.exists(!0)},t.prototype.write=function(t){this.Rf(),this.mutations=this.mutations.concat(t)},t.prototype.Rf=function(){},t}(),js=function(){function t(t,e,n,r){this.ei=t,this.qa=e,this.updateFunction=n,this.ii=r,this.Vf=5,this.Ti=new Zn(this.ei,"transaction_retry")}return t.prototype.run=function(){this.yf()},t.prototype.yf=function(){var t=this;this.Ti.bs((function(){return r.__awaiter(t,void 0,void 0,(function(){var t,e,n=this;return r.__generator(this,(function(r){return t=new qs(this.qa),(e=this.pf(t))&&e.then((function(e){n.ei.ai((function(){return t.commit().then((function(){n.ii.resolve(e)})).catch((function(t){n.bf(t)}))}))})).catch((function(t){n.bf(t)})),[2]}))}))}))},t.prototype.pf=function(t){try{var e=this.updateFunction(t);return!q(e)&&e.catch&&e.then?e:(this.ii.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ii.reject(t),null}},t.prototype.bf=function(t){var e=this;this.Vf>0&&this.vf(t)?(this.Vf-=1,this.ei.ai((function(){return e.yf(),Promise.resolve()}))):this.ii.reject(t)},t.prototype.vf=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!$(e)}return!1},t}(),Gs=function(){function t(t,e){this.credentials=t,this.ei=e,this.clientId=_.t(),this.Sf=new Qn}return t.prototype.start=function(t,e,n,r){var i=this;this.Df(),this.w_=t;var o=new Qn,s=!1;return this.credentials.Bh((function(t){if(!s)return s=!0,p("FirestoreClient","Initializing. user=",t.uid),i.Cf(e,n,r,t,o).then(i.Sf.resolve,i.Sf.reject);i.ei.gi((function(){return i.Bc.vu(t)}))})),this.ei.ai((function(){return i.Sf.promise})),o.promise},t.prototype.enableNetwork=function(){var t=this;return this.Df(),this.ei.enqueue((function(){return t.persistence.Uo(!0),t.Bc.enableNetwork()}))},t.prototype.Cf=function(t,e,n,i,o){return r.__awaiter(this,void 0,void 0,(function(){var s,u,a=this;return r.__generator(this,(function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),s={ei:this.ei,w_:this.w_,clientId:this.clientId,credentials:this.credentials,N_:i,Qc:100,k_:n},[4,t.initialize(s)];case 1:return c.sent(),[4,e.initialize(t,s)];case 2:return c.sent(),this.persistence=t.persistence,this.Uc=t.Uc,this.La=t.La,this.S_=t.S_,this.qa=e.qa,this.Bc=e.Bc,this.fu=e.fu,this.Nf=e.q_,this.persistence.Bo((function(){return r.__awaiter(a,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}}))}))})),o.resolve(),[3,4];case 3:if(u=c.sent(),o.reject(u),!this.Ff(u))throw u;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+u),this.Cf(new Co,new Uo,{F_:!1},i,o))];case 4:return[2]}}))}))},t.prototype.Ff=function(t){return"FirebaseError"===t.name?t.code===R.FAILED_PRECONDITION||t.code===R.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},t.prototype.Df=function(){if(this.ei.Ii)throw new k(R.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.disableNetwork=function(){var t=this;return this.Df(),this.ei.enqueue((function(){return t.persistence.Uo(!1),t.Bc.disableNetwork()}))},t.prototype.terminate=function(){var t=this;this.ei.Pi();var e=new Qn;return this.ei.mi((function(){return r.__awaiter(t,void 0,void 0,(function(){var t,n;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),this.S_&&this.S_.stop(),[4,this.Bc.th()];case 1:return r.sent(),[4,this.Uc.th()];case 2:return r.sent(),[4,this.persistence.th()];case 3:return r.sent(),this.credentials.Uh(),e.resolve(),[3,5];case 4:return t=r.sent(),n=fr(t,"Failed to shutdown persistence"),e.reject(n),[3,5];case 5:return[2]}}))}))})),e.promise},t.prototype.waitForPendingWrites=function(){var t=this;this.Df();var e=new Qn;return this.ei.ai((function(){return t.fu._l(e)})),e.promise},t.prototype.listen=function(t,e,n){var r=this;this.Df();var i=new Fo(n),o=new bo(t,i,e);return this.ei.ai((function(){return r.Nf.listen(o)})),function(){i.Q_(),r.ei.ai((function(){return r.Nf.lu(o)}))}},t.prototype.kf=function(t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(e.sent(),function(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o=this;return r.__generator(this,(function(s){switch(s.label){case 0:return i=new Qn,[4,t.enqueue((function(){return r.__awaiter(o,void 0,void 0,(function(){var t,o,s;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t,e){var n=w(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Rh.Hn(t,e)}))}(e,n)];case 1:return(t=r.sent())instanceof un?i.resolve(t):t instanceof an?i.resolve(null):i.reject(new k(R.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return o=r.sent(),s=fr(o,"Failed to get document '"+n+" from cache"),i.reject(s),[3,3];case 3:return[2]}}))}))}))];case 1:return[2,(s.sent(),i.promise)]}}))}))}(this.ei,this.La,t))]}}))}))},t.prototype.$f=function(t,e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(n){switch(n.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(n.sent(),function(t,e,n,r){var i=new Qn,o=Bs(t,e,pn(n.path),{includeMetadataChanges:!0,$l:!0},{next:function(t){o();var e=t.docs.has(n);!e&&t.fromCache?i.reject(new k(R.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&r&&"server"===r.source?i.reject(new k(R.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(t)},error:function(t){return i.reject(t)}});return i.promise}(this.ei,this.Nf,t,e))]}}))}))},t.prototype.xf=function(t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(e.sent(),function(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o=this;return r.__generator(this,(function(s){switch(s.label){case 0:return i=new Qn,[4,t.enqueue((function(){return r.__awaiter(o,void 0,void 0,(function(){var t,o,s,u,a,c;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Di(e,n,!0)];case 1:return t=r.sent(),o=new oo(n,t.gh),s=o.Sc(t.documents),u=o.Un(s,!1),i.resolve(u.snapshot),[3,3];case 2:return a=r.sent(),c=fr(a,"Failed to execute query '"+n+" against cache"),i.reject(c),[3,3];case 3:return[2]}}))}))}))];case 1:return[2,(s.sent(),i.promise)]}}))}))}(this.ei,this.La,t))]}}))}))},t.prototype.Of=function(t,e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(n){switch(n.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(n.sent(),function(t,e,n,r){var i=new Qn,o=Bs(t,e,n,{includeMetadataChanges:!0,$l:!0},{next:function(t){o(),t.fromCache&&r&&"server"===r.source?i.reject(new k(R.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}});return i.promise}(this.ei,this.Nf,t,e))]}}))}))},t.prototype.write=function(t){var e=this;this.Df();var n=new Qn;return this.ei.ai((function(){return e.fu.write(t,n)})),n.promise},t.prototype.s=function(){return this.w_.s},t.prototype.bl=function(t){var e=this;this.Df();var n=new Fo(t);return this.ei.ai((function(){return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(t){return[2,this.Nf.bl(n)]}))}))})),function(){n.Q_(),e.ei.ai((function(){return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(t){return[2,this.Nf.vl(n)]}))}))}))}},Object.defineProperty(t.prototype,"Mf",{get:function(){return this.ei.Ii},enumerable:!1,configurable:!0}),t.prototype.transaction=function(t){var e=this;this.Df();var n=new Qn;return this.ei.ai((function(){return new js(e.ei,e.qa,t,n).run(),Promise.resolve()})),n.promise},t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bs(t,e,n,r,i){var o=new Fo(i),s=new bo(n,o,r);return t.ai((function(){return e.listen(s)})),function(){o.Q_(),t.ai((function(){return e.lu(s)}))}}var zs=function(){function t(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.Lf=n,this.qf=r}return t.prototype.Bf=function(t){switch(Rt(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Mt(t.integerValue||t.doubleValue);case 3:return this.Uf(t.timestampValue);case 4:return this.Qf(t);case 5:return t.stringValue;case 6:return new us(Ft(t.bytesValue));case 7:return this.Wf(t.referenceValue);case 8:return this.jf(t.geoPointValue);case 9:return this.Kf(t.arrayValue);case 10:return this.Gf(t.mapValue);default:throw g()}},t.prototype.Gf=function(t){var e=this,n={};return P(t.fields||{},(function(t,r){n[t]=e.Bf(r)})),n},t.prototype.jf=function(t){return new bs(Mt(t.latitude),Mt(t.longitude))},t.prototype.Kf=function(t){var e=this;return(t.values||[]).map((function(t){return e.Bf(t)}))},t.prototype.Qf=function(t){switch(this.Lf){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return Pt(n)?t(n):n}(t);return null==e?null:this.Bf(e);case"estimate":return this.Uf(xt(t));default:return null}},t.prototype.Uf=function(t){var e=Ut(t),n=new O(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},t.prototype.Wf=function(t){var e=V.k(t);m(Te(e));var n=new N(e.get(1),e.get(3)),r=new F(e.V(5));return n.isEqual(this.s)||d("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.qf(r)},t}(),Hs=vr.ji,Ws=function(){function t(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new k(R.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Wo("settings","non-empty string","host",t.host),this.host=t.host,Ko("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(ts("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Ko("settings","object","credentials",t.credentials),this.credentials=t.credentials,Ko("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Ko("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?d("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&d("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,Ko("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=vr.Gi;else{if(t.cacheSizeBytes!==Hs&&t.cacheSizeBytes<vr.Ki)throw new k(R.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+vr.Ki);this.cacheSizeBytes=t.cacheSizeBytes}Ko("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Ks=function(){function t(e,n,i,o){var s=this;if(void 0===i&&(i=new Co),void 0===o&&(o=new Uo),this.zf=i,this.Hf=o,this.Yf=null,this.Jf=new hr,this.INTERNAL={delete:function(){return r.__awaiter(s,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return this.Xf(),[4,this.Zf.terminate()];case 1:return t.sent(),[2]}}))}))}},"object"==typeof e.options){var u=e;this.Yf=u,this.sf=t.td(u),this.ed=u.name,this.nd=new Mi(n)}else{var a=e;if(!a.projectId)throw new k(R.INVALID_ARGUMENT,"Must provide projectId");this.sf=new N(a.projectId,a.database),this.ed="[DEFAULT]",this.nd=new Ui}this.sd=new Ws({})}return Object.defineProperty(t.prototype,"rd",{get:function(){return this.od||(this.od=new Ss(this.sf,this.sd.ignoreUndefinedProperties)),this.od},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){jo("Firestore.settings",arguments,1),zo("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.sd),t)).merge;var e=new Ws(t);if(this.Zf&&!this.sd.isEqual(e))throw new k(R.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this.sd=e,void 0!==e.credentials&&(this.nd=function(t){if(!t)return new Ui;switch(t.type){case"gapi":var e=t.hd;return m(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new qi(e,t.zh||"0");case"provider":return t.hd;default:throw new k(R.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},t.prototype.enableNetwork=function(){return this.Xf(),this.Zf.enableNetwork()},t.prototype.disableNetwork=function(){return this.Xf(),this.Zf.disableNetwork()},t.prototype.enablePersistence=function(t){var e,n;if(this.Zf)throw new k(R.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&d("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new k(R.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.ad(this.zf,this.Hf,{F_:!0,cacheSizeBytes:this.sd.cacheSizeBytes,synchronizeTabs:r,Vo:i})},t.prototype.clearPersistence=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,e=this;return r.__generator(this,(function(n){if(void 0!==this.Zf&&!this.Zf.Mf)throw new k(R.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return t=new Qn,[2,(this.Jf.mi((function(){return r.__awaiter(e,void 0,void 0,(function(){var e;return r.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.zf.clearPersistence(this.sf,this.ed)];case 1:return n.sent(),t.resolve(),[3,3];case 2:return e=n.sent(),t.reject(e),[3,3];case 3:return[2]}}))}))})),t.promise)]}))}))},t.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(t.prototype,"ud",{get:function(){return this.Xf(),this.Zf.Mf},enumerable:!1,configurable:!0}),t.prototype.waitForPendingWrites=function(){return this.Xf(),this.Zf.waitForPendingWrites()},t.prototype.onSnapshotsInSync=function(t){if(this.Xf(),Mo(t))return this.Zf.bl(t);zo("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.Zf.bl(e)},t.prototype.Xf=function(){return this.Zf||this.ad(new Co,new Uo,{F_:!1}),this.Zf},t.prototype.ld=function(){return new A(this.sf,this.ed,this.sd.host,this.sd.ssl,this.sd.experimentalForceLongPolling)},t.prototype.ad=function(t,e,n){var r=this.ld();return this.Zf=new Gs(this.nd,this.Jf),this.Zf.start(r,t,e,n)},t.td=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new k(R.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(!n||"string"!=typeof n)throw new k(R.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new N(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.Yf)throw new k(R.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Yf},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){return jo("Firestore.collection",arguments,1),zo("Firestore.collection","non-empty string",1,t),this.Xf(),new au(V.k(t),this,null)},t.prototype.doc=function(t){return jo("Firestore.doc",arguments,1),zo("Firestore.doc","non-empty string",1,t),this.Xf(),Qs._d(V.k(t),this,null)},t.prototype.collectionGroup=function(t){if(jo("Firestore.collectionGroup",arguments,1),zo("Firestore.collectionGroup","non-empty string",1,t),t.indexOf("/")>=0)throw new k(R.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Xf(),new su(function(t){return new fn(V.$(),t)}(t),this,null)},t.prototype.runTransaction=function(t){var e=this;return jo("Firestore.runTransaction",arguments,1),zo("Firestore.runTransaction","function",1,t),this.Xf().transaction((function(n){return t(new Ys(e,n))}))},t.prototype.batch=function(){return this.Xf(),new Xs(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(l()){case o.LogLevel.DEBUG:return"debug";case o.LogLevel.ERROR:return"error";case o.LogLevel.SILENT:return"silent";case o.LogLevel.WARN:return"warn";case o.LogLevel.INFO:return"info";case o.LogLevel.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),t.setLogLevel=function(t){var e;jo("Firestore.setLogLevel",arguments,1),Xo("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),e=t,f.setLogLevel(e)},t.prototype.fd=function(){return this.sd.timestampsInSnapshots},t.prototype.dd=function(){return this.sd},t}(),Ys=function(){function t(t,e){this.wd=t,this.Td=e}return t.prototype.get=function(t){var e=this;jo("Transaction.get",arguments,1);var n=lu("Transaction.get",t,this.wd);return this.Td.Af([n.if]).then((function(t){if(!t||1!==t.length)return g();var r=t[0];if(r instanceof an)return new Js(e.wd,n.if,null,!1,!1,n.rf);if(r instanceof un)return new Js(e.wd,n.if,r,!1,!1,n.rf);throw g()}))},t.prototype.set=function(t,e,n){Bo("Transaction.set",arguments,2,3);var r=lu("Transaction.set",t,this.wd);n=cu("Transaction.set",n);var i=du(r.rf,e,n),o=Ps(this.wd.rd,"Transaction.set",r.if,i,null!==r.rf,n);return this.Td.set(r.if,o),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return"string"==typeof e||e instanceof cs?(Go("Transaction.update",arguments,3),r=lu("Transaction.update",t,this.wd),i=Ds(this.wd.rd,"Transaction.update",r.if,e,n,o)):(jo("Transaction.update",arguments,2),r=lu("Transaction.update",t,this.wd),i=xs(this.wd.rd,"Transaction.update",r.if,e)),this.Td.update(r.if,i),this},t.prototype.delete=function(t){jo("Transaction.delete",arguments,1);var e=lu("Transaction.delete",t,this.wd);return this.Td.delete(e.if),this},t}(),Xs=function(){function t(t){this.wd=t,this.Ed=[],this.Id=!1}return t.prototype.set=function(t,e,n){Bo("WriteBatch.set",arguments,2,3),this.md();var r=lu("WriteBatch.set",t,this.wd);n=cu("WriteBatch.set",n);var i=du(r.rf,e,n),o=Ps(this.wd.rd,"WriteBatch.set",r.if,i,null!==r.rf,n);return this.Ed=this.Ed.concat(o.hf(r.if,qe.We())),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.md(),"string"==typeof e||e instanceof cs?(Go("WriteBatch.update",arguments,3),r=lu("WriteBatch.update",t,this.wd),i=Ds(this.wd.rd,"WriteBatch.update",r.if,e,n,o)):(jo("WriteBatch.update",arguments,2),r=lu("WriteBatch.update",t,this.wd),i=xs(this.wd.rd,"WriteBatch.update",r.if,e)),this.Ed=this.Ed.concat(i.hf(r.if,qe.exists(!0))),this},t.prototype.delete=function(t){jo("WriteBatch.delete",arguments,1),this.md();var e=lu("WriteBatch.delete",t,this.wd);return this.Ed=this.Ed.concat(new tn(e.if,qe.We())),this},t.prototype.commit=function(){return this.md(),this.Id=!0,this.Ed.length>0?this.wd.Xf().write(this.Ed):Promise.resolve()},t.prototype.md=function(){if(this.Id)throw new k(R.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),Qs=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n.sf,e,r)||this).if=e,i.firestore=n,i.rf=r,i.Zf=i.firestore.Xf(),i}return r.__extends(e,t),e._d=function(t,n,r){if(t.length%2!=0)throw new k(R.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.F()+" has "+t.length);return new e(new F(t),n,r)},Object.defineProperty(e.prototype,"id",{get:function(){return this.if.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new au(this.if.path.p(),this.firestore,this.rf)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.if.path.F()},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){if(jo("DocumentReference.collection",arguments,1),zo("DocumentReference.collection","non-empty string",1,t),!t)throw new k(R.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=V.k(t);return new au(this.if.path.child(e),this.firestore,null)},e.prototype.isEqual=function(t){if(!(t instanceof e))throw es("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.if.isEqual(t.if)&&this.rf===t.rf},e.prototype.set=function(t,e){Bo("DocumentReference.set",arguments,1,2),e=cu("DocumentReference.set",e);var n=du(this.rf,t,e),r=Ps(this.firestore.rd,"DocumentReference.set",this.if,n,null!==this.rf,e);return this.Zf.write(r.hf(this.if,qe.We()))},e.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"==typeof t||t instanceof cs?(Go("DocumentReference.update",arguments,2),n=Ds(this.firestore.rd,"DocumentReference.update",this.if,t,e,r)):(jo("DocumentReference.update",arguments,1),n=xs(this.firestore.rd,"DocumentReference.update",this.if,t)),this.Zf.write(n.hf(this.if,qe.exists(!0)))},e.prototype.delete=function(){return jo("DocumentReference.delete",arguments,0),this.Zf.write([new tn(this.if,qe.We())])},e.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Bo("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||Mo(i[u])||(ts("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),Ko("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a={includeMetadataChanges:s.includeMetadataChanges};if(Mo(i[u])){var c=i[u];i[u]=null===(t=c.next)||void 0===t?void 0:t.bind(c),i[u+1]=null===(e=c.error)||void 0===e?void 0:e.bind(c),i[u+2]=null===(n=c.complete)||void 0===n?void 0:n.bind(c)}else zo("DocumentReference.onSnapshot","function",u,i[u]),Ho("DocumentReference.onSnapshot","function",u+1,i[u+1]),Ho("DocumentReference.onSnapshot","function",u+2,i[u+2]);var h={next:function(t){i[u]&&i[u](r.Ad(t))},error:i[u+1],complete:i[u+2]};return this.Zf.listen(pn(this.if.path),a,h)},e.prototype.get=function(t){var e=this;Bo("DocumentReference.get",arguments,0,1),fu("DocumentReference.get",t);var n=this.firestore.Xf();return t&&"cache"===t.source?n.kf(this.if).then((function(t){return new Js(e.firestore,e.if,t,!0,t instanceof un&&t.Ge,e.rf)})):n.$f(this.if,t).then((function(t){return e.Ad(t)}))},e.prototype.withConverter=function(t){return new e(this.if,this.firestore,t)},e.prototype.Ad=function(t){var e=t.docs.get(this.if);return new Js(this.firestore,this.if,e,t.fromCache,t.hasPendingWrites,this.rf)},e}(Es),Zs=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Js=function(){function t(t,e,n,r,i,o){this.wd=t,this.if=e,this.Rd=n,this.Pd=r,this.gd=i,this.rf=o}return t.prototype.data=function(t){var e=this;if(Bo("DocumentSnapshot.data",arguments,0,1),t=hu("DocumentSnapshot.data",t),this.Rd){if(this.rf){var n=new $s(this.wd,this.if,this.Rd,this.Pd,this.gd,null);return this.rf.fromFirestore(n,t)}return new zs(this.wd.sf,this.wd.fd(),t.serverTimestamps||"none",(function(t){return new Qs(t,e.wd,null)})).Bf(this.Rd.tn())}},t.prototype.get=function(t,e){var n=this;if(Bo("DocumentSnapshot.get",arguments,1,2),e=hu("DocumentSnapshot.get",e),this.Rd){var r=this.Rd.data().field(Vs("DocumentSnapshot.get",t,this.if));if(null!==r)return new zs(this.wd.sf,this.wd.fd(),e.serverTimestamps||"none",(function(t){return new Qs(t,n.wd,n.rf)})).Bf(r)}},Object.defineProperty(t.prototype,"id",{get:function(){return this.if.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Qs(this.if,this.wd,this.rf)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this.Rd},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new Zs(this.gd,this.Pd)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw es("isEqual","DocumentSnapshot",1,e);return this.wd===e.wd&&this.Pd===e.Pd&&this.if.isEqual(e.if)&&(null===this.Rd?null===e.Rd:this.Rd.isEqual(e.Rd))&&this.rf===e.rf},t}(),$s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.data=function(e){return t.prototype.data.call(this,e)},e}(Js);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tu(t,e,n,r,i,o,s){var u;if(i.M()){if("array-contains"===o||"array-contains-any"===o)throw new k(R.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){ru(s,o);for(var a=[],c=0,h=s;c<h.length;c++){var f=h[c];a.push(nu(r,t,f))}u={arrayValue:{values:a}}}else u=nu(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||ru(s,o),u=Rs(n,e,s,"in"===o||"not-in"===o);var l=An.create(i,o,u);return function(t,e){if(e._n()){var n=t.ln();if(null!==n&&!n.isEqual(e.field))throw new k(R.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=t.cn();null!==r&&iu(t,e.field,r)}var i=t.fn(function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new k(R.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new k(R.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}function eu(t,e,n){if(null!==t.startAt)throw new k(R.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new k(R.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Mn(e,n);return function(t,e){if(null===t.cn()){var n=t.ln();null!==n&&iu(t,n,e.field)}}(t,r),r}function nu(t,e,n){if("string"==typeof n){if(""===n)throw new k(R.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!dn(e)&&-1!==n.indexOf("/"))throw new k(R.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(V.k(n));if(!F.j(r))throw new k(R.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return qt(t,new F(r))}if(n instanceof Es)return qt(t,n.if);throw new k(R.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Jo(n)+".")}function ru(t,e){if(!Array.isArray(t)||0===t.length)throw new k(R.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new k(R.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(t.indexOf(null)>=0)throw new k(R.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(t.filter((function(t){return Number.isNaN(t)})).length>0)throw new k(R.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function iu(t,e,n){if(!n.isEqual(e))throw new k(R.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function ou(t){if(t.un()&&0===t.en.length)throw new k(R.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var su=function(){function t(t,e,n){this.Vd=t,this.firestore=e,this.rf=n}return t.prototype.where=function(e,n,r){var i;jo("Query.where",arguments,3),$o("Query.where",3,r),i="not-in"===n||"!="===n?n:Xo("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,n);var o=Vs("Query.where",e),s=tu(this.Vd,"Query.where",this.firestore.rd,this.firestore.sf,o,i,r);return new t(function(t,e){var n=t.filters.concat([e]);return new fn(t.path,t.collectionGroup,t.en.slice(),n,t.limit,t.nn,t.startAt,t.endAt)}(this.Vd,s),this.firestore,this.rf)},t.prototype.orderBy=function(e,n){var r;if(Bo("Query.orderBy",arguments,1,2),Ho("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r="asc";else{if("desc"!==n)throw new k(R.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r="desc"}var i=Vs("Query.orderBy",e),o=eu(this.Vd,i,r);return new t(function(t,e){var n=t.en.concat([e]);return new fn(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.nn,t.startAt,t.endAt)}(this.Vd,o),this.firestore,this.rf)},t.prototype.limit=function(e){return jo("Query.limit",arguments,1),zo("Query.limit","number",1,e),ns("Query.limit",1,e),new t(gn(this.Vd,e,"F"),this.firestore,this.rf)},t.prototype.limitToLast=function(e){return jo("Query.limitToLast",arguments,1),zo("Query.limitToLast","number",1,e),ns("Query.limitToLast",1,e),new t(gn(this.Vd,e,"L"),this.firestore,this.rf)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Go("Query.startAt",arguments,1);var i=this.yd("Query.startAt",e,n,!0);return new t(mn(this.Vd,i),this.firestore,this.rf)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Go("Query.startAfter",arguments,1);var i=this.yd("Query.startAfter",e,n,!1);return new t(mn(this.Vd,i),this.firestore,this.rf)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Go("Query.endBefore",arguments,1);var i=this.yd("Query.endBefore",e,n,!0);return new t(wn(this.Vd,i),this.firestore,this.rf)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Go("Query.endAt",arguments,1);var i=this.yd("Query.endAt",e,n,!1);return new t(wn(this.Vd,i),this.firestore,this.rf)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw es("isEqual","Query",1,e);return this.firestore===e.firestore&&bn(this.Vd,e.Vd)&&this.rf===e.rf},t.prototype.withConverter=function(e){return new t(this.Vd,this.firestore,e)},t.prototype.yd=function(t,e,n,i){if($o(t,1,e),e instanceof Js)return jo(t,r.__spreadArrays([e],n),1),function(t,e,n,r,i){if(!r)throw new k(R.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=vn(t);s<u.length;s++){var a=u[s];if(a.field.M())o.push(qt(e,r.key));else{var c=r.field(a.field);if(Pt(c))throw new k(R.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.F();throw new k(R.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Ln(o,i)}(this.Vd,this.firestore.sf,t,e.Rd,i);var o=[e].concat(n);return function(t,e,n,r,i,o){var s=t.en;if(i.length>s.length)throw new k(R.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.M()){if("string"!=typeof c)throw new k(R.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!dn(t)&&-1!==c.indexOf("/"))throw new k(R.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(V.k(c));if(!F.j(h))throw new k(R.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new F(h);u.push(qt(e,f))}else{var l=Rs(n,r,c);u.push(l)}}return new Ln(u,o)}(this.Vd,this.firestore.sf,this.firestore.rd,t,o,i)},t.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Bo("Query.onSnapshot",arguments,1,4);var s={},u=0;if("object"!=typeof i[u]||Mo(i[u])||(ts("Query.onSnapshot",s=i[u],["includeMetadataChanges"]),Ko("Query.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++),Mo(i[u])){var a=i[u];i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)}else zo("Query.onSnapshot","function",u,i[u]),Ho("Query.onSnapshot","function",u+1,i[u+1]),Ho("Query.onSnapshot","function",u+2,i[u+2]);var c={next:function(t){i[u]&&i[u](new uu(r.firestore,r.Vd,t,r.rf))},error:i[u+1],complete:i[u+2]};return ou(this.Vd),this.firestore.Xf().listen(this.Vd,s,c)},t.prototype.get=function(t){var e=this;Bo("Query.get",arguments,0,1),fu("Query.get",t),ou(this.Vd);var n=this.firestore.Xf();return(t&&"cache"===t.source?n.xf(this.Vd):n.Of(this.Vd,t)).then((function(t){return new uu(e.firestore,e.Vd,t,e.rf)}))},t}(),uu=function(){function t(t,e,n,r){this.wd=t,this.pd=e,this.bd=n,this.rf=r,this.vd=null,this.Sd=null,this.metadata=new Zs(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this.bd.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.bd.docs.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;Bo("QuerySnapshot.forEach",arguments,1,2),zo("QuerySnapshot.forEach","function",1,t),this.bd.docs.forEach((function(r){t.call(e,n.Dd(r,n.metadata.fromCache,n.bd.qt.has(r.key)))}))},Object.defineProperty(t.prototype,"query",{get:function(){return new su(this.pd,this.wd,this.rf)},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){t&&(ts("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Ko("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.bd.Ut)throw new k(R.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.vd&&this.Sd===e||(this.vd=function(t,e,n){if(t.Lt._()){var r=0;return t.docChanges.map((function(e){var i=n(e.doc,t.fromCache,t.qt.has(e.doc.key));return e.doc,{type:"added",doc:i,oldIndex:-1,newIndex:r++}}))}var i=t.Lt;return t.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var r=n(e.doc,t.fromCache,t.qt.has(e.doc.key)),o=-1,s=-1;return 0!==e.type&&(o=i.indexOf(e.doc.key),i=i.delete(e.doc.key)),1!==e.type&&(s=(i=i.add(e.doc)).indexOf(e.doc.key)),{type:pu(e.type),doc:r,oldIndex:o,newIndex:s}}))}(this.bd,e,this.Dd.bind(this)),this.Sd=e),this.vd},t.prototype.isEqual=function(e){if(!(e instanceof t))throw es("isEqual","QuerySnapshot",1,e);return this.wd===e.wd&&bn(this.pd,e.pd)&&this.bd.isEqual(e.bd)&&this.rf===e.rf},t.prototype.Dd=function(t,e,n){return new $s(this.wd,t.key,t,e,n,this.rf)},t}(),au=function(t){function e(e,n,r){var i=this;if((i=t.call(this,pn(e),n,r)||this).Cd=e,e.length%2!=1)throw new k(R.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.F()+" has "+e.length);return i}return r.__extends(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.Vd.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.Vd.path.p();return t._()?null:new Qs(new F(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.Vd.path.F()},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){Bo("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=_.t()),zo("CollectionReference.doc","non-empty string",1,t);var e=V.k(t);return Qs._d(this.Vd.path.child(e),this.firestore,this.rf)},e.prototype.add=function(t){jo("CollectionReference.add",arguments,1),zo("CollectionReference.add","object",1,this.rf?this.rf.toFirestore(t):t);var e=this.doc();return e.set(t).then((function(){return e}))},e.prototype.withConverter=function(t){return new e(this.Cd,this.firestore,t)},e}(su);function cu(t,e){if(void 0===e)return{merge:!1};if(ts(t,e,["merge","mergeFields"]),Ko(t,"boolean","merge",e.merge),function(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new k(R.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Jo(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new k(R.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be "+n+", but the value at index "+o+" was: "+Jo(r[o]))}(t,e,n,r,i)}(t,"mergeFields","a string or a FieldPath",e.mergeFields,(function(t){return"string"==typeof t||t instanceof cs})),void 0!==e.mergeFields&&void 0!==e.merge)throw new k(R.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function hu(t,e){return void 0===e?{}:(ts(t,e,["serverTimestamps"]),Yo(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function fu(t,e){Ho(t,"object",1,e),e&&(ts(t,e,["source"]),Yo(t,0,"source",e.source,["default","server","cache"]))}function lu(t,e,n){if(e instanceof Es){if(e.firestore!==n)throw new k(R.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw es(t,"DocumentReference",1,e)}function pu(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return g()}}function du(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var vu={Firestore:Ks,GeoPoint:bs,Timestamp:O,Blob:us,Transaction:Ys,WriteBatch:Xs,DocumentReference:Qs,DocumentSnapshot:Js,Query:su,QueryDocumentSnapshot:$s,QuerySnapshot:uu,CollectionReference:au,FieldPath:cs,FieldValue:ms,setLogLevel:Ks.setLogLevel,CACHE_SIZE_UNLIMITED:Hs};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yu(t){!function(t,e){t.INTERNAL.registerComponent(new a.Component("firestore",(function(t){return function(t,e){var n=new Uo,r=new Vo(n);return new Ks(t,e,r,n)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},vu)))}(t),t.registerVersion("@firebase/firestore","1.16.6")}yu(h.default),e.__PRIVATE_registerFirestore=yu}).call(this,n("4362"))}}]);