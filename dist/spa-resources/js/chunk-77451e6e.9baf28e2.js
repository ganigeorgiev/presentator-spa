(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-77451e6e"],{"18f8":function(t,e,s){"use strict";function o(t,e,s,o,i,r,n){try{var a=t[r](n),l=a.value}catch(c){return void s(c)}a.done?e(l):Promise.resolve(l).then(o,i)}function i(t){return function(){var e=this,s=arguments;return new Promise((function(i,r){var n=t.apply(e,s);function a(t){o(n,i,r,a,l,"next",t)}function l(t){o(n,i,r,a,l,"throw",t)}a(void 0)}))}}var r=s("79e3"),n=s.n(r),a=s("dd93"),l=s("f744");e["a"]={data(){return{dropzone:null,isReplacing:!1,isReplaceHandleClickable:!0}},mounted(){n.a.autoDiscover=!1},destroyed(){this.destroyReplace()},methods:{destroyReplace(){this.isReplacing=!1,this.dropzone&&this.dropzone.destroy()},initReplace(t,e){var s=this;e=e||this.$refs.replaceHandle,this.destroyReplace(),e&&t&&t.id&&(this.dropzone=new n.a(e,{url:l["a"].$baseUrl+"/screens/"+encodeURIComponent(t.id),clickable:this.isReplaceHandleClickable,method:"put",paramName:"file",maxFiles:1,timeout:0,parallelUploads:1,uploadMultiple:!1,thumbnailWidth:null,thumbnailHeight:null,addRemoveLinks:!1,createImageThumbnails:!1,previewTemplate:'<div style="display: none"></div>',accept:function(){var e=i((function*(e,o){const i=window.URL.createObjectURL(e),r=yield a["a"].loadImage(i);window.URL.revokeObjectURL(i);const n=yield a["a"].loadImage(t.getImage("original")),l=r.width<n.width||r.height<n.height;!l||window.confirm(s.$t("Replacing could result in hotspots and comments misplacement if the new screen image has different dimensions from the original.")+"\n"+s.$t("Do you still want to proceed?"))?o():s.dropzone.removeAllFiles(!0)}));function o(t,s){return e.apply(this,arguments)}return o}()}),this.dropzone.on("addedfile",function(){var t=i((function*(t){s.dropzone.options.headers=Object.assign(s.dropzone.options.headers||{},{Authorization:"Bearer "+l["a"].$token})}));return function(e){return t.apply(this,arguments)}}()),this.dropzone.on("sending",(t,e,s)=>{this.isReplacing=!0}),this.dropzone.on("queuecomplete",()=>{this.isReplacing=!1,this.dropzone.removeAllFiles(!0)}),this.dropzone.on("success",(e,s)=>{t.load(s),this.replaceSucceeded()}),this.dropzone.on("error",(t,e,s)=>{const o=a["a"].getNestedVal(e,"errors.file",this.$t("An error occurred while uploading the screen."));this.$toast(o,"danger"),this.dropzone.removeAllFiles(!0)}))},replaceSucceeded(){}}}},"60c4":function(t,e,s){},"9d2a":function(t,e,s){"use strict";s("60c4")},a68a:function(t,e,s){"use strict";s("add5")},add5:function(t,e,s){},ce01:function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.isLoadingScreens?s("div",{staticClass:"full-page-flex"},[s("div",{staticClass:"flex-fill-block"}),t._m(0),s("div",{staticClass:"flex-fill-block"})]):t.activeScreen?s("div",{staticClass:"preview-container-wrapper"},[s("div",{ref:"previewContainer",staticClass:"preview-container",class:{"comments-mode":t.isInCommentsMode,"hotspots-mode":t.isInHotspotsMode,"preview-mode":t.isInPreviewMode,"preview-mode-hints":t.isPreviewModeHintsActive},style:{background:t.activePrototype.isForDesktop&&t.activeScreen?t.activeScreen.background:null},attrs:{tabindex:"-1"},on:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.onEscPress(e)},function(t){return(t.type.indexOf("key")||83===t.keyCode)&&t.ctrlKey?t.shiftKey||t.altKey||t.metaKey?null:void t.preventDefault():null}],keyup:function(e){return(e.type.indexOf("key")||83===e.keyCode)&&e.ctrlKey?e.shiftKey||e.altKey||e.metaKey?null:(e.preventDefault(),t.snapActiveHotspot(e)):null}}},[s("div",{staticClass:"flex-fill-block"}),s("hotspot-popover",{ref:"hotspotPopover",on:{closed:t.onHotspotPopoverClose}}),s("active-comment-popover",{ref:"commentPopover",attrs:{isForPreview:!1,mentionsList:t.mentionsList}}),s("screen-preview",{ref:"screenPreview",attrs:{interactions:t.isInPreviewMode,activeScreenTooltip:t.modeHelpTooltip,fitToScreen:t.fitToScreen},on:{activeScreenMousedown:t.onActiveScreenMousedown,activeScreenClick:t.onActiveScreenClick}},[t.isInHotspotsMode?s("div",{staticClass:"block hotspots-block"},t._l(t.activeScreenHotspots,(function(e){return s("hotspot-box",{key:e.id,ref:"hotspotBoxes",refInFor:!0,attrs:{hotspot:e,snapToImage:t.$refs.screenPreview?t.$refs.screenPreview.$refs.activeScreen:null},on:{repositioning:t.onHotspotRepositioning,repositionStopped:t.onHotspotRepositioning,beforeActivate:t.onHotspotActivate}})})),1):t._e(),t.isInCommentsMode?s("div",{staticClass:"block comments-block"},t._l(t.activeScreenComments,(function(e){return s("comment-pin",{key:e.id,ref:"screenCommentPins",refInFor:!0,class:{"soft-hidden":!t.showResolvedComments&&e.isResolved,unread:t.isCommentUnread(e.id)},attrs:{comment:e,allowPositionChange:!0},on:{repositioning:t.onCommentRepositioning}})})),1):t._e()]),s("div",{staticClass:"flex-fill-block"}),s("nav",{staticClass:"floating-bar preview-bar active",class:{"responsive-show-more":t.isResponsiveShowMoreActive}},[s("div",{staticClass:"nav nav-left"},[s("router-link",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.$t("Back to listing"),expression:"$t('Back to listing')",modifiers:{top:!0}}],staticClass:"ctrl-item ctrl-item-circle ctrl-item-close",attrs:{to:{name:"prototype",params:{projectId:t.activePrototype.projectId,prototypeId:t.activePrototype.id}}}},[s("i",{staticClass:"fe fe-arrow-left"})]),t.activeScreen&&t.$refs.screensPanel?s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.$t(t.$refs.screensPanel.isActive?"Hide screens panel":"Show screens panel"),expression:"$t($refs.screensPanel.isActive ? 'Hide screens panel' : 'Show screens panel')",modifiers:{top:!0}}],staticClass:"ctrl-item ctrl-item-screens",class:{active:t.$refs.screensPanel.isActive},on:{click:function(e){return e.preventDefault(),t.$refs.screensPanel.toggle()}}},[s("span",{staticClass:"txt screen-title"},[t._v(t._s(t.activeScreen.title))]),s("span",{staticClass:"txt counter m-l-5"},[t._v("("+t._s(t.$t("{current} of {total}",{current:t.activeScreenOrderedIndex+1,total:t.screens.length}))+")")]),s("i",{staticClass:"m-l-5 fe",class:t.$refs.screensPanel.isActive?"fe-chevron-up":"fe-chevron-down"})]):t._e()],1),s("div",{staticClass:"nav nav-center"},[s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.$t("Preview mode ({shortcut})",{shortcut:"P"}),expression:"$t('Preview mode ({shortcut})', {shortcut: 'P'})",modifiers:{top:!0}},{name:"shortcut",rawName:"v-shortcut.80",value:t.setPreviewMode,expression:"setPreviewMode",modifiers:{80:!0}}],staticClass:"ctrl-item ctrl-item-circle ctrl-item-success",class:{highlight:t.isInPreviewMode},on:{click:function(e){return e.preventDefault(),t.setPreviewMode()}}},[s("i",{staticClass:"fe fe-eye"})]),s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.$t("Hotspots mode ({shortcut})",{shortcut:"H"}),expression:"$t('Hotspots mode ({shortcut})', {shortcut: 'H'})",modifiers:{top:!0}},{name:"shortcut",rawName:"v-shortcut.72",value:t.setHotspotsMode,expression:"setHotspotsMode",modifiers:{72:!0}}],staticClass:"ctrl-item ctrl-item-circle ctrl-item-primary",class:{highlight:t.isInHotspotsMode},on:{click:function(e){return e.preventDefault(),t.setHotspotsMode()}}},[t.isLoadingHotspots||t.isLoadingHotspotTemplates?s("span",{staticClass:"loader"}):s("i",{staticClass:"fe fe-target"})]),s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.$t("Comments mode ({shortcut})",{shortcut:"C"}),expression:"$t('Comments mode ({shortcut})', {shortcut: 'C'})",modifiers:{top:!0}},{name:"shortcut",rawName:"v-shortcut.67",value:t.setCommentsMode,expression:"setCommentsMode",modifiers:{67:!0}}],staticClass:"ctrl-item ctrl-item-circle ctrl-item-danger",class:{highlight:t.isInCommentsMode},on:{click:function(e){return e.preventDefault(),t.setCommentsMode()}}},[!t.isLoadingComments&&t.totalActiveScreenUnresolvedComments>0?s("span",{staticClass:"pin",class:{animate:t.totalActiveScreenUnreadComments>0}},[t._v(" "+t._s(t.totalActiveScreenUnresolvedComments)+" ")]):t._e(),t.isLoadingComments?s("span",{staticClass:"loader"}):s("i",{staticClass:"fe fe-message-circle"})]),s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.$t("More tools"),expression:"$t('More tools')",modifiers:{top:!0}}],staticClass:"ctrl-item ctrl-item-circle ctrl-item-responsive-show-more responsive-only",on:{click:function(e){return e.preventDefault(),t.responsiveShowMore(e)}}},[s("i",{staticClass:"fe fe-more-horizontal"})])]),s("div",{staticClass:"nav nav-right"},[t.isInCommentsMode&&t.$refs.commentsPanel?s("button",{staticClass:"btn btn-sm no-shadow comments-panel-toggle",class:t.$refs.commentsPanel.isActive?"btn-danger":"btn-transp-danger",on:{click:function(e){return e.preventDefault(),t.$refs.commentsPanel.toggle()}}},[s("span",{staticClass:"txt"},[t._v(t._s(t.$t("Comments panel")))])]):t._e(),t.isInHotspotsMode?s("div",{staticClass:"ctrl-item ctrl-item-templates txt-default"},[s("span",{staticClass:"txt title m-r-5"},[t._v(" "+t._s(t.$tc("0 Active hotspot templates | 1 Active hotspot template | {count} Active hotspot templates",t.totalActiveHotspotTemplates))+" ")]),s("i",{staticClass:"fe fe-chevron-up"}),s("hotspot-templates-popover",{staticClass:"transform-bottom-right",attrs:{screen:t.activeScreen}})],1):t._e(),0!=t.activePrototype.scaleFactor?s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.$t("Toggle fit to screen"),expression:"$t('Toggle fit to screen')",modifiers:{top:!0}}],staticClass:"ctrl-item ctrl-item-circle",class:t.fitToScreen?"ctrl-item-success active bg-light-border":"",on:{click:function(e){return e.preventDefault(),t.toggleFitToScreen(e)}}},[s("i",{staticClass:"fe fe-maximize"})]):t._e(),s("div",{staticClass:"ctrl-item ctrl-item-circle"},[s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.$t("Screen settings"),expression:"$t('Screen settings')",modifiers:{top:!0}}]},[t.$refs.screenEditPopover&&t.$refs.screenEditPopover.isProcessing?s("span",{staticClass:"loader"}):s("i",{staticClass:"fe fe-settings"})]),s("screen-edit-popover",{ref:"screenEditPopover",staticClass:"transform-bottom-right",attrs:{screen:t.activeScreen}})],1),s("div",{staticClass:"flex-fill-block responsive-only"}),s("div",{staticClass:"ctrl-item ctrl-item-circle ctrl-item-responsive-hide-more responsive-only",on:{click:function(e){return e.preventDefault(),t.responsiveHideMore(e)}}},[s("i",{staticClass:"fe fe-x"})])])]),s("screens-panel",{ref:"screensPanel"})],1),s("comments-panel",{ref:"commentsPanel"})],1):t._e()},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"block txt-center"},[s("span",{staticClass:"loader loader-lg loader-blend"})])}],r=(s("ac6a"),s("a481"),s("097d"),s("ade3")),n=s("2f62"),a=s("f744"),l=s("dd93"),c=s("0372"),p=s("9aaf"),d=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("toggler",{ref:"popover",staticClass:"popover screen-edit-popover",attrs:{tag:"form",hideOnChildClick:!1},nativeOn:{submit:function(e){return e.preventDefault(),t.saveChanges()}}},[s("form-field",{attrs:{name:"title"}},[s("label",{attrs:{for:"screen_title"}},[t._v(t._s(t.$t("Title")))]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.screen.title,expression:"screen.title",modifiers:{trim:!0}}],attrs:{type:"text",id:"screen_title",maxlength:"255",required:""},domProps:{value:t.screen.title},on:{change:function(e){return t.saveChanges()},input:function(e){e.target.composing||t.$set(t.screen,"title",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),s("div",{staticClass:"row"},[s("div",{staticClass:"col-6"},[s("div",{staticClass:"form-group form-group"},[s("label",{attrs:{for:"screen_alignment"}},[s("span",{staticClass:"txt"},[t._v(t._s(t.$t("Alignment")))]),s("screen-bulk-setting-handle",{attrs:{screen:t.screen,setting:"alignment"}})],1),s("div",{staticClass:"switch-group"},[s("div",{staticClass:"switch"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.screen.alignment,expression:"screen.alignment"}],attrs:{type:"radio",value:"left",id:"screen_alignment_radio_left"},domProps:{checked:t._q(t.screen.alignment,"left")},on:{change:[function(e){return t.$set(t.screen,"alignment","left")},function(e){return t.saveChanges()}]}}),s("label",{attrs:{for:"screen_alignment_radio_left"}},[t._v(t._s(t.$t("Left")))])]),s("div",{staticClass:"switch"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.screen.alignment,expression:"screen.alignment"}],attrs:{type:"radio",value:"center",id:"screen_alignment_radio_center"},domProps:{checked:t._q(t.screen.alignment,"center")},on:{change:[function(e){return t.$set(t.screen,"alignment","center")},function(e){return t.saveChanges()}]}}),s("label",{attrs:{for:"screen_alignment_radio_center"}},[t._v(t._s(t.$t("Center")))])]),s("div",{staticClass:"switch"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.screen.alignment,expression:"screen.alignment"}],attrs:{type:"radio",value:"right",id:"screen_alignment_radio_right"},domProps:{checked:t._q(t.screen.alignment,"right")},on:{change:[function(e){return t.$set(t.screen,"alignment","right")},function(e){return t.saveChanges()}]}}),s("label",{attrs:{for:"screen_alignment_radio_right"}},[t._v(t._s(t.$t("Right")))])])])])]),s("div",{staticClass:"col-6"},[s("form-field",{attrs:{name:"background"}},[s("label",{attrs:{for:"screen_background"}},[s("span",{staticClass:"txt"},[t._v(t._s(t.$t("Background")))]),s("screen-bulk-setting-handle",{attrs:{screen:t.screen,setting:"background"}})],1),s("div",{staticClass:"input-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.screen.background,expression:"screen.background"}],attrs:{type:"color",id:"screen_background"},domProps:{value:t.screen.background},on:{change:function(e){return t.saveChanges()},input:function(e){e.target.composing||t.$set(t.screen,"background",e.target.value)}}}),s("label",{staticClass:"input-addon txt-monospace p-l-0",attrs:{for:"screen_background"}},[t._v(t._s(t.screen.background))])])])],1)]),s("div",{staticClass:"row align-items-center"},[s("div",{staticClass:"col-6"},[s("div",{staticClass:"form-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.hasFixedHeader,expression:"hasFixedHeader"}],attrs:{type:"checkbox",id:"screen_fixed_header_check"},domProps:{checked:Array.isArray(t.hasFixedHeader)?t._i(t.hasFixedHeader,null)>-1:t.hasFixedHeader},on:{change:[function(e){var s=t.hasFixedHeader,o=e.target,i=!!o.checked;if(Array.isArray(s)){var r=null,n=t._i(s,r);o.checked?n<0&&(t.hasFixedHeader=s.concat([r])):n>-1&&(t.hasFixedHeader=s.slice(0,n).concat(s.slice(n+1)))}else t.hasFixedHeader=i},function(e){return t.onFixedHeaderToggleChange()}]}}),s("label",{attrs:{for:"screen_fixed_header_check"}},[s("span",{staticClass:"txt"},[t._v(t._s(t.$t("Has fixed header")))]),s("screen-bulk-setting-handle",{attrs:{screen:t.screen,setting:"fixedHeader"}})],1)])]),s("div",{staticClass:"col-6"},[s("form-field",{directives:[{name:"show",rawName:"v-show",value:t.hasFixedHeader,expression:"hasFixedHeader"}],staticClass:"form-group-sm",attrs:{name:"fixedHeader"}},[s("div",{staticClass:"input-group"},[s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.screen.fixedHeader,expression:"screen.fixedHeader",modifiers:{number:!0}}],attrs:{type:"number",min:"0"},domProps:{value:t.screen.fixedHeader},on:{change:function(e){return t.saveChanges()},input:function(e){e.target.composing||t.$set(t.screen,"fixedHeader",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),s("div",{staticClass:"input-addon"},[t._v("px")])])])],1)]),s("div",{staticClass:"row align-items-center"},[s("div",{staticClass:"col-6"},[s("div",{staticClass:"form-group m-b-0"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.hasFixedFooter,expression:"hasFixedFooter"}],attrs:{type:"checkbox",id:"screen_fixed_footer_check"},domProps:{checked:Array.isArray(t.hasFixedFooter)?t._i(t.hasFixedFooter,null)>-1:t.hasFixedFooter},on:{change:[function(e){var s=t.hasFixedFooter,o=e.target,i=!!o.checked;if(Array.isArray(s)){var r=null,n=t._i(s,r);o.checked?n<0&&(t.hasFixedFooter=s.concat([r])):n>-1&&(t.hasFixedFooter=s.slice(0,n).concat(s.slice(n+1)))}else t.hasFixedFooter=i},function(e){return t.onFixedFooterToggleChange()}]}}),s("label",{attrs:{for:"screen_fixed_footer_check"}},[s("span",{staticClass:"txt"},[t._v(t._s(t.$t("Has fixed footer")))]),s("screen-bulk-setting-handle",{attrs:{screen:t.screen,setting:"fixedFooter"}})],1)])]),s("div",{staticClass:"col-6"},[s("form-field",{directives:[{name:"show",rawName:"v-show",value:t.hasFixedFooter,expression:"hasFixedFooter"}],staticClass:"form-group-sm m-b-0",attrs:{name:"fixedFooter"}},[s("div",{staticClass:"input-group"},[s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.screen.fixedFooter,expression:"screen.fixedFooter",modifiers:{number:!0}}],attrs:{type:"number",min:"0"},domProps:{value:t.screen.fixedFooter},on:{change:function(e){return t.saveChanges()},input:function(e){e.target.composing||t.$set(t.screen,"fixedFooter",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),s("div",{staticClass:"input-addon"},[t._v("px")])])])],1)]),s("hr",{staticClass:"m-t-20 m-b-20"}),s("div",{staticClass:"flex-block"},[s("div",{staticClass:"flex-fill-block txt-left"},[t.isReplacing?s("span",{staticClass:"loader txt-hint"}):s("span",{ref:"replaceHandle",staticClass:"link-hint"},[t._v(t._s(t.$t("Replace screen")))])])])],1)},h=[],m=s("2714"),u=s("18f8"),v=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.$t("Apply to all screens"),expression:"$t('Apply to all screens')",modifiers:{top:!0}}],staticClass:"m-l-5",class:t.isProcessing?"txt-fade":"link-primary",on:{click:function(e){return e.preventDefault(),t.bulkApply()}}},[s("i",{staticClass:"fe fe-copy"})])},f=[];function g(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,o)}return s}function b(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?g(Object(s),!0).forEach((function(e){Object(r["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):g(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var y={name:"screen-bulk-setting-handle",props:{screen:{type:m["a"],required:!0},setting:{type:String,required:!0}},data(){return{isProcessing:!1}},computed:b({},Object(n["d"])({screens:t=>t.screens.screens})),methods:{bulkApply(){if(this.isProcessing||"undefined"==typeof this.screen[this.setting])return;this.isProcessing=!0;const t={prototypeId:this.screen.prototypeId};t[this.setting]=this.screen[this.setting],a["a"].enableAutoCancellation(!1),a["a"].Screens.bulkUpdate(t).then(t=>{for(let e=this.screens.length-1;e>=0;e--)this.$set(this.screens[e],this.setting,this.screen[this.setting]);this.$toast("Successfully updated all screens.")}).catch(t=>{this.$errResponseHandler(t)}).finally(()=>{this.isProcessing=!1})}}},_=y,w=s("2877"),C=Object(w["a"])(_,v,f,!1,null,null,null),$=C.exports;function x(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,o)}return s}function P(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?x(Object(s),!0).forEach((function(e){Object(r["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):x(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var O={name:"screen-edit-popover",mixins:[u["a"]],components:{"screen-bulk-setting-handle":$},props:{screen:{type:m["a"],required:!0}},data(){return{isProcessing:!1,hasFixedHeader:!1,hasFixedFooter:!1}},watch:{screen(t,e){this.initForm(),this.initReplace(this.screen)}},mounted(){this.initForm(),this.initReplace(this.screen)},methods:P(P({},Object(n["b"])({setErrors:"form-field/setErrors"})),{},{replaceSucceeded(){this.$refs.popover&&this.$refs.popover.hide(),this.$emit("updated",this.screen.id)},initForm(){this.setErrors({}),this.hasFixedHeader=this.screen.fixedHeader>0,this.hasFixedFooter=this.screen.fixedFooter>0},onFixedHeaderToggleChange(){!this.hasFixedHeader&&this.screen.fixedHeader>0&&(this.screen.fixedHeader=0,this.saveChanges())},onFixedFooterToggleChange(){!this.hasFixedFooter&&this.screen.fixedFooter>0&&(this.screen.fixedFooter=0,this.saveChanges())},saveChanges(){if(!this.isProcessing){this.isProcessing=!0;var t=this.screen;a["a"].Screens.update(t.id,{title:t.title,background:t.background,alignment:t.alignment,fixedHeader:this.hasFixedHeader?t.fixedHeader:0,fixedFooter:this.hasFixedFooter?t.fixedFooter:0}).then(e=>{t.load(e.data),this.setErrors({}),this.$emit("updated",t.id)}).catch(t=>{this.$errResponseHandler(t),this.$refs.popover&&!this.$refs.popover.isActive&&this.$refs.popover.show()}).finally(()=>{this.isProcessing=!1})}}})},T=O,k=(s("a68a"),Object(w["a"])(T,d,h,!1,null,"d6a507ea",null)),H=k.exports,S=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("dragger",{staticClass:"hotspot",class:{new:!t.hotspot.id,highlight:t.hotspot.hotspotTemplateId>0,active:t.isActive},style:{left:t.hotspot.left*t.scaleFactor+"px",top:t.hotspot.top*t.scaleFactor+"px",width:t.hotspot.width*t.scaleFactor+"px",height:t.hotspot.height*t.scaleFactor+"px"},attrs:{wrapperSelector:".screen-inner-wrapper"},on:{dragging:t.onRepositioning,dragStarted:t.onRepositionStart,dragStopped:t.onRepositionStop},nativeOn:{click:function(e){return e.preventDefault(),t.activate()}}},[s("resizer",{ref:"resizeHandle",staticClass:"resize-handle",attrs:{wrapperSelector:".screen-inner-wrapper",containerSelector:".hotspot",tolerance:0},on:{resizing:t.onRepositioning,resizeStarted:t.onRepositionStart,resizeStopped:t.onRepositionStop}})],1)},I=[],j=s("82bb"),A=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{on:{mousedown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])||"button"in e&&0!==e.button?null:t.dragInit(e)},touchstart:t.dragInit}},[t._t("default")],2)},F=[],R={name:"resizer",props:{containerSelector:{type:String},wrapperSelector:{type:String},tolerance:{type:Number,default:5}},data(){return{resizeStarted:!1,lockX:!1,lockY:!1,startX:0,startY:0,initialContainerX:0,initialContainerY:0,initialContainerWidth:0,initialContainerHeight:0,initialWrapperWidth:0,initialWrapperHeight:0}},computed:{container(){return this.$el.closest(this.containerSelector)||this.$el.parentNode},wrapper(){return this.container.closest(this.wrapperSelector)||this.container.parentNode}},methods:{dragInit(t){t.stopPropagation(),this.startX=t.clientX,this.startY=t.clientY,this.initialContainerX=this.container.offsetLeft,this.initialContainerY=this.container.offsetTop,this.initialContainerWidth=this.container.offsetWidth,this.initialContainerHeight=this.container.offsetHeight,this.initialWrapperWidth=this.wrapper.scrollWidth||this.wrapper.offsetWidth,this.initialWrapperHeight=this.wrapper.scrollHeight||this.wrapper.offsetHeight,document.addEventListener("touchmove",this.onMove),document.addEventListener("mousemove",this.onMove),document.addEventListener("touchend",this.onDrop),document.addEventListener("mouseup",this.onDrop)},onMove(t){let e=t.clientX-this.startX,s=t.clientY-this.startY,o=null,i=null,r=null,n=null;!this.resizeStarted&&Math.abs(e)<this.tolerance&&Math.abs(s)<this.tolerance||(t.preventDefault(),this.resizeStarted||(this.resizeStarted=!0,this.container.classList.add("no-pointer-events"),this.wrapper.classList.add("resizing"),document.body.classList.add("resizer-active"),this.$emit("resizeStarted",t)),this.$emit("resizing",t),t.shiftKey?this.lockX||this.lockY||(Math.abs(e)>Math.abs(s)?(this.lockX=!1,this.lockY=!0):(this.lockX=!0,this.lockY=!1)):(this.lockX=!1,this.lockY=!1),this.lockX||(e<0&&e<-this.initialContainerWidth?(r=-(this.initialContainerWidth+e),o=this.initialContainerX-r,o<0&&(o=null,r=null)):(r=this.initialContainerWidth+e,r+this.initialContainerX>this.initialWrapperWidth&&(r=null,o=null))),this.lockY||(s<0&&s<-this.initialContainerHeight?(n=-(this.initialContainerHeight+s),i=this.initialContainerY-n,i<0&&(i=null,n=null)):(n=this.initialContainerHeight+s,n+this.initialContainerY>this.initialWrapperHeight&&(n=null,i=null))),null!==o&&(this.container.style.left=o+"px"),null!==r&&(this.container.style.width=r+"px"),null!==i&&(this.container.style.top=i+"px"),null!==n&&(this.container.style.height=n+"px"))},onDrop(t){this.resizeStarted&&(t.preventDefault(),this.resizeStarted=!1,this.lockX=!1,this.lockY=!1,this.container.classList.remove("no-pointer-events"),this.wrapper.classList.remove("resizing"),document.body.classList.remove("resizer-active"),this.$emit("resizeStopped",t)),document.removeEventListener("touchmove",this.onMove),document.removeEventListener("mousemove",this.onMove),document.removeEventListener("touchend",this.onDrop),document.removeEventListener("mouseup",this.onDrop)}}},L=R,D=Object(w["a"])(L,A,F,!1,null,null,null),N=D.exports,M=s("49cb");function E(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,o)}return s}function z(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?E(Object(s),!0).forEach((function(e){Object(r["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):E(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var B={name:"hotspot-box",components:{dragger:j["a"],resizer:N},props:{hotspot:{type:M["a"],required:!0},snapToImage:{}},data(){return{isActive:!1}},computed:z({},Object(n["d"])({scaleFactor:t=>t.screens.scaleFactor})),methods:{activate(){this.isActive||(this.$emit("beforeActivate",this.hotspot,this.$el),this.isActive=!0,this.positionWithinView(),this.$emit("activated",this.hotspot,this.$el))},deactivate(){this.isActive&&(this.$emit("beforeDeactivate",this.hotspot,this.$el),this.isActive=!1,this.hotspot.id||this.$emit("hotspotDeleted",this.hotspot,this.$el),this.$emit("deactivated",this.hotspot,this.$el))},positionWithinView(){this.$el.scrollIntoView({behavior:"smooth",block:"nearest"})},initResizing(t){this.$refs.resizeHandle.dragInit(t),this.$refs.resizeHandle.onMove(t)},onRepositionStart(t){this.$emit("repositionStarted",this.hotspot,this.$el)},onRepositioning(t){this.$emit("repositioning",this.hotspot,this.$el)},onRepositionStop(t){this.$set(this.hotspot,"left",Math.max(this.$el.offsetLeft,0)/this.scaleFactor),this.$set(this.hotspot,"top",Math.max(this.$el.offsetTop,0)/this.scaleFactor),this.$set(this.hotspot,"width",this.$el.offsetWidth/this.scaleFactor),this.$set(this.hotspot,"height",this.$el.offsetHeight/this.scaleFactor),t.ctrlKey?this.$nextTick(()=>{this.snap()}):this.savePosition(),this.$emit("repositionStopped",this.hotspot,this.$el)},snap(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.snapToImage){let t=l["a"].closestFeatureEdge(this.snapToImage,{x:this.hotspot.left,y:this.hotspot.top,w:this.hotspot.width,h:this.hotspot.height});this.$set(this.hotspot,"left",t.x+this.hotspot.left),this.$set(this.hotspot,"top",t.y+this.hotspot.top),this.$set(this.hotspot,"width",t.w),this.$set(this.hotspot,"height",t.h),this.$emit("repositionStopped",this.hotspot,this.$el)}t&&this.savePosition()},savePosition(){this.hotspot.id&&(this.$emit("hotspotUpdated",this.hotspot,this.$el),a["a"].Hotspots.update(this.hotspot.id,{width:this.hotspot.width,height:this.hotspot.height,left:this.hotspot.left,top:this.hotspot.top}).then(t=>{this.hotspot.load(t.data)}))}}},U=B,W=Object(w["a"])(U,S,I,!1,null,null,null),q=W.exports,V=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"popover-holder hotspot-popover-holder"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.isActive,expression:"isActive"}],staticClass:"popover-overlay",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.close()}}}),s("div",{ref:"popover",staticClass:"popover hotspot-popover",class:{active:t.isActive}},[s("form",{on:{submit:function(e){return e.preventDefault(),t.submitForm()}}},[s("form-field",{attrs:{name:"type"}},[s("div",{staticClass:"input-group"},[s("label",{staticClass:"input-addon bg-border txt-default"},[t._v(t._s(t.$t("Link to")))]),s("select",{directives:[{name:"model",rawName:"v-model",value:t.type,expression:"type"}],attrs:{id:"hotspot_type_"+t.hotspot.id,required:""},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.type=e.target.multiple?s:s[0]}}},[s("option",{attrs:{value:"screen"}},[t._v(t._s(t.$t("Screen")))]),s("option",{attrs:{value:"overlay"}},[t._v(t._s(t.$t("Screen as overlay")))]),s("option",{attrs:{value:"prev"}},[t._v(t._s(t.$t("Prev screen in series")))]),s("option",{attrs:{value:"next"}},[t._v(t._s(t.$t("Next screen in series")))]),s("option",{attrs:{value:"back"}},[t._v(t._s(t.$t("Back (last visited screen)")))]),s("option",{attrs:{value:"scroll"}},[t._v(t._s(t.$t("Position (scroll to)")))]),t.$getAppConfig("VUE_APP_ALLOW_HOTSPOTS_URL")<<0?s("option",{attrs:{value:"url"}},[t._v(t._s(t.$t("External URL")))]):t._e()])])]),s("form-field",{directives:[{name:"show",rawName:"v-show",value:"screen"===t.type||"overlay"===t.type,expression:"type === 'screen' || type === 'overlay'"}],attrs:{name:"settingScreenId"}},[s("label",[t._v(t._s(t.$t("Screen")))]),s("div",{staticClass:"btn btn-block btn-light-border btn-dropdown",attrs:{tabindex:"0"},on:{keydown:[function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"space",32,e.key,[" ","Spacebar"]))return null;e.preventDefault(),!t.$refs.screensDropdown||t.$refs.screensDropdown.show()},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault(),!t.$refs.screensDropdown||t.$refs.screensDropdown.toggle()}]}},[s("span",{staticClass:"txt"},[t._v(t._s(t.selectedScreen?t.selectedScreen.title:t.$t("Select a screen...")))]),s("toggler",{ref:"screensDropdown",staticClass:"dropdown dropdown-thumbs-list",on:{show:t.onScreensDropdownShow}},t._l(t.orderedScreens,(function(e){return s("figure",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.title,expression:"screen.title",modifiers:{top:!0}}],key:"hotspot_screen_"+e.id,staticClass:"thumb thumb-handle",class:{active:e.id==t.screenId},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.selectScreen(e.id)}}},[e.getImage("small")?s("img",{staticClass:"img",attrs:{src:e.getImage("small"),alt:e.title}}):s("i",{staticClass:"fe fe-image img"})])})),0)],1)]),s("div",{staticClass:"row"},[s("div",{directives:[{name:"show",rawName:"v-show",value:"overlay"===t.type,expression:"type === 'overlay'"}],staticClass:"col-6"},[s("form-field",{attrs:{name:"settingOverlayPosition"}},[s("label",{attrs:{for:"hotspot_screen_overlay_position_"+t.hotspot.id}},[t._v(t._s(t.$t("Position")))]),s("select",{directives:[{name:"model",rawName:"v-model",value:t.overlayPosition,expression:"overlayPosition"}],attrs:{id:"hotspot_screen_overlay_position_"+t.hotspot.id},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.overlayPosition=e.target.multiple?s:s[0]}}},[s("option",{attrs:{value:"centered"}},[t._v(t._s(t.$t("Centered")))]),s("option",{attrs:{value:"top-left"}},[t._v(t._s(t.$t("Top Left")))]),s("option",{attrs:{value:"top-center"}},[t._v(t._s(t.$t("Top Center")))]),s("option",{attrs:{value:"top-right"}},[t._v(t._s(t.$t("Top Right")))]),s("option",{attrs:{value:"bottom-left"}},[t._v(t._s(t.$t("Bottom Left")))]),s("option",{attrs:{value:"bottom-center"}},[t._v(t._s(t.$t("Bottom Center")))]),s("option",{attrs:{value:"bottom-right"}},[t._v(t._s(t.$t("Bottom Right")))])])])],1),s("div",{directives:[{name:"show",rawName:"v-show",value:"url"!==t.type&&"scroll"!==t.type,expression:"type !== 'url' && type !== 'scroll'"}],class:"overlay"===t.type?"col-6":"col-12"},[s("form-field",{attrs:{name:"settingTransition"}},[s("label",{attrs:{for:"hotspot_transition_"+t.hotspot.id}},[t._v(t._s(t.$t("Transition")))]),s("select",{directives:[{name:"model",rawName:"v-model",value:t.transition,expression:"transition"}],attrs:{id:"hotspot_transition_"+t.hotspot.id},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.transition=e.target.multiple?s:s[0]}}},[s("option",{attrs:{value:"none"}},[t._v(t._s(t.$t("None")))]),s("option",{attrs:{value:"fade"}},[t._v(t._s(t.$t("Fade")))]),s("option",{attrs:{value:"slide-left"}},[t._v(t._s(t.$t("Slide left")))]),s("option",{attrs:{value:"slide-right"}},[t._v(t._s(t.$t("Slide right")))]),s("option",{attrs:{value:"slide-top"}},[t._v(t._s(t.$t("Slide top")))]),s("option",{attrs:{value:"slide-bottom"}},[t._v(t._s(t.$t("Slide bottom")))])])])],1)]),s("div",{directives:[{name:"show",rawName:"v-show",value:"overlay"===t.type,expression:"type === 'overlay'"}],staticClass:"form-group form-group-sm"},[s("label",[t._v(t._s(t.$t("Offset"))+" "),s("small",{staticClass:"txt-hint"},[t._v("(px)")])]),s("div",{staticClass:"input-group"},[s("div",{staticClass:"input-addon bg-light-border"},[t._v("T")]),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.offsetTop,expression:"offsetTop",modifiers:{number:!0}},{name:"tooltip",rawName:"v-tooltip.bottom",value:t.$t("Top offset"),expression:"$t('Top offset')",modifiers:{bottom:!0}}],attrs:{type:"number"},domProps:{value:t.offsetTop},on:{input:function(e){e.target.composing||(t.offsetTop=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),s("div",{staticClass:"input-addon bg-light-border"},[t._v("B")]),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.offsetBottom,expression:"offsetBottom",modifiers:{number:!0}},{name:"tooltip",rawName:"v-tooltip.bottom",value:t.$t("Bottom offset"),expression:"$t('Bottom offset')",modifiers:{bottom:!0}}],attrs:{type:"number"},domProps:{value:t.offsetBottom},on:{input:function(e){e.target.composing||(t.offsetBottom=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),s("div",{staticClass:"input-addon bg-light-border"},[t._v("L")]),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.offsetLeft,expression:"offsetLeft",modifiers:{number:!0}},{name:"tooltip",rawName:"v-tooltip.bottom",value:t.$t("Left offset"),expression:"$t('Left offset')",modifiers:{bottom:!0}}],attrs:{type:"number"},domProps:{value:t.offsetLeft},on:{input:function(e){e.target.composing||(t.offsetLeft=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),s("div",{staticClass:"input-addon bg-light-border"},[t._v("R")]),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.offsetRight,expression:"offsetRight",modifiers:{number:!0}},{name:"tooltip",rawName:"v-tooltip.bottom",value:t.$t("Right offset"),expression:"$t('Right offset')",modifiers:{bottom:!0}}],attrs:{type:"number"},domProps:{value:t.offsetRight},on:{input:function(e){e.target.composing||(t.offsetRight=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]),s("div",{directives:[{name:"show",rawName:"v-show",value:"scroll"===t.type,expression:"type === 'scroll'"}],staticClass:"row"},[s("div",{staticClass:"col-6"},[s("form-field",{attrs:{name:"settingScrollTop"}},[s("label",{attrs:{for:"hotspot_scroll_top_"+t.hotspot.id}},[t._v(t._s(t.$t("Vertical position")))]),s("div",{staticClass:"input-group"},[s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.scrollTop,expression:"scrollTop",modifiers:{number:!0}}],attrs:{type:"number",id:"hotspot_scroll_top_"+t.hotspot.id,min:"0"},domProps:{value:t.scrollTop},on:{input:function(e){e.target.composing||(t.scrollTop=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),s("div",{staticClass:"input-addon"},[t._v("px")])])])],1),s("div",{staticClass:"col-6"},[s("form-field",{attrs:{name:"settingScrollLeft"}},[s("label",{attrs:{for:"hotspot_scroll_left_"+t.hotspot.id}},[t._v(t._s(t.$t("Horizontal position")))]),s("div",{staticClass:"input-group"},[s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.scrollLeft,expression:"scrollLeft",modifiers:{number:!0}}],attrs:{type:"number",id:"hotspot_scroll_left_"+t.hotspot.id,min:"0"},domProps:{value:t.scrollLeft},on:{input:function(e){e.target.composing||(t.scrollLeft=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),s("div",{staticClass:"input-addon"},[t._v("px")])])])],1)]),s("form-field",{directives:[{name:"show",rawName:"v-show",value:"overlay"===t.type,expression:"type === 'overlay'"}],attrs:{name:"settingFixOverlay"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.fixOverlay,expression:"fixOverlay"}],attrs:{type:"checkbox",id:"hotspot_screen_overlay_fix_position"+t.hotspot.id},domProps:{checked:Array.isArray(t.fixOverlay)?t._i(t.fixOverlay,null)>-1:t.fixOverlay},on:{change:function(e){var s=t.fixOverlay,o=e.target,i=!!o.checked;if(Array.isArray(s)){var r=null,n=t._i(s,r);o.checked?n<0&&(t.fixOverlay=s.concat([r])):n>-1&&(t.fixOverlay=s.slice(0,n).concat(s.slice(n+1)))}else t.fixOverlay=i}}}),s("label",{attrs:{for:"hotspot_screen_overlay_fix_position"+t.hotspot.id}},[t._v(t._s(t.$t("Fix position of overlay")))])]),s("form-field",{directives:[{name:"show",rawName:"v-show",value:"overlay"===t.type,expression:"type === 'overlay'"}],attrs:{name:"settingOutsideClose"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.outsideClose,expression:"outsideClose"}],attrs:{type:"checkbox",id:"hotspot_screen_overlay_outside_click_"+t.hotspot.id},domProps:{checked:Array.isArray(t.outsideClose)?t._i(t.outsideClose,null)>-1:t.outsideClose},on:{change:function(e){var s=t.outsideClose,o=e.target,i=!!o.checked;if(Array.isArray(s)){var r=null,n=t._i(s,r);o.checked?n<0&&(t.outsideClose=s.concat([r])):n>-1&&(t.outsideClose=s.slice(0,n).concat(s.slice(n+1)))}else t.outsideClose=i}}}),s("label",{attrs:{for:"hotspot_screen_overlay_outside_click_"+t.hotspot.id}},[t._v(t._s(t.$t("Close on outside click")))])]),t.$getAppConfig("VUE_APP_ALLOW_HOTSPOTS_URL")<<0?s("form-field",{directives:[{name:"show",rawName:"v-show",value:"url"===t.type,expression:"type === 'url'"}],attrs:{name:"settingUrl"}},[s("label",{attrs:{for:"hotspot_external_url_"+t.hotspot.id}},[t._v("URL")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.url,expression:"url"}],attrs:{type:"url",id:"hotspot_external_url_"+t.hotspot.id,placeholder:t.$t("eg.")+" https://google.com"},domProps:{value:t.url},on:{input:function(e){e.target.composing||(t.url=e.target.value)}}})]):t._e(),s("div",{staticClass:"form-group m-b-10"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.includeInTemplate,expression:"includeInTemplate"}],attrs:{type:"checkbox",id:"hotspot_include_in_template_toggle_"+t.hotspot.id},domProps:{checked:Array.isArray(t.includeInTemplate)?t._i(t.includeInTemplate,null)>-1:t.includeInTemplate},on:{change:function(e){var s=t.includeInTemplate,o=e.target,i=!!o.checked;if(Array.isArray(s)){var r=null,n=t._i(s,r);o.checked?n<0&&(t.includeInTemplate=s.concat([r])):n>-1&&(t.includeInTemplate=s.slice(0,n).concat(s.slice(n+1)))}else t.includeInTemplate=i}}}),s("label",{attrs:{for:"hotspot_include_in_template_toggle_"+t.hotspot.id}},[s("span",{staticClass:"txt"},[t._v(t._s(t.$t("Include in template")))]),s("i",{directives:[{name:"tooltip",rawName:"v-tooltip.right",value:t.$t("Allows reusing the hotspot in other screens"),expression:"$t('Allows reusing the hotspot in other screens')",modifiers:{right:!0}}],staticClass:"fe fe-info link-hint m-l-5"})])]),t.includeInTemplate?s("div",{staticClass:"form-group-section m-b-0"},[s("div",{staticClass:"form-group form-group-sm",class:{"m-b-5":"new"===t.template}},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.template,expression:"template"}],on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.template=e.target.multiple?s:s[0]}}},[t._l(t.hotspotTemplates,(function(e){return s("option",{domProps:{value:e.id}},[t._v(" "+t._s(e.title)+" ")])})),s("option",{attrs:{value:"new"}},[t._v("+ "+t._s(t.$t("New template")))])],2)]),"new"===t.template?s("div",{staticClass:"form-group form-group-sm"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.newTemplateTitle,expression:"newTemplateTitle",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:t.$t("Template name")+" *",required:"",minlength:"1",maxlength:"255"},domProps:{value:t.newTemplateTitle},on:{input:function(e){e.target.composing||(t.newTemplateTitle=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]):t._e()]):t._e(),s("hr",{staticClass:"m-t-20 m-b-20"}),s("div",{staticClass:"flex-block"},[s("button",{staticClass:"btn btn-light-border",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.close()}}},[s("span",{staticClass:"txt"},[t._v(t._s(t.$t("Cancel")))])]),t.hotspot.id?s("span",{staticClass:"link-fade txt-danger m-l-small",on:{click:function(e){return e.preventDefault(),t.deleteHotspot()}}},[t._v(" "+t._s(t.$t("Delete"))+" ")]):t._e(),s("div",{staticClass:"flex-fill-block"}),s("button",{staticClass:"btn btn-primary btn-cons-sm btn-loader",class:{"btn-loader-active":t.isProcessing},attrs:{type:"submit"}},[s("span",{staticClass:"txt"},[t._v(t._s(t.hotspot.id?t.$t("Update"):t.$t("Create")))])])])],1)])])},X=[];function Y(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,o)}return s}function K(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?Y(Object(s),!0).forEach((function(e){Object(r["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Y(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var J={name:"hotspot-popover",data(){return{isActive:!1,repositionToElem:null,hotspot:new M["a"],isProcessing:!1,type:"screen",screenId:null,url:"",transition:"none",overlayPosition:"top-left",fixOverlay:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,outsideClose:!0,scrollTop:0,scrollLeft:0,includeInTemplate:!1,template:1,isCreatingHotspotTemplate:!1,newTemplateTitle:""}},computed:K(K(K({},Object(n["d"])({activePrototypeId:t=>t.prototypes.activePrototypeId,activeScreenId:t=>t.screens.activeScreenId,hotspots:t=>t.hotspots.hotspots,hotspotTemplates:t=>t.hotspots.hotspotTemplates})),Object(n["c"])({orderedScreens:"screens/orderedScreens",getScreen:"screens/getScreen",getHotspot:"hotspots/getHotspot",getHotspotTemplate:"hotspots/getHotspotTemplate"})),{},{selectedScreen(){return this.getScreen(this.screenId)}}),watch:{includeInTemplate(t,e){this.$nextTick(()=>{this.reposition()})},type(t,e){this.$nextTick(()=>{this.reposition()})},screenId(t,e){this.removeError("settingScreenId")}},mounted(){document.addEventListener("scroll",this.onEventPopoverReposition,{capture:!0,passive:!0}),window.addEventListener("resize",this.onEventPopoverReposition,{passive:!0})},beforeDestroy(){document.removeEventListener("scroll",this.onEventPopoverReposition,{capture:!0}),window.removeEventListener("resize",this.onEventPopoverReposition)},methods:K(K({},Object(n["b"])({setErrors:"form-field/setErrors",removeError:"form-field/removeError",removeHotspot:"hotspots/removeHotspot",addHotspotTemplate:"hotspots/addHotspotTemplate"})),{},{open(t,e){this.isActive||(this.isActive=!0,t instanceof M["a"]?this.hotspot=t:this.hotspot=new M["a"](t),this.reloadForm(),e&&(this.repositionToElem=e,this.reposition(e)),this.$emit("opened"))},close(){this.isActive&&(this.isActive=!1,this.hotspot.id||this.removeHotspot(this.hotspot.id),this.$emit("closed"))},onEventPopoverReposition(t){this.isActive&&this.reposition()},reposition(t){if(t=t||this.repositionToElem,this.isActive&&t){var e=this.$refs.popover,s=t.getBoundingClientRect(),o=5,i=s.top-o,r=s.left+s.width+o;e.style.left="0px",e.style.top="0px",r+e.offsetWidth>document.documentElement.clientWidth&&(r=s.left-e.offsetWidth-o),r=r>=0?r:0,i+e.offsetHeight>document.documentElement.clientHeight&&(i=document.documentElement.clientHeight-e.offsetHeight),i=i>=0?i:0,e.style.left=r+"px",e.style.top=i+"px"}},selectScreen(t){this.screenId=t,this.$refs.screensDropdown&&this.$refs.screensDropdown.hide()},reloadForm(){this.type=this.hotspot.type,this.screenId=l["a"].getNestedVal(this.hotspot,"settings.screenId",null),this.url=l["a"].getNestedVal(this.hotspot,"settings.url",""),this.transition=l["a"].getNestedVal(this.hotspot,"settings.transition","none"),this.overlayPosition=l["a"].getNestedVal(this.hotspot,"settings.overlayPosition","top-left"),this.fixOverlay=!!l["a"].getNestedVal(this.hotspot,"settings.fixOverlay"),this.offsetTop=l["a"].getNestedVal(this.hotspot,"settings.offsetTop",0)<<0,this.offsetBottom=l["a"].getNestedVal(this.hotspot,"settings.offsetBottom",0)<<0,this.offsetLeft=l["a"].getNestedVal(this.hotspot,"settings.offsetLeft",0)<<0,this.offsetRight=l["a"].getNestedVal(this.hotspot,"settings.offsetRight",0)<<0,this.scrollTop=l["a"].getNestedVal(this.hotspot,"settings.scrollTop",0)<<0,this.scrollLeft=l["a"].getNestedVal(this.hotspot,"settings.scrollLeft",0)<<0,this.outsideClose=!!l["a"].getNestedVal(this.hotspot,"settings.outsideClose",!0),this.includeInTemplate=this.hotspot.hotspotTemplateId>0,this.template=this.hotspot.hotspotTemplateId||(this.hotspotTemplates[0]?this.hotspotTemplates[0].id:"new"),this.newTemplateTitle="",this.setErrors({})},submitForm(){this.isProcessing||(this.isProcessing=!0,this.createHotspotTemplate().finally(()=>{var t=this.hotspot.id>0,e=this.includeInTemplate?this.getHotspotTemplate(this.template):null,s={screenId:e?null:this.activeScreenId,hotspotTemplateId:e?e.id:null,left:this.hotspot.left,top:this.hotspot.top,width:this.hotspot.width,height:this.hotspot.height,type:this.type,settingScreenId:this.screenId,settingUrl:this.url,settingOverlayPosition:this.overlayPosition,settingFixOverlay:this.fixOverlay,settingTransition:this.transition,settingOffsetTop:this.offsetTop<<0,settingOffsetBottom:this.offsetBottom<<0,settingOffsetLeft:this.offsetLeft<<0,settingOffsetRight:this.offsetRight<<0,settingScrollTop:this.scrollTop<<0,settingScrollLeft:this.scrollLeft<<0,settingOutsideClose:this.outsideClose},o=null;o=t?a["a"].Hotspots.update(this.hotspot.id,s):a["a"].Hotspots.create(s),o.then(t=>{this.hotspot.load(t.data),e&&this.linkToHotspotTemplate(e.id,this.activeScreenId),this.reloadForm(),this.close(),this.$emit("hotspotUpdated",this.hotspot)}).catch(t=>{this.$errResponseHandler(t)}).finally(()=>{this.isProcessing=!1})}))},onScreensDropdownShow(){this.$nextTick(()=>{var t=this.$el.querySelector(".dropdown-thumbs-list .thumb.active");t&&t.scrollIntoView({block:"nearest"})})},deleteHotspot(){this.hotspot.id&&window.confirm(this.$t("Do you really want to delete the selected hotspot?"))&&(this.close(),this.removeHotspot(this.hotspot.id),this.$toast(this.$t("Successfully deleted hotspot.")),a["a"].Hotspots.delete(this.hotspot.id))},createHotspotTemplate(){return!this.isCreatingHotspotTemplate&&this.newTemplateTitle&&this.includeInTemplate&&"new"===this.template?(this.isCreatingHotspotTemplate=!0,a["a"].HotspotTemplates.create({title:this.newTemplateTitle,prototypeId:this.activePrototypeId},{expand:"screenIds"}).then(t=>{this.addHotspotTemplate(t.data),this.newTemplateTitle="",this.template=this.hotspotTemplates[this.hotspotTemplates.length-1].id}).catch(t=>{this.$errResponseHandler(t)}).finally(()=>(this.isCreatingHotspotTemplate=!1,Promise.resolve()))):Promise.resolve()},linkToHotspotTemplate(t,e){e=e||this.activeScreenId;var s=this.getHotspotTemplate(t);s&&!l["a"].inArray(s.screenIds,e)&&(s.screenIds.push(e),a["a"].HotspotTemplates.linkScreen(s.id,e))}})},G=J,Q=Object(w["a"])(G,V,X,!1,null,null,null),Z=Q.exports,tt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("toggler",{staticClass:"popover hotspot-templates-popover",attrs:{hideOnChildClick:!1}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.hotspotTemplates.length,expression:"hotspotTemplates.length"}],staticClass:"hotspot-templates-list"},[t._l(t.hotspotTemplates,(function(e,o){return[s("div",{staticClass:"form-group form-group-switch m-0 flex-block flex-nowrap"},[s("input",{attrs:{type:"checkbox",id:"link_hotspot_template_"+e.id},domProps:{value:e.id,checked:t.isHotspotTemplateLinked(e.id)},on:{change:function(s){return s.preventDefault(),t.toggleLinking(e.id)}}}),s("label",{attrs:{for:"link_hotspot_template_"+e.id}}),s("div",{ref:"titleElem"+e.id,refInFor:!0,staticClass:"m-r-5",attrs:{contenteditable:"true",spellcheck:"false",autocomplete:"off",title:t.$t("Click to edit"),"data-placeholder":e.title},on:{blur:function(s){return t.updateHotspotTemplateTitle(e.id)},keydown:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:(s.preventDefault(),t.updateHotspotTemplateTitle(e.id))}}},[t._v(t._s(e.title))]),s("small",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.$t("Total hotspots"),expression:"$t('Total hotspots')",modifiers:{top:!0}}],staticClass:"label label-light-border align-self-start"},[s("span",{staticClass:"txt txt-hint"},[t._v(t._s(t.countTemplateHotspots(e.id)))])]),s("div",{staticClass:"flex-fill-block"}),s("div",{staticClass:"list-ctrls align-self-start"},[s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.$t("Delete"),expression:"$t('Delete')",modifiers:{top:!0}}],staticClass:"list-ctrl-item ctrl-danger",on:{click:function(s){return s.preventDefault(),t.deleteHotspotTemplate(e.id)}}},[s("i",{staticClass:"fe fe-trash"})])])]),s("hr",{staticClass:"m-t-10",class:{"m-b-10":o+1!=t.hotspotTemplates.length}})]}))],2),s("button",{staticClass:"btn btn-sm btn-transp-success btn-block btn-loader",class:{"btn-loader-active":t.isCreating},attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.createHotspotTemplate()}}},[s("i",{staticClass:"fe fe-plus"}),s("span",{staticClass:"txt"},[t._v(t._s(t.$t("New hotspot template")))])])])},et=[];function st(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,o)}return s}function ot(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?st(Object(s),!0).forEach((function(e){Object(r["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):st(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var it={name:"hotspot-templates-popover",props:{screen:{type:m["a"],default(){return this.activeScreen}}},data(){return{isCreating:!1}},computed:ot(ot(ot({},Object(n["d"])({hotspots:t=>t.hotspots.hotspots,hotspotTemplates:t=>t.hotspots.hotspotTemplates})),Object(n["c"])({activeScreen:"screens/activeScreen",getHotspotTemplate:"hotspots/getHotspotTemplate"})),{},{linkedHotspotTemplateIds(){var t=[];for(let e in this.hotspotTemplates)l["a"].inArray(this.hotspotTemplates[e].screenIds,this.screen.id)&&t.push(this.hotspotTemplates[e].id);return t}}),methods:ot(ot({},Object(n["b"])({removeHotspotTemplate:"hotspots/removeHotspotTemplate",updateHotspotTemplate:"hotspots/updateHotspotTemplate",addHotspotTemplate:"hotspots/addHotspotTemplate"})),{},{countTemplateHotspots(t){var e=0;for(let s=this.hotspots.length-1;s>=0;s--)this.hotspots[s].hotspotTemplateId==t&&e++;return e},deleteHotspotTemplate(t){var e=this.getHotspotTemplate(t);e&&window.confirm(this.$t('Do you really want to delete template "{title}" and all its hotspots?',{title:e.title}))&&(this.$toast(this.$t('Successfully deleted template "{title}".',{title:e.title})),this.removeHotspotTemplate(e.id),a["a"].HotspotTemplates.delete(e.id))},updateHotspotTemplateTitle(t){var e=this.getHotspotTemplate(t),s=this.$refs["titleElem"+t]?this.$refs["titleElem"+t][0]:null;e&&s&&s.innerText!==e.title&&(s.innerText.trim()?(s.blur(),a["a"].HotspotTemplates.update(e.id,{title:s.innerText},{expand:"screenIds"}).then(t=>{this.updateHotspotTemplate(t.data),e=this.getHotspotTemplate(e.id),s.innerText=e.title}).catch(t=>{this.$errResponseHandler(t)})):s.innerText=e.title)},createHotspotTemplate(t){this.isCreating||(t=t||this.$t("Template")+" "+(this.hotspotTemplates.length+1),this.isCreating=!0,a["a"].HotspotTemplates.create({title:t,prototypeId:this.screen.prototypeId},{expand:"screenIds"}).then(t=>{this.addHotspotTemplate(t.data),this.$toast(this.$t("Successfully created new hotspot template."))}).catch(t=>{this.$errResponseHandler(t)}).finally(()=>{this.isCreating=!1}))},isHotspotTemplateLinked(t){return l["a"].inArray(this.linkedHotspotTemplateIds,t)},toggleLinking(t){this.isHotspotTemplateLinked(t)?this.unlinkFromHotspotTemplate(t):this.linkToHotspotTemplate(t)},linkToHotspotTemplate(t){var e=this.screen.id,s=this.getHotspotTemplate(t);s&&!l["a"].inArray(s.screenIds,e)&&(s.screenIds.push(e),a["a"].HotspotTemplates.linkScreen(s.id,e))},unlinkFromHotspotTemplate(t){var e=this.screen.id,s=this.getHotspotTemplate(t);s&&l["a"].inArray(s.screenIds,e)&&(s.screenIds.splice(s.screenIds.indexOf(e<<0),1),a["a"].HotspotTemplates.unlinkScreen(s.id,e))}})},rt=it,nt=(s("9d2a"),Object(w["a"])(rt,tt,et,!1,null,"70368ede",null)),at=nt.exports,lt=s("7bbf"),ct=s("917d"),pt=s("57d1"),dt=s("c647"),ht=s("35bb");function mt(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,o)}return s}function ut(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?mt(Object(s),!0).forEach((function(e){Object(r["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):mt(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var vt={computed:ut(ut(ut({},Object(n["d"])({activeScreenId:t=>t.screens.activeScreenId,hotspots:t=>t.hotspots.hotspots,hotspotTemplates:t=>t.hotspots.hotspotTemplates})),Object(n["c"])({getHotspotsForScreen:"hotspots/getHotspotsForScreen"})),{},{activeScreenHotspots(){return this.getHotspotsForScreen(this.activeScreenId)},totalActiveHotspotTemplates(){var t=0;for(let e in this.hotspotTemplates)l["a"].inArray(this.hotspotTemplates[e].screenIds,this.activeScreenId)&&t++;return t}}),methods:ut(ut({},Object(n["b"])({addHotspot:"hotspots/addHotspot"})),{},{initHotspotCreation(t,e){if(this.isInHotspotsMode){e=e||this.activeScreenId;var s=new M["a"]({screenId:e,left:t.offsetX/this.scaleFactor,top:t.offsetY/this.scaleFactor});this.addHotspot(s),this.$nextTick(()=>{if(this.$refs.hotspotBoxes){var e=this.$refs.hotspotBoxes[this.$refs.hotspotBoxes.length-1];e&&(e.activate(),e.initResizing(t))}})}},viewHotspot(t){if(this.$refs.hotspotBoxes)for(let e in this.$refs.hotspotBoxes){let s=this.$refs.hotspotBoxes[e];if(s.hotspot&&s.hotspot.id==t){s.activate();break}}},deactivateHotspots(){if(this.$refs.hotspotPopover&&this.$refs.hotspotPopover.close(),this.$refs.hotspotBoxes)for(let t in this.$refs.hotspotBoxes)this.$refs.hotspotBoxes[t].deactivate()},onHotspotPopoverClose(){this.deactivateHotspots()},onHotspotActivate(t,e){this.deactivateHotspots(),this.$refs.hotspotPopover&&this.$refs.hotspotPopover.open(t,e)},onHotspotRepositioning(t,e){this.$nextTick(()=>{this.$refs.hotspotPopover&&this.$refs.hotspotPopover.reposition(e)})},getActiveHotspotBox(){if(this.$refs.hotspotBoxes)for(let t in this.$refs.hotspotBoxes)if(this.$refs.hotspotBoxes[t].isActive)return this.$refs.hotspotBoxes[t];return null},snapActiveHotspot(t){if(this.isInHotspotsMode){var e=this.getActiveHotspotBox();e&&e.snap()}}})};function ft(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,o)}return s}function gt(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?ft(Object(s),!0).forEach((function(e){Object(r["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ft(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}const bt="preview",yt="hotspots",_t="comments";var wt={name:"screens-view",mixins:[dt["a"],ht["a"],vt,u["a"]],components:{"screen-preview":c["a"],"screens-panel":p["a"],"screen-edit-popover":H,"comment-pin":lt["a"],"active-comment-popover":ct["a"],"comments-panel":pt["a"],"hotspot-box":q,"hotspot-popover":Z,"hotspot-templates-popover":at},data(){return{mode:bt,isLoadingScreens:!1,isResponsiveShowMoreActive:!1,isReplaceHandleClickable:!1}},computed:gt(gt(gt({},Object(n["d"])({loggedUser:t=>t.user.user,activePrototypeId:t=>t.prototypes.activePrototypeId,screens:t=>t.screens.screens,activeScreenId:t=>t.screens.activeScreenId})),Object(n["c"])({activePrototype:"prototypes/activePrototype",getScreen:"screens/getScreen",activeScreen:"screens/activeScreen",activeScreenOrderedIndex:"screens/activeScreenOrderedIndex"})),{},{isInCommentsMode(){return this.mode===_t},isInHotspotsMode(){return this.mode===yt},isInPreviewMode(){return this.mode===bt},modeHelpTooltip(){return this.isInCommentsMode?this.$t("Click to leave a comment"):this.isInHotspotsMode?this.$t('Click and drag to create a hotspot\n(hold "{shortcut}" to snap)',{shortcut:"Ctrl"}):""}}),watch:{mode(t,e){!this.isInCommentsMode&&this.$refs.commentsPanel&&this.$refs.commentsPanel.hide(),this.updateRouteMode()},activeScreenId(t,e){this.deactivateHotspots(),this.deactivateComments(),this.updateRouteScreenId(),setTimeout(()=>{this.initReplace(this.activeScreen,this.$refs.previewContainer)},0)},"$route.params.screenId":function(t,e){t&&this.getScreen(t)?t!=this.activeScreenId&&this.setActiveScreenId(t):this.updateRouteScreenId()},"$route.query.mode":function(t,e){t===_t?this.setCommentsMode():t===bt?this.setPreviewMode():t===yt?this.setHotspotsMode():this.updateRouteMode()}},beforeMount(){this.$route.query.mode===_t||this.$route.query.commentId?this.setCommentsMode():this.$route.query.mode===yt?this.setHotspotsMode():this.setPreviewMode(),this.init()},mounted(){this.initReplace(this.activeScreen,this.$refs.previewContainer)},methods:gt(gt({},Object(n["b"])({setScreens:"screens/setScreens",setActiveScreenId:"screens/setActiveScreenId",addPrototype:"prototypes/addPrototype",setActivePrototypeId:"prototypes/setActivePrototypeId"})),{},{responsiveShowMore(){this.isResponsiveShowMoreActive=!0},responsiveHideMore(){this.isResponsiveShowMoreActive=!1},init(){this.$setDocumentTitle(()=>this.$t("Screen")),this.loadScreens(this.$route.params.prototypeId,this.$route.params.screenId),this.loadHotspots(this.$route.params.prototypeId),this.loadHotspotTemplates(this.$route.params.prototypeId),this.loadComments(this.$route.params.prototypeId),this.loadMentionsList(this.$route.params.projectId)},loadMentionsList(t){t=t||(this.activePrototype?this.activePrototype.projectId:null),t&&a["a"].Projects.getCollaboratorsList(t).then(t=>{this.mentionsList=this.convertCollaboratorsListToMentionsList(t.data,[this.loggedUser.email])})},loadScreens(t,e){t=t||this.activePrototypeId,t&&!this.isLoadingScreens&&(this.isLoadingScreens=!0,a["a"].Prototypes.getOne(t,{expand:"screens"}).then(t=>{this.addPrototype(t.data),this.setActivePrototypeId(l["a"].getNestedVal(t,"data.id")),this.setScreens(l["a"].getNestedVal(t,"data.screens",[])),this.getScreen(e)&&this.setActiveScreenId(e),this.updateRouteProjectId(),this.updateRouteScreenId(),this.updateRouteMode(),this.initReplace(this.activeScreen,this.$refs.previewContainer)}).catch(t=>{this.$errResponseHandler(t)}).finally(()=>{this.isLoadingScreens=!1}))},updateRouteProjectId(){this.activePrototype&&this.$route.params.projectId!=this.activePrototype.projectId&&this.$router.replace({name:this.$route.name,params:Object.assign({},this.$route.params,{projectId:this.activePrototype.projectId}),query:Object.assign({},this.$route.query)})},updateRouteScreenId(){let t=this.$route.params.screenId;t!=this.activeScreenId&&this.$router[t?"push":"replace"]({name:this.$route.name,params:Object.assign({},this.$route.params,{screenId:this.activeScreenId}),query:Object.assign({},this.$route.query)})},updateRouteMode(){this.$route.query.mode!=this.mode&&this.$router.replace({name:this.$route.name,params:Object.assign({},this.$route.params),query:Object.assign({},this.$route.query,{mode:this.mode})})},setCommentsMode(){this.mode=_t},setHotspotsMode(){this.mode=yt},setPreviewMode(){this.mode=bt},onEscPress(t){this.isInHotspotsMode?(t.preventDefault(),this.deactivateHotspots()):this.isInCommentsMode&&(t.preventDefault(),this.deactivateComments())},onActiveScreenMousedown(t){this.isInHotspotsMode&&this.initHotspotCreation(t,this.activeScreenId)},onActiveScreenClick(t){this.isInPreviewMode?this.blinkPreviewModeHints():this.isInCommentsMode&&this.initCommentCreation(t,this.activeScreenId)}})},Ct=wt,$t=Object(w["a"])(Ct,o,i,!1,null,null,null);e["default"]=$t.exports}}]);