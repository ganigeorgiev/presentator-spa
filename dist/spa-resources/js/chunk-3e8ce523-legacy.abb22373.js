(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3e8ce523"],{"0372":function(e,t,s){"use strict";var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.activeScreen?s("div",{directives:[{name:"shortcut",rawName:"v-shortcut.37",value:e.goToPrevScreen,expression:"goToPrevScreen",modifiers:{37:!0}},{name:"shortcut",rawName:"v-shortcut.39",value:e.goToNextScreen,expression:"goToNextScreen",modifiers:{39:!0}}],staticClass:"preview-screen-holder",class:[e.activePrototype.isForDesktop?"desktop":"mobile","align-"+e.activeScreen.alignment,e.inTransition?"transitioning":"",e.overlayScreen?"overlay-active":"","transition-"+e.activeTransition]},[e.screens.length>1?[s("nav",{staticClass:"preview-nav nav-left",class:{"nav-disabled":0==e.activeScreenOrderedIndex},attrs:{title:e.$t("Prev screen")},on:{click:function(t){return t.preventDefault(),e.goToPrevScreen()}}},[s("i",{staticClass:"fe fe-chevron-left"})]),s("nav",{staticClass:"preview-nav nav-right",class:{"nav-disabled":e.orderedScreens.length==e.activeScreenOrderedIndex+1},attrs:{title:e.$t("Next screen")},on:{click:function(t){return t.preventDefault(),e.goToNextScreen()}}},[s("i",{staticClass:"fe fe-chevron-right"})])]:e._e(),s("div",{ref:"activeScreenWrapper",staticClass:"screen-wrapper",style:{width:e.activePrototype.width?e.activePrototype.width+"px":null,height:e.activePrototype.height?e.activePrototype.height+"px":null,background:e.activeScreen.background||null},attrs:{tabindex:"-1"},on:{"&!scroll":function(t){return e.fixedOverlayReposition(t)}}},[e.interactions&&e.activeScreen.fixedHeader>0&&!e.inTransition?s("div",{staticClass:"fixed-screen-header",style:{height:e.activeScreen.fixedHeader*e.scaleFactor+"px","margin-top":-e.activeScreen.fixedHeader*e.scaleFactor+"px"}},[s("div",{staticClass:"fixed-screen-overflow-wrapper"},[s("div",{staticClass:"fixed-screen-content-wrapper"},[s("img",{directives:[{name:"scale",rawName:"v-scale",value:e.scaleFactor,expression:"scaleFactor"}],staticClass:"fixed-screen",attrs:{src:e.activeScreen.getImage(),alt:e.activeScreen.title}}),s("div",{staticClass:"block preview-hotspots-block"},e._l(e.activeScreenHotspots,(function(t){return t.top<e.activeScreen.fixedHeader?s("div",{key:"fixed_header_hotspot_"+t.id,staticClass:"hotspot",style:{left:t.left*e.scaleFactor+"px",top:t.top*e.scaleFactor+"px",width:t.width*e.scaleFactor+"px",height:t.height*e.scaleFactor+"px"},on:{click:function(s){return s.preventDefault(),e.hotspotNavigate(t.id)}}}):e._e()})),0)])])]):e._e(),s("div",{staticClass:"screen-inner-wrapper",class:{"position-static":e.overlayScreen&&e.isOverlayScreenFixed}},[s("img",{directives:[{name:"show",rawName:"v-show",value:e.oldActiveScreen&&e.inTransition,expression:"oldActiveScreen && inTransition"},{name:"scale",rawName:"v-scale",value:e.screenScaleFactor,expression:"screenScaleFactor"}],staticClass:"screen old-active-screen",style:{background:e.oldActiveScreen?e.oldActiveScreen.background:null},attrs:{src:e.oldActiveScreen?e.oldActiveScreen.getImage():"",alt:e.oldActiveScreen?e.oldActiveScreen.title:""}}),s("img",{directives:[{name:"tooltip",rawName:"v-tooltip.follow",value:e.activeScreenTooltip,expression:"activeScreenTooltip",modifiers:{follow:!0}},{name:"scale",rawName:"v-scale",value:e.screenScaleFactor,expression:"screenScaleFactor"}],key:"active_screen_"+e.activeScreen.id,ref:"activeScreen",staticClass:"screen",class:e.inTransition?"new-active-screen":"current-active-screen",attrs:{crossorigin:"anonymous",draggable:"false",src:e.activeScreen.getImage(),alt:e.activeScreen.title},on:{load:function(t){return e.refreshActiveScreenWrapperAlignment()},mousedown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:"button"in t&&0!==t.button?null:(t.stopPropagation(),t.preventDefault(),e.$emit("activeScreenMousedown",t))},click:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:"button"in t&&0!==t.button?null:(t.stopPropagation(),t.preventDefault(),e.$emit("activeScreenClick",t))},e.onOverlayOutsideClick]}}),e.interactions&&e.overlayScreen?s("div",{key:"overlayContainer",ref:"overlayContainer",staticClass:"overlay-container",class:e.isOverlayScreenFixed?"fixed":"relative"},[s("div",{staticClass:"overlay-screen-wrapper",class:["transition-"+e.overlayScreenTransition,"position-"+e.overlayScreenPosition,e.isOverlayScreenClosing?"closing":""],style:{"margin-top":e.overlayScreenOffsetTop*e.scaleFactor+"px","margin-bottom":e.overlayScreenOffsetBottom*e.scaleFactor+"px","margin-left":e.overlayScreenOffsetLeft*e.scaleFactor+"px","margin-right":e.overlayScreenOffsetRight*e.scaleFactor+"px"}},[s("img",{directives:[{name:"scale",rawName:"v-scale",value:e.scaleFactor,expression:"scaleFactor"}],staticClass:"screen overlay-screen",attrs:{src:e.overlayScreen.getImage(),alt:e.overlayScreen.title}}),s("div",{key:"overlay-screen-hotspots-block",staticClass:"block preview-hotspots-block"},e._l(e.overlayScreenHotspots,(function(t){return s("div",{key:"overlay_screen_hotspot_"+t.id,staticClass:"hotspot",style:{left:t.left*e.scaleFactor+"px",top:t.top*e.scaleFactor+"px",width:t.width*e.scaleFactor+"px",height:t.height*e.scaleFactor+"px"},on:{click:function(s){return s.preventDefault(),e.hotspotNavigate(t.id)}}})})),0)])]):e._e(),e.interactions?s("div",{key:"active-screen-hotspots-block",staticClass:"block preview-hotspots-block"},e._l(e.activeScreenHotspots,(function(t){return s("div",{key:"active_screen_hotspot_"+t.id,staticClass:"hotspot",style:{left:t.left*e.scaleFactor+"px",top:t.top*e.scaleFactor+"px",width:t.width*e.scaleFactor+"px",height:t.height*e.scaleFactor+"px"},on:{click:function(s){return s.preventDefault(),e.hotspotNavigate(t.id)}}})})),0):e._e(),e._t("default")],2),e.interactions&&e.activeScreen.fixedFooter>0&&!e.inTransition?s("div",{staticClass:"fixed-screen-footer",style:{height:e.activeScreen.fixedFooter*e.scaleFactor+"px","margin-top":-e.activeScreen.fixedFooter*e.scaleFactor+"px"}},[s("div",{staticClass:"fixed-screen-overflow-wrapper"},[s("div",{staticClass:"fixed-screen-content-wrapper"},[s("img",{directives:[{name:"scale",rawName:"v-scale",value:e.scaleFactor,expression:"scaleFactor"}],staticClass:"fixed-screen",attrs:{src:e.activeScreen.getImage(),alt:e.activeScreen.title}}),s("div",{staticClass:"block preview-hotspots-block"},e._l(e.activeScreenHotspots,(function(t){return s("div",{key:"fixed_footer_hotspot_"+t.id,staticClass:"hotspot",style:{left:t.left*e.scaleFactor+"px",top:t.top*e.scaleFactor+"px",width:t.width*e.scaleFactor+"px",height:t.height*e.scaleFactor+"px"},on:{click:function(s){return s.preventDefault(),e.hotspotNavigate(t.id)}}})})),0)])])]):e._e()])],2):e._e()},i=[],o=(s("8e6e"),s("ac6a"),s("456d"),s("bd86")),r=s("2f62"),c=s("dd93");function a(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function l(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?a(s,!0).forEach((function(t){Object(o["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):a(s).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var m=400,d=null,v={name:"screen-preview",props:{interactions:{type:Boolean,default:!0},activeScreenTooltip:{type:String,default:""},fitToScreen:{type:Boolean,default:!1}},data:function(){return{oldActiveScreenId:null,activeTransition:"none",inTransition:!1,overlayScreenId:null,overlayScreenPosition:"centered",overlayScreenTransition:"none",overlayScreenOffsetTop:0,overlayScreenOffsetBottom:0,overlayScreenOffsetLeft:0,overlayScreenOffsetRight:0,overlayScreenOutsideClose:!0,isOverlayScreenFixed:!1,isOverlayScreenClosing:!1}},computed:l({},Object(r["d"])({activeScreenId:function(e){return e.screens.activeScreenId},screens:function(e){return e.screens.screens},scaleFactor:function(e){return e.screens.scaleFactor},hotspots:function(e){return e.hotspots.hotspots},hotspotTemplates:function(e){return e.hotspots.hotspotTemplates}}),{},Object(r["c"])({activePrototype:"prototypes/activePrototype",getScreen:"screens/getScreen",activeScreen:"screens/activeScreen",orderedScreens:"screens/orderedScreens",activeScreenOrderedIndex:"screens/activeScreenOrderedIndex",getHotspot:"hotspots/getHotspot",getHotspotTemplate:"hotspots/getHotspotTemplate",getHotspotsForScreen:"hotspots/getHotspotsForScreen"}),{screenScaleFactor:function(e,t){return this.fitToScreen?0:this.activePrototype.scaleFactor},oldActiveScreen:function(){return this.getScreen(this.oldActiveScreenId)},overlayScreen:function(){return this.getScreen(this.overlayScreenId)},activeScreenHotspots:function(){return this.getHotspotsForScreen(this.activeScreenId)},overlayScreenHotspots:function(){return this.getHotspotsForScreen(this.overlayScreenId)}}),watch:{interactions:function(e,t){this.closeOverlayScreen()},activeScreenId:function(e,t){this.oldActiveScreenId=t,this.onActiveScreenChange()},"activeScreen.title":function(e,t){e!==t&&this.refreshDocumentTitle()},"activeScreen.alignment":function(e,t){e!==t&&this.refreshActiveScreenWrapperAlignment()},fitToScreen:function(e,t){this.onActiveScreenChange()}},mounted:function(){this.onActiveScreenChange(),window.addEventListener("resize",this.onResize,{passive:!0})},beforeDestroy:function(){window.removeEventListener("resize",this.onResize,{passive:!0})},methods:l({},Object(r["b"])({setActiveScreenId:"screens/setActiveScreenId",setScreens:"screens/setScreens",setScaleFactor:"screens/setScaleFactor"}),{changeActiveScreen:function(e,t,s){var n=this,i=this.getScreen(e);i&&(s||e!=this.activeScreenId)&&(this.$emit("beforeActiveScreenChange",this.activeScreenId,e),this.inTransition=!1,this.activeTransition=t||"none",this.oldActiveScreenId=this.activeScreenId,this.screenChangeTimeoutId&&clearTimeout(this.screenChangeTimeoutId),this.screenChangeTimeoutId=setTimeout((function(){n.setActiveScreenId(e),"none"!==n.activeTransition&&(n.inTransition=!0,n.screenChangeAnimationTimeoutId&&clearTimeout(n.screenChangeAnimationTimeoutId),n.screenChangeAnimationTimeoutId=setTimeout((function(){n.activeTransition="none",n.inTransition=!1}),m)),n.$emit("afterActiveScreenChange",n.oldActiveScreenId,n.activeScreenId)}),"none"!==this.activeTransition?100:0))},onActiveScreenChange:function(){var e=this;this.activeScreen&&(this.fitToScreen||0==this.activePrototype.scaleFactor?c["a"].loadImage(this.activeScreen.getImage()).then((function(t){t.success&&t.width>0&&setTimeout((function(){e.$refs.activeScreen&&e.setScaleFactor(e.$refs.activeScreen.clientWidth/t.width)}),0)})):this.setScaleFactor(this.activePrototype.scaleFactor),this.closeOverlayScreen(),this.refreshActiveScreenWrapperAlignment(),this.refreshDocumentTitle(),this.$refs.activeScreenWrapper&&this.$refs.activeScreenWrapper.focus())},goToPrevScreen:function(){this.orderedScreens[this.activeScreenOrderedIndex-1]&&this.setActiveScreenId(this.orderedScreens[this.activeScreenOrderedIndex-1].id)},goToNextScreen:function(){this.orderedScreens[this.activeScreenOrderedIndex+1]&&this.setActiveScreenId(this.orderedScreens[this.activeScreenOrderedIndex+1].id)},refreshActiveScreenWrapperAlignment:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.$nextTick((function(){d&&clearTimeout(d),d=setTimeout((function(){e.$refs.activeScreenWrapper&&(e.activeScreen.isLeftAligned?e.$refs.activeScreenWrapper.scrollLeft=0:e.activeScreen.isRightAligned?e.$refs.activeScreenWrapper.scrollLeft=e.$refs.activeScreenWrapper.scrollWidth:e.$refs.activeScreenWrapper.scrollLeft=(e.$refs.activeScreenWrapper.scrollWidth-e.$refs.activeScreenWrapper.offsetWidth)/2)}),t)}))},refreshDocumentTitle:function(){var e=this;this.$setDocumentTitle((function(){return e.$t("Screen")+" "+e.activeScreen.title}))},hotspotNavigate:function(e){var t=this.getHotspot(e);if(t){var s=t.settings.transition||"none";"url"===t.type?window.open(t.settings.url||"#","_blank"):"prev"===t.type?this.orderedScreens[this.activeScreenOrderedIndex-1]&&this.changeActiveScreen(this.orderedScreens[this.activeScreenOrderedIndex-1].id,s):"next"===t.type?this.orderedScreens[this.activeScreenOrderedIndex+1]&&this.changeActiveScreen(this.orderedScreens[this.activeScreenOrderedIndex+1].id,s):"back"===t.type?this.overlayScreenId?this.closeOverlayScreen():this.oldActiveScreen&&this.changeActiveScreen(this.oldActiveScreen.id,s):"screen"===t.type?this.changeActiveScreen(t.settings.screenId,s):"overlay"===t.type?this.openOverlayScreen(t.settings.screenId,s,t.settings.outsideClose,t.settings.overlayPosition,t.settings.offsetTop,t.settings.offsetBottom,t.settings.offsetLeft,t.settings.offsetRight,t.settings.fixOverlay):"scroll"===t.type&&this.$refs.activeScreenWrapper&&this.$refs.activeScreenWrapper.scrollTo({behavior:"smooth",top:t.settings.scrollTop<<0,left:t.settings.scrollLeft<<0})}},fixedOverlayReposition:function(){this.isOverlayScreenFixed&&this.overlayScreenId&&this.$refs.activeScreenWrapper&&this.$refs.overlayContainer&&(this.$refs.overlayContainer.style.marginTop=this.$refs.activeScreenWrapper.scrollTop+"px",this.$refs.overlayContainer.style.marginLeft=this.$refs.activeScreenWrapper.scrollLeft+"px")},openOverlayScreen:function(e,t,s,n,i,o,r,a,l){var m=this;e!=this.overlayScreenId&&this.closeOverlayScreen((function(){m.isOverlayScreenClosing=!1,m.overlayScreenId=e,m.overlayScreenTransition=t||"none",m.overlayScreenPosition=n||"centered",m.overlayScreenOffsetTop=i<<0,m.overlayScreenOffsetBottom=o<<0,m.overlayScreenOffsetLeft=r<<0,m.overlayScreenOffsetRight=a<<0,m.overlayScreenOutsideClose=!!c["a"].isEmpty(s)||s,m.isOverlayScreenFixed=!c["a"].isEmpty(l)&&l,m.$nextTick((function(){m.fixedOverlayReposition()}))}))},closeOverlayScreen:function(e){var t=this;this.overlayScreenId?(this.isOverlayScreenClosing=!0,this.overlayCloseAnimationTimeoutId&&clearTimeout(this.overlayCloseAnimationTimeoutId),this.overlayCloseAnimationTimeoutId=setTimeout((function(){t.isOverlayScreenClosing=!0,t.overlayScreenId=null,t.overlayScreenPosition="centered",t.overlayScreenTransition="none",t.overlayScreenOffsetTop=0,t.overlayScreenOffsetBottom=0,t.overlayScreenOffsetLeft=0,t.overlayScreenOffsetRight=0,t.overlayScreenOutsideClose=!0,c["a"].isFunction(e)&&e()}),"none"!=this.overlayScreenTransition?m:0)):c["a"].isFunction(e)&&e()},onOverlayOutsideClick:function(e){this.overlayScreenId&&this.overlayScreenOutsideClose&&(e.preventDefault(),e.stopPropagation(),this.closeOverlayScreen())},onResize:function(e){this.refreshActiveScreenWrapperAlignment()}})},u=v,h=s("2877"),p=Object(h["a"])(u,n,i,!1,null,null,null);t["a"]=p.exports},"35bb":function(e,t,s){"use strict";s("8e6e"),s("ac6a"),s("456d"),s("7f7f"),s("a481");var n=s("bd86"),i=s("2f62"),o=s("f744"),r=s("dd93"),c=s("46a0");function a(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function l(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?a(s,!0).forEach((function(t){Object(n["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):a(s).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}t["a"]={data:function(){return{isLoadingComments:!1,showCommentsPanel:!1,mentionsList:[]}},computed:l({},Object(i["d"])({activePrototypeId:function(e){return e.prototypes.activePrototypeId},activeScreenId:function(e){return e.screens.activeScreenId},scaleFactor:function(e){return e.screens.scaleFactor},previewToken:function(e){return e.preview.previewToken},showResolvedComments:function(e){return e.comments.showResolvedComments},activeCommentId:function(e){return e.comments.activeCommentId},unreadComments:function(e){return e.notifications.unreadComments}}),{},Object(i["c"])({getCommentsForScreen:"comments/getCommentsForScreen",activeComment:"comments/activeComment",getUnreadCommentsForScreen:"notifications/getUnreadCommentsForScreen",isCommentUnread:"notifications/isCommentUnread"}),{activeScreenComments:function(){return this.getCommentsForScreen(this.activeScreenId)},totalActiveScreenComments:function(){return this.activeScreenComments.length},activeScreenResolvedComments:function(){return this.getCommentsForScreen(this.activeScreenId,"resolved")},totalActiveScreenResolvedComments:function(){return this.activeScreenResolvedComments.length},activeUnreadComments:function(){return this.getUnreadCommentsForScreen(this.activeScreenId)}}),watch:{activeUnreadComments:function(e,t){for(var s in e)e[s].replyTo||this.addComment(e[s])},activeCommentId:function(e,t){this.updateQueryCommentIdParam(),this.activeComment&&this.activeComment.isResolved&&this.setShowResolvedComments(!0)}},methods:l({},Object(i["b"])({setComments:"comments/setComments",addComment:"comments/addComment",appendComments:"comments/appendComments",setShowResolvedComments:"comments/setShowResolvedComments",setActiveCommentId:"comments/setActiveCommentId"}),{convertCollaboratorsListToMentionsList:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e=e||[];for(var s=[],n=e.length-1;n>=0;n--)if(!(t.indexOf(e[n].email)>=0)){var i=((e[n].firstName||"")+(e[n].lastName||"")).trim();s.push({value:e[n].email,label:i?i+" ("+e[n].email+")":e[n].email})}return s},loadComments:function(e){var t=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e=e||this.activePrototypeId,e&&!this.isLoadingComments){this.isLoadingComments=!0;var i=null;o["a"].enableAutoCancellation(!1),i=n?o["a"].Previews.getScreenCommentsList(this.previewToken,s,100,{envelope:!0,"search[prototypeId]":e,"search[replyTo]":0}):o["a"].ScreenComments.getList(s,100,{envelope:!0,"search[prototypeId]":e,"search[replyTo]":0}),i.finally((function(){t.isLoadingComments=!1})).then((function(i){var o=r["a"].getNestedVal(i,"data.response",[]),c=r["a"].getNestedVal(i,"data.headers.x-pagination-current-page",1),a=r["a"].getNestedVal(i,"data.headers.x-pagination-page-count",1);1==s?t.setComments(o):t.appendComments(o),a>c&&t.loadComments(e,s+1,n),t.$route.query.commentId&&setTimeout((function(){t.setActiveCommentId(t.$route.query.commentId)}),300)})).catch((function(e){t.$errResponseHandler(e)}))}},initCommentCreation:function(e,t){if(this.isInCommentsMode){this.deactivateComments();var s=new c["a"]({screenId:t||this.activeScreenId,left:this.scaleFactor>0?e.offsetX/this.scaleFactor:e.offsetX,top:this.scaleFactor>0?e.offsetY/this.scaleFactor:e.offsetY});this.addComment(s),this.setActiveCommentId(s.id)}},deactivateComments:function(){this.setActiveCommentId(null)},updateQueryCommentIdParam:function(){var e=Object.assign({},this.$route.query);this.activeComment&&!this.activeComment.isNew?e.commentId=this.activeComment.id:delete e.commentId,this.$router.replace({name:this.$route.name,params:Object.assign({},this.$route.params),query:e})},onCommentRepositioning:function(e,t){this.$refs.commentPopover&&this.$refs.commentPopover.reposition(t)}})}},"57d1":function(e,t,s){"use strict";var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("transition",{attrs:{name:"sidebarPanel"},on:{"after-enter":e.triggerResize,"after-leave":e.triggerResize}},[e.isActive?s("aside",{staticClass:"app-sidebar-panel screen-comments-panel"},[s("header",{staticClass:"app-sidebar-section app-sidebar-header"},[s("h4",{staticClass:"title"},[e._v(e._s(e.$t("Screen comments")))]),s("div",{staticClass:"list-ctrls"},[s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.left",value:e.$t("Close panel"),expression:"$t('Close panel')",modifiers:{left:!0}}],staticClass:"list-ctrl-item",on:{click:function(t){return t.preventDefault(),e.hide(t)}}},[s("i",{staticClass:"fe fe-x"})])]),e.totalActiveScreenComments>0?s("div",{staticClass:"form-group form-group-switch m-t-20 m-b-5"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.resolvedCommentsToggle,expression:"resolvedCommentsToggle"}],attrs:{type:"checkbox",id:"show_resolved"},domProps:{checked:Array.isArray(e.resolvedCommentsToggle)?e._i(e.resolvedCommentsToggle,null)>-1:e.resolvedCommentsToggle},on:{change:function(t){var s=e.resolvedCommentsToggle,n=t.target,i=!!n.checked;if(Array.isArray(s)){var o=null,r=e._i(s,o);n.checked?r<0&&(e.resolvedCommentsToggle=s.concat([o])):r>-1&&(e.resolvedCommentsToggle=s.slice(0,r).concat(s.slice(r+1)))}else e.resolvedCommentsToggle=i}}}),s("label",{attrs:{for:"show_resolved"}},[e._v(e._s(e.$t("Show resolved comments ({count})",{count:e.totalActiveScreenResolvedComments})))])]):e._e()]),s("div",{staticClass:"app-sidebar-section app-sidebar-content"},[e.totalActiveScreenComments<=0?s("div",{staticClass:"placeholder-block"},[s("div",{staticClass:"icon"},[s("i",{staticClass:"fe fe-message-circle"})]),s("div",{staticClass:"content"},[e._v(e._s(e.$t("The screen doesn't have any comments yet.")))])]):!e.showResolvedComments&&e.totalActiveScreenComments>0&&!e.hasUnresolvedComments?s("div",{staticClass:"placeholder-block"},[s("div",{staticClass:"icon"},[s("i",{staticClass:"fe fe-message-circle"})]),s("div",{staticClass:"content"},[e._v(e._s(e.$t("All screen comments have been resolved.")))])]):s("div",{staticClass:"cards-list"},e._l(e.activeScreenComments,(function(t,n){return t.isNew||t.isResolved&&!e.showResolvedComments?e._e():s("div",{staticClass:"card comment-card",class:{active:e.activeCommentId==t.id,"card-danger":e.isCommentUnread(t.id)},on:{click:function(s){return s.preventDefault(),e.setActiveCommentId(t.id)}}},[s("figure",{staticClass:"icon"},[s("span",{staticClass:"txt txt-hint"},[e._v(e._s(e.totalActiveScreenComments-n))]),t.isResolved?s("i",{staticClass:"fe fe-check txt-success"}):e._e()]),s("div",{staticClass:"content"},[s("div",{staticClass:"title txt-default"},[e._v(e._s(t.message))]),s("div",{staticClass:"meta"},[s("div",{staticClass:"meta-item"},[e._v(e._s(t.user?t.user.identifier:t.from))]),s("div",{staticClass:"meta-item"},[e._v(e._s(t.createdAtFromNow))])])])])})),0)])]):e._e()])},i=[],o=(s("8e6e"),s("ac6a"),s("456d"),s("bd86")),r=s("2f62");function c(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function a(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?c(s,!0).forEach((function(t){Object(o["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):c(s).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var l={name:"comments-panel",data:function(){return{isActive:!1}},computed:a({},Object(r["d"])({activePrototypeId:function(e){return e.prototypes.activePrototypeId},activeScreenId:function(e){return e.screens.activeScreenId},showResolvedComments:function(e){return e.comments.showResolvedComments},activeCommentId:function(e){return e.comments.activeCommentId},unreadComments:function(e){return e.notifications.unreadComments}}),{},Object(r["c"])({getCommentsForScreen:"comments/getCommentsForScreen",isCommentUnread:"notifications/isCommentUnread"}),{activeScreenComments:function(){return this.getCommentsForScreen(this.activeScreenId).reverse()},activeScreenResolvedComments:function(){return this.getCommentsForScreen(this.activeScreenId,"resolved").reverse()},totalActiveScreenComments:function(){return this.activeScreenComments.length},totalActiveScreenResolvedComments:function(){return this.activeScreenResolvedComments.length},hasUnresolvedComments:function(){return this.totalActiveScreenResolvedComments<this.totalActiveScreenComments},resolvedCommentsToggle:{get:function(){return this.showResolvedComments},set:function(e){this.setShowResolvedComments(e)}}}),methods:a({},Object(r["b"])({setShowResolvedComments:"comments/setShowResolvedComments",setActiveCommentId:"comments/setActiveCommentId"}),{hide:function(){this.isActive=!1},show:function(){this.isActive=!0},toggle:function(){this.isActive?this.hide():this.show()},triggerResize:function(){window.dispatchEvent(new Event("resize"))}})},m=l,d=(s("a1c0"),s("2877")),v=Object(d["a"])(m,n,i,!1,null,"0c60c519",null);t["a"]=v.exports},"7bbf":function(e,t,s){"use strict";var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("dragger",{staticClass:"comment-pin",class:{new:e.comment.isNew,completed:e.comment.isResolved,active:e.isActive,loader:e.isProcessing},style:{left:e.comment.left*e.scaleFactor+"px",top:e.comment.top*e.scaleFactor+"px"},attrs:{"data-id":e.comment.id,enable:e.allowPositionChange,wrapperSelector:".screen-inner-wrapper"},on:{dragging:function(t){return e.onRepositioning()},dragStopped:function(t){return e.updatePinPosition()}},nativeOn:{click:function(t){return t.preventDefault(),e.setActiveCommentId(e.comment.id)}}})},i=[],o=(s("8e6e"),s("ac6a"),s("456d"),s("bd86")),r=s("2f62"),c=s("f744"),a=s("82bb"),l=s("46a0");function m(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function d(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?m(s,!0).forEach((function(t){Object(o["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):m(s).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var v={name:"comment-pin",components:{dragger:a["a"]},props:{allowPositionChange:{type:Boolean,default:!1},comment:{type:l["a"],required:!0}},data:function(){return{isProcessing:!1}},watch:{activeCommentId:function(e,t){this.comment.id==e?this.onActivate():this.onDeactivate()}},computed:d({},Object(r["d"])({scaleFactor:function(e){return e.screens.scaleFactor},activeCommentId:function(e){return e.comments.activeCommentId}}),{isActive:function(){return this.comment.id==this.activeCommentId}}),methods:d({},Object(r["b"])({removeComment:"comments/removeComment",setActiveCommentId:"comments/setActiveCommentId"}),{onActivate:function(){var e=this;this.$nextTick((function(){e.positionWithinView()}))},onDeactivate:function(){this.comment.isNew&&this.removeComment(this.comment.id)},positionWithinView:function(){this.$el.scrollIntoView({behavior:"smooth",block:"nearest"})},updatePinPosition:function(){var e=this;this.comment.left=this.$el.offsetLeft/this.scaleFactor,this.comment.top=this.$el.offsetTop/this.scaleFactor,this.comment.isNew||(this.isProcessing=!0,c["a"].ScreenComments.update(this.comment.id,{left:this.comment.left,top:this.comment.top}).then((function(t){e.comment.load(t.data),e.$emit("commentUpdated",e.comment,e.$el)})).catch((function(t){e.$errResponseHandler(t)})).finally((function(){e.isProcessing=!1})))},onRepositioning:function(){this.$emit("repositioning",this.comment,this.$el)}})},u=v,h=s("2877"),p=Object(h["a"])(u,n,i,!1,null,null,null);t["a"]=p.exports},"82bb":function(e,t,s){"use strict";var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{on:{mousedown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:"button"in t&&0!==t.button?null:e.dragInit(t)},touchstart:e.dragInit}},[e._t("default")],2)},i=[],o=(s("c5f6"),{name:"dragger",props:{wrapperSelector:{type:String},tolerance:{type:Number,default:10},enable:{type:Boolean,default:!0}},data:function(){return{startX:0,startY:0,shiftX:0,shiftY:0,lockX:!1,lockY:!1,dragStarted:!1}},computed:{wrapper:function(){return this.$el.closest(this.wrapperSelector)||this.$el.parentNode}},methods:{dragInit:function(e){this.enable&&(e.stopPropagation(),this.startX=e.clientX,this.startY=e.clientY,this.shiftX=e.clientX-this.$el.offsetLeft,this.shiftY=e.clientY-this.$el.offsetTop,document.addEventListener("touchmove",this.onMove),document.addEventListener("mousemove",this.onMove),document.addEventListener("touchend",this.onDrop),document.addEventListener("mouseup",this.onDrop))},onMove:function(e){var t=e.clientX-this.startX,s=e.clientY-this.startY,n=e.clientX-this.shiftX,i=e.clientY-this.shiftY;if(!(!this.dragStarted&&Math.abs(n-this.$el.offsetLeft)<this.tolerance&&Math.abs(i-this.$el.offsetTop)<this.tolerance)){if(e.preventDefault(),this.dragStarted||(this.dragStarted=!0,this.$el.classList.add("no-pointer-events"),this.wrapper.classList.add("dragging"),this.$emit("dragStarted",e)),this.$emit("dragging",e),e.shiftKey?this.lockX||this.lockY||(Math.abs(t)>Math.abs(s)?(this.lockX=!1,this.lockY=!0):(this.lockX=!0,this.lockY=!1)):(this.lockX=!1,this.lockY=!1),!this.lockX){var o=this.wrapper.scrollWidth||this.wrapper.offsetWidth;n+this.$el.offsetWidth>o&&(n=o-this.$el.offsetWidth),n=n<0?0:n,this.$el.style.left=n+"px"}if(!this.lockY){var r=this.wrapper.scrollHeight||this.wrapper.offsetHeight;i+this.$el.offsetHeight>r&&(i=r-this.$el.offsetHeight),i=i<0?0:i,this.$el.style.top=i+"px"}}},onDrop:function(e){this.dragStarted&&(e.preventDefault(),this.dragStarted=!1,this.lockX=!1,this.lockY=!1,this.$el.classList.remove("no-pointer-events"),this.wrapper.classList.remove("dragging"),this.$emit("dragStopped",e)),document.removeEventListener("touchmove",this.onMove),document.removeEventListener("mousemove",this.onMove),document.removeEventListener("touchend",this.onDrop),document.removeEventListener("mouseup",this.onDrop)}}}),r=o,c=s("2877"),a=Object(c["a"])(r,n,i,!1,null,null,null);t["a"]=a.exports},"917d":function(e,t,s){"use strict";var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"popover-holder comment-popover-holder"},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.isActive,expression:"isActive"}],staticClass:"popover-overlay",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.close()}}}),s("div",{ref:"popover",staticClass:"popover comment-popover",class:{active:e.isActive}},[e.lastActiveComment.isNew?e._e():s("div",{staticClass:"form-group resolved-checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.lastActiveComment.status,expression:"lastActiveComment.status"}],attrs:{type:"checkbox",id:"mark_as_resoved_"+e.lastActiveComment.id,"true-value":"resolved","false-value":"pending"},domProps:{checked:Array.isArray(e.lastActiveComment.status)?e._i(e.lastActiveComment.status,null)>-1:e._q(e.lastActiveComment.status,"resolved")},on:{change:[function(t){var s=e.lastActiveComment.status,n=t.target,i=n.checked?"resolved":"pending";if(Array.isArray(s)){var o=null,r=e._i(s,o);n.checked?r<0&&e.$set(e.lastActiveComment,"status",s.concat([o])):r>-1&&e.$set(e.lastActiveComment,"status",s.slice(0,r).concat(s.slice(r+1)))}else e.$set(e.lastActiveComment,"status",i)},function(t){return e.saveCommentStatus()}]}}),s("label",{attrs:{for:"mark_as_resoved_"+e.lastActiveComment.id}},[e._v(e._s(e.$t("Mark as resolved")))])]),e.isLoadingReplies?s("div",{staticClass:"block txt-center txt-hint p-small"},[s("span",{staticClass:"loader"})]):e._e(),e.isLoadingReplies||e.lastActiveComment.isNew?e._e():s("div",{ref:"commentsListContainer",staticClass:"comments-list"},e._l(e.commentsList,(function(t){return s("div",{key:"reply_"+t.id,staticClass:"comment-list-item",class:{primary:t.isPrimary}},[s("figure",{staticClass:"avatar"},[t.user&&t.user.getAvatar("small")?s("img",{attrs:{src:t.user.getAvatar("small"),alt:"User avatar"}}):s("i",{staticClass:"fe fe-user"})]),s("div",{staticClass:"content"},[s("small",{staticClass:"content-header"},[s("span",{staticClass:"name"},[e._v(e._s(t.user?t.user.identifier:t.from))]),s("span",{staticClass:"date txt-hint"},[e._v(e._s(t.createdAtFromNow))])]),s("div",{staticClass:"message"},[e._v(e._s(t.message))])]),s("div",{staticClass:"list-ctrls"},[e.isForPreview?e._e():s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.$t("Delete"),expression:"$t('Delete')",modifiers:{top:!0}}],staticClass:"list-ctrl-item ctrl-danger",on:{click:function(s){return s.preventDefault(),e.deleteComment(t.id)}}},[s("i",{staticClass:"fe fe-trash"})])])])})),0),s("form",{ref:"messageForm",staticClass:"comment-message-form",on:{submit:function(e){e.preventDefault()}}},[e.isForPreview?s("form-field",{staticClass:"email-field",attrs:{name:"from",showErrorMsg:!0}},[s("div",{staticClass:"input-group"},[s("div",{staticClass:"input-addon p-l-small p-r-0 m-r-0"},[s("i",{directives:[{name:"tooltip",rawName:"v-tooltip.left",value:e.$t("From (email)"),expression:"$t('From (email)')",modifiers:{left:!0}}],staticClass:"fe fe-mail"})]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.from,expression:"from"}],staticClass:"p-l-10",attrs:{type:"email",required:"",placeholder:e.$t("Your email")},domProps:{value:e.from},on:{keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;t.preventDefault()},input:function(t){t.target.composing||(e.from=t.target.value)}}})])]):e._e(),s("form-field",{staticClass:"message-field",attrs:{name:"message",showErrorMsg:!1}},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],ref:"messageField",attrs:{required:"",placeholder:e.$t("Write a comment (@ to mention)")},domProps:{value:e.message},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey?t.shiftKey||t.altKey||t.metaKey?null:(t.preventDefault(),e.addComment()):null},input:function(t){t.target.composing||(e.message=t.target.value)}}}),s("button",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:e.$t("Add comment ({shortcut})",{shortcut:"Ctrl+Enter"}),expression:"$t('Add comment ({shortcut})', {shortcut: 'Ctrl+Enter'})",modifiers:{bottom:!0}}],ref:"messageBtn",staticClass:"submit-icon",on:{click:function(t){return t.preventDefault(),e.addComment()},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey?t.shiftKey||t.altKey||t.metaKey?null:(t.preventDefault(),e.addComment()):null}}},[e.isProcessing?s("span",{staticClass:"loader"}):s("i",{staticClass:"fe fe-send"})]),s("mentions-list",{ref:"mentionsList",staticClass:"dropdown-compact input-dropdown",attrs:{list:e.mentionsList}})],1)],1)])])},i=[],o=(s("8e6e"),s("ac6a"),s("456d"),s("55dd"),s("bd86")),r=s("2f62"),c=s("0abc"),a=s("3d48"),l=s("dd93"),m=s("f744"),d=s("46a0"),v=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"dropdown",class:{active:e.isActive}},[e._l(e.filteredList,(function(t,n){return[s("div",{ref:"mentions",refInFor:!0,staticClass:"dropdown-item",class:{highlight:e.focusIndex==n},on:{click:function(t){return t.preventDefault(),e.select(n)}}},[e._v(e._s(t.label))]),n+1!=e.filteredList.length?s("hr"):e._e()]}))],2)},u=[],h=(s("a481"),{name:"mentions-list",props:{list:{type:Array,required:!0},triggers:{type:Array,default:function(){return["+","@"]}},input:{}},data:function(){return{isActive:!1,focusIndex:0,filteredList:[]}},computed:{inputElem:function(){return this.input instanceof Node?this.input:this.input&&l["a"].isString(this.input)&&document.querySelector(this.input)?document.querySelector(this.input):this.$el.parentNode.querySelector("textarea, input")}},mounted:function(){this.inputElem?(this.inputElem.addEventListener("input",this.onInputChange),this.inputElem.addEventListener("keydown",this.onInputKeydown)):console.warn("MentionsList: input element is invalid or missing.")},beforeDestroy:function(){this.inputElem&&(this.inputElem.removeEventListener("input",this.onInputChange),this.inputElem.removeEventListener("keydown",this.onInputKeydown))},methods:{hide:function(){this.isActive&&(this.isActive=!1,this.focusIndex=0,this.filteredList=[],this.$emit("hide"))},show:function(){this.isActive||(this.isActive=!0,this.focusIndex=0,this.$emit("show"),this.positionFocusedMendtionWithinView())},focusPrev:function(){this.focusIndex<=0?this.focusIndex=this.filteredList.length-1:this.focusIndex--,this.positionFocusedMendtionWithinView()},focusNext:function(){this.focusIndex>=this.filteredList.length-1?this.focusIndex=0:this.focusIndex++,this.positionFocusedMendtionWithinView()},positionFocusedMendtionWithinView:function(){this.$refs.mentions&&this.$refs.mentions[this.focusIndex]&&this.$refs.mentions[this.focusIndex].scrollIntoView({block:"nearest"})},getCurrentWordInfo:function(){var e="undefined"!==typeof this.inputElem.selectionStart?this.inputElem.selectionStart:this.inputElem.value.length,t=l["a"].getWordInfoAt(this.inputElem.value,e-1);return t},select:function(e){var t=this;e="undefined"!==typeof e?e:this.focusIndex;var s=this.getCurrentWordInfo();if(s.word&&this.inputElem&&this.filteredList[e]){var n=this.inputElem.value;this.inputElem.value=n.substring(0,s.start)+this.triggers[0]+this.filteredList[e].value+n.substring(s.end+1)+" ",this.inputElem.dispatchEvent(new Event("input")),this.$nextTick((function(){t.inputElem.focus(),t.hide()}))}},filterList:function(e){if(e=(e||"").toLowerCase().replace(/\s+/g,""),!e)return this.list;for(var t=[],s=this.list.length-1;s>=0;s--){var n=(this.list[s].value+this.list[s].label||"").toLowerCase().replace(/\s+/g,"");n.indexOf(e)>=0&&t.push(this.list[s])}return t},onInputChange:function(e){var t=this.getCurrentWordInfo();this.hide(),t.word&&this.triggers.indexOf(t.word[0])>=0&&(this.filteredList=this.filterList(t.word.substring(1)),this.filteredList.length&&this.show())},onInputKeydown:function(e){if(this.isActive){var t=e.which||e.keyCode;13==t?(e.preventDefault(),this.select()):38==t?(e.preventDefault(),this.focusPrev()):40==t&&(e.preventDefault(),this.focusNext())}}}}),p=h,f=s("2877"),g=Object(f["a"])(p,v,u,!1,null,null,null),C=g.exports;function y(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function S(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?y(s,!0).forEach((function(t){Object(o["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):y(s).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var w={name:"active-comment-popover",components:{"mentions-list":C},props:{mentionsList:{type:Array,default:function(){return[]}},isForPreview:{type:Boolean,default:!0}},data:function(){return{isProcessing:!1,isLoadingReplies:!1,lastActiveComment:new d["a"],replies:[],message:"",from:""}},computed:S({},Object(r["d"])({previewToken:function(e){return e.preview.previewToken},activeCommentId:function(e){return e.comments.activeCommentId}}),{},Object(r["c"])({activeComment:"comments/activeComment",getUnreadComment:"notifications/getUnreadComment",getUnreadCommentsForComment:"notifications/getUnreadCommentsForComment"}),{isActive:function(){return null!=this.activeComment},commentsList:function(){var e=this.replies.slice();return this.lastActiveComment&&!this.lastActiveComment.isNew&&e.unshift(this.lastActiveComment),e.sort((function(e,t){return Date.parse(e["createdAt"])-Date.parse(t["createdAt"])})),e},unreadCommentReplies:function(){return this.getUnreadCommentsForComment(this.activeCommentId)}}),watch:{commentsList:function(e,t){var s=this;this.$nextTick((function(){setTimeout((function(){s.reposition()}),100)}))},unreadCommentReplies:function(e,t){var s=this;if(e){for(var n in e)l["a"].pushUnique(this.replies,e[n]);e.length&&this.isActive&&this.$nextTick((function(){s.scrollToLastComment(),s.readComments(s.commentsList.slice(),500)}))}},activeCommentId:function(e,t){this.activeComment?this.open():this.close()}},mounted:function(){document.addEventListener("scroll",this.onEventPopoverReposition,{capture:!0,passive:!0}),window.addEventListener("resize",this.onEventPopoverReposition,{passive:!0}),this.from=a["a"].getItem(c["a"].get("VUE_APP_PREVIEW_COMMENT_FROM_STORAGE_KEY"))||l["a"].getNestedVal(this.$store,"state.user.user.email","")},beforeDestroy:function(){document.removeEventListener("scroll",this.onEventPopoverReposition,{capture:!0}),window.removeEventListener("resize",this.onEventPopoverReposition)},methods:S({},Object(r["b"])({setActiveCommentId:"comments/setActiveCommentId",removeComment:"comments/removeComment",removeUnreadComment:"notifications/removeUnreadComment",markAsRead:"notifications/markAsRead"}),{resetForm:function(){this.message="",this.$refs.messageBtn&&this.$refs.messageBtn.blur()},open:function(){var e=this;this.lastActiveComment=this.activeComment,this.replies=[],this.resetForm(),this.loadReplies(),this.$nextTick((function(){return e.reposition()})),this.lastActiveComment.isNew&&this.$refs.messageField&&setTimeout((function(){e.$refs.messageField&&e.$refs.messageField.focus()}),100)},close:function(){this.setActiveCommentId(null),this.lastActiveComment.isNew&&this.removeComment(this.lastActiveComment.id),this.$refs.mentionsList&&this.$refs.mentionsList.hide()},onEventPopoverReposition:function(e){this.isActive&&this.reposition()},reposition:function(e){if(e=e||document.querySelector('.comment-pin[data-id="'+this.lastActiveComment.id+'"]'),this.isActive&&e){var t=document.querySelector(".preview-container")||document.documentElement,s=this.$refs.popover,n=e.getBoundingClientRect(),i=5,o=n.top-i,r=n.left+n.width+i;s.style.left="0px",s.style.top="0px",r+s.offsetWidth>t.clientWidth&&(r=n.left-s.offsetWidth-i),r=r>=0?r:0,o+s.offsetHeight>t.clientHeight&&(o=t.clientHeight-s.offsetHeight),o=o>=0?o:0,s.style.left=r+"px",s.style.top=o+"px"}},loadReplies:function(){var e,t=this;this.isLoadingReplies||this.lastActiveComment.isNew||(this.isLoadingReplies=!0,m["a"].enableAutoCancellation(!1),e=this.isForPreview?m["a"].Previews.getScreenCommentsList(this.previewToken,1,199,{"search[screenId]":this.lastActiveComment.screenId,"search[replyTo]":this.lastActiveComment.id}):m["a"].ScreenComments.getList(1,199,{"search[screenId]":this.lastActiveComment.screenId,"search[replyTo]":this.lastActiveComment.id}),e.then((function(e){t.replies=d["a"].createInstances(e.data),t.readComments(t.commentsList.slice())})).catch((function(e){t.$errResponseHandler(e)})).finally((function(){t.isLoadingReplies=!1,t.$nextTick((function(){t.scrollToLastComment()}))})))},deleteComment:function(e){if(!this.isForPreview){var t=l["a"].findByKey(this.commentsList,"id",e);if(t){var s="";s=t.isPrimary?this.$t("Do you really want to deleted the selected comment and all its replies?"):this.$t("Do you really want to deleted the selected comment?"),window.confirm(s)&&(this.$toast(this.$t("Successfully deleted comment.")),l["a"].removeByKey(this.replies,"id",e),this.removeComment(e),this.lastActiveComment.id==e&&this.close(),m["a"].ScreenComments.delete(e))}}},addComment:function(){var e=this;if(!this.isProcessing&&this.message){var t;this.isProcessing=!0;var s=this.lastActiveComment.isNew?null:this.lastActiveComment.id;t=this.isForPreview?m["a"].Previews.createScreenComment(this.previewToken,{replyTo:s,screenId:this.lastActiveComment.screenId,left:this.lastActiveComment.left,top:this.lastActiveComment.top,message:this.message,from:this.from}):m["a"].ScreenComments.create({replyTo:s,screenId:this.lastActiveComment.screenId,left:this.lastActiveComment.left,top:this.lastActiveComment.top,message:this.message}),t.then((function(t){a["a"].setItem(c["a"].get("VUE_APP_PREVIEW_COMMENT_FROM_STORAGE_KEY"),e.from),e.resetForm(),e.$toast(e.$t("Successfully added new comment."));var n=s?new d["a"]:e.lastActiveComment;n.load(t.data),n.isReply?(e.replies.push(n),e.$nextTick((function(){e.scrollToLastComment()}))):e.close(),e.$emit("commentCreated",n)})).catch((function(t){e.$errResponseHandler(t)})).finally((function(){e.isProcessing=!1}))}else this.$refs.messageForm&&l["a"].isFunction(this.$refs.messageForm.reportValidity)&&this.$refs.messageForm.reportValidity()},saveCommentStatus:function(){var e,t=this;this.isProcessing||this.lastActiveComment.isNew||(this.isProcessing=!0,e=this.isForPreview?m["a"].Previews.updateScreenComment(this.previewToken,this.lastActiveComment.id,{status:this.lastActiveComment.status}):m["a"].ScreenComments.update(this.lastActiveComment.id,{status:this.lastActiveComment.status}),e.then((function(e){t.lastActiveComment.load(e.data),t.$toast(t.$t("Successfully updated comment state.")),t.lastActiveComment.isResolved&&t.close(),t.$emit("commentUpdated",t.lastActiveComment)})).catch((function(e){t.$errResponseHandler(e)})).finally((function(){t.isProcessing=!1})))},scrollToLastComment:function(){this.$refs.popover&&this.$refs.popover.scrollTo({behavior:"smooth",top:this.$refs.popover.scrollHeight})},readComments:function(e){var t=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;setTimeout((function(){for(var s=e.length-1;s>=0;s--)t.getUnreadComment(e[s].id)&&(t.previewToken?t.removeUnreadComment(e[s].id):t.markAsRead(e[s].id))}),s)}})},b=w,O=Object(f["a"])(b,n,i,!1,null,null,null);t["a"]=O.exports},"978b":function(e,t,s){},"9aaf":function(e,t,s){"use strict";var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("transition",{attrs:{name:"previewPanel"}},[e.isActive&&e.screens.length?s("div",{staticClass:"preview-screens-panel",on:{"&!wheel":function(t){return e.verticalToHorizontalScroll(t)}}},[s("div",{staticClass:"thumbs-list"},e._l(e.orderedScreens,(function(t){return s("figure",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.title,expression:"screen.title",modifiers:{top:!0}}],key:"thumb_"+t.id,staticClass:"thumb thumb-handle screen-thumb",class:{active:e.activeScreenId==t.id},on:{click:function(s){return s.preventDefault(),e.setActiveScreenId(t.id)}}},[t.getImage("small")?s("img",{staticClass:"img",attrs:{src:t.getImage("small"),alt:t.title}}):s("i",{staticClass:"fe fe-image img"})])})),0)]):e._e()])},i=[],o=(s("8e6e"),s("ac6a"),s("456d"),s("bd86")),r=s("2f62");function c(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function a(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?c(s,!0).forEach((function(t){Object(o["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):c(s).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var l={name:"screens-panel",data:function(){return{isActive:!1}},computed:a({},Object(r["d"])({screens:function(e){return e.screens.screens},activeScreenId:function(e){return e.screens.activeScreenId}}),{},Object(r["c"])({orderedScreens:"screens/orderedScreens"})),watch:{activeScreenId:function(e,t){e!==t&&this.isActive&&this.scrollToActiveScreenThumb()}},methods:a({},Object(r["b"])({setActiveScreenId:"screens/setActiveScreenId"}),{show:function(){this.isActive=!0,this.scrollToActiveScreenThumb()},hide:function(){this.isActive=!1},toggle:function(){this.isActive?this.hide():this.show()},scrollToActiveScreenThumb:function(){var e=this;this.$nextTick((function(){if(e.isActive&&e.$el){var t=15,s=e.$el,n=s?s.querySelector(".screen-thumb.active"):null;if(n){var i=n.offsetLeft,o=i+n.offsetWidth,r=s.scrollLeft,c=r+s.offsetWidth;i-t<r?s.scrollLeft=i-t:o+t>c&&(s.scrollLeft=r-(c-(o+t)))}}}))},verticalToHorizontalScroll:function(e){if("wheel"==e.type&&this.$el){var t=(e.deltaY||-e.wheelDelta||e.detail)>>10||1;t*=-300,this.$el.scrollLeft-=t}}})},m=l,d=s("2877"),v=Object(d["a"])(m,n,i,!1,null,null,null);t["a"]=v.exports},a1c0:function(e,t,s){"use strict";var n=s("978b"),i=s.n(n);i.a},c647:function(e,t,s){"use strict";s("8e6e"),s("ac6a"),s("456d");var n=s("bd86"),i=s("2f62"),o=s("f744"),r=s("dd93");s("49cb");function c(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function a(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?c(s,!0).forEach((function(t){Object(n["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):c(s).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}t["a"]={data:function(){return{isPreviewModeHintsActive:!1,isLoadingHotspots:!1,isLoadingHotspotTemplates:!1,fitToScreen:!1}},computed:a({},Object(i["d"])({activePrototypeId:function(e){return e.prototypes.activePrototypeId},hotspots:function(e){return e.hotspots.hotspots},hotspotTemplates:function(e){return e.hotspots.hotspotTemplates}}),{},Object(i["c"])({getHotspot:"hotspots/getHotspot",getHotspotTemplate:"hotspots/getHotspotTemplate",getHotspotsForScreen:"hotspots/getHotspotsForScreen"})),methods:a({},Object(i["b"])({setHotspots:"hotspots/setHotspots",appendHotspots:"hotspots/appendHotspots",setHotspotTemplates:"hotspots/setHotspotTemplates"}),{loadHotspots:function(e){var t=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;e=e||this.activePrototypeId,e&&!this.isLoadingHotspots&&(this.isLoadingHotspots=!0,o["a"].Hotspots.getList(s,200,{envelope:!0,"search[prototypeId]":e}).then((function(n){var i=r["a"].getNestedVal(n,"data.response",[]),o=r["a"].getNestedVal(n,"data.headers.x-pagination-current-page",1),c=r["a"].getNestedVal(n,"data.headers.x-pagination-page-count",1);1==s?t.setHotspots(i):t.appendHotspots(i),c>o&&t.loadHotspots(e,s+1)})).catch((function(e){t.$errResponseHandler(e)})).finally((function(){t.isLoadingHotspots=!1})))},loadHotspotTemplates:function(e){var t=this;e=e||this.activePrototypeId,e&&!this.isLoadingHotspotTemplates&&(this.isLoadingHotspotTemplates=!0,o["a"].HotspotTemplates.getList(1,100,{expand:"screenIds","search[prototypeId]":e}).then((function(e){t.setHotspotTemplates(e.data||[])})).catch((function(e){t.$errResponseHandler(e)})).finally((function(){t.isLoadingHotspotTemplates=!1})))},blinkPreviewModeHints:function(){var e=this;this.isPreviewModeHintsActive=!0,this.previewModeHintsTimeoutId&&clearTimeout(this.previewModeHintsTimeoutId),this.previewModeHintsTimeoutId=setTimeout((function(){e.isPreviewModeHintsActive=!1}),500)},toggleFitToScreen:function(){this.fitToScreen=!this.fitToScreen}})}}}]);